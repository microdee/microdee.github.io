var $e=Object.defineProperty;var ze=(k,a,A)=>a in k?$e(k,a,{enumerable:!0,configurable:!0,writable:!0,value:A}):k[a]=A;var It=(k,a,A)=>(ze(k,typeof a!="symbol"?a+"":a,A),A),ae=(k,a,A)=>{if(!a.has(k))throw TypeError("Cannot "+A)};var O=(k,a,A)=>(ae(k,a,"read from private field"),A?A.call(k):a.get(k)),ot=(k,a,A)=>{if(a.has(k))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(k):a.set(k,A)},yt=(k,a,A,i)=>(ae(k,a,"write to private field"),i?i.call(k,A):a.set(k,A),A);var oe=(k,a,A,i)=>({set _(l){yt(k,a,l,A)},get _(){return O(k,a,i)}}),dt=(k,a,A)=>(ae(k,a,"access private method"),A);import{c as commonjsGlobal,R as React,r as reactExports,a as getAugmentedNamespace,b as PropTypes,j as jsxRuntimeExports,G as Gh1}from"./index-s9tuF7dK.js";import{d as _toPropertyKey,e as _typeof,f as _unsupportedIterableToArray,c as _toConsumableArray,a as _defineProperty,b as _objectWithoutProperties,_ as _extends}from"./extends-03eu3xDp.js";function _classCallCheck(k,a){if(!(k instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(k,a){for(var A=0;A<a.length;A++){var i=a[A];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(k,_toPropertyKey(i.key),i)}}function _createClass(k,a,A){return a&&_defineProperties(k.prototype,a),A&&_defineProperties(k,A),Object.defineProperty(k,"prototype",{writable:!1}),k}function _setPrototypeOf(k,a){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,l){return i.__proto__=l,i},_setPrototypeOf(k,a)}function _inherits(k,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(a&&a.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),Object.defineProperty(k,"prototype",{writable:!1}),a&&_setPrototypeOf(k,a)}function _assertThisInitialized(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}function _possibleConstructorReturn(k,a){if(a&&(_typeof(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(k)}function _getPrototypeOf(k){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(A){return A.__proto__||Object.getPrototypeOf(A)},_getPrototypeOf(k)}var pageFlip_browser={exports:{}};(function(k,a){(function(A,i){i(a)})(commonjsGlobal,function(A){class i{constructor(t,e){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=e,this.nowDrawingDensity=this.createdDensity,this.render=t}setDensity(t){this.createdDensity=t,this.nowDrawingDensity=t}setDrawingDensity(t){this.nowDrawingDensity=t}setPosition(t){this.state.position=t}setAngle(t){this.state.angle=t}setArea(t){this.state.area=t}setHardDrawingAngle(t){this.state.hardDrawingAngle=t}setHardAngle(t){this.state.hardAngle=t,this.state.hardDrawingAngle=t}setOrientation(t){this.orientation=t}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class l extends i{constructor(t,e,n){super(t,n),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=e}draw(t){const e=this.render.getContext(),n=this.render.convertToGlobal(this.state.position),h=this.render.getRect().pageWidth,b=this.render.getRect().height;e.save(),e.translate(n.x,n.y),e.beginPath();for(let g of this.state.area)g!==null&&(g=this.render.convertToGlobal(g),e.lineTo(g.x-n.x,g.y-n.y));e.rotate(this.state.angle),e.clip(),this.isLoad?e.drawImage(this.image,0,0,h,b):this.drawLoader(e,{x:0,y:0},h,b),e.restore()}simpleDraw(t){const e=this.render.getRect(),n=this.render.getContext(),h=e.pageWidth,b=e.height,g=t===1?e.left+e.pageWidth:e.left,f=e.top;this.isLoad?n.drawImage(this.image,g,f,h,b):this.drawLoader(n,{x:g,y:f},h,b)}drawLoader(t,e,n,h){t.beginPath(),t.strokeStyle="rgb(200, 200, 200)",t.fillStyle="rgb(255, 255, 255)",t.lineWidth=1,t.rect(e.x+1,e.y+1,n-1,h-1),t.stroke(),t.fill();const b={x:e.x+n/2,y:e.y+h/2};t.beginPath(),t.lineWidth=10,t.arc(b.x,b.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),t.stroke(),t.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class M{constructor(t,e){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=e,this.app=t,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let e=0;e<this.pages.length;e++)this.portraitSpread.push([e]);let t=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([t]),t++);for(let e=t;e<this.pages.length;e+=2)e<this.pages.length-1?this.landscapeSpread.push([e,e+1]):(this.landscapeSpread.push([e]),this.pages[e].setDensity("hard"))}getSpread(){return this.render.getOrientation()==="landscape"?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(t){const e=this.getSpread();for(let n=0;n<e.length;n++)if(t===e[n][0]||t===e[n][1])return n;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(t){if(t>=0&&t<this.pages.length)return this.pages[t];throw new Error("Invalid page number")}nextBy(t){const e=this.pages.indexOf(t);return e<this.pages.length-1?this.pages[e+1]:null}prevBy(t){const e=this.pages.indexOf(t);return e>0?this.pages[e-1]:null}getFlippingPage(t){const e=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return t===0?this.pages[e].newTemporaryCopy():this.pages[e-1];{const n=t===0?this.getSpread()[e+1]:this.getSpread()[e-1];return n.length===1||t===0?this.pages[n[0]]:this.pages[n[1]]}}getBottomPage(t){const e=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return t===0?this.pages[e+1]:this.pages[e-1];{const n=t===0?this.getSpread()[e+1]:this.getSpread()[e-1];return n.length===1?this.pages[n[0]]:t===0?this.pages[n[1]]:this.pages[n[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(t=null){if(t===null&&(t=this.currentPageIndex),t<0||t>=this.pages.length)return;const e=this.getSpreadIndexByPage(t);e!==null&&(this.currentSpreadIndex=e,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(t){if(!(t>=0&&t<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=t}showSpread(){const t=this.getSpread()[this.currentSpreadIndex];t.length===2?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(this.pages[t[1]])):this.render.getOrientation()==="landscape"&&t[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[t[0]])),this.currentPageIndex=t[0],this.app.updatePageIndex(this.currentPageIndex)}}class D extends M{constructor(t,e,n){super(t,e),this.imagesHref=n}load(){for(const t of this.imagesHref){const e=new l(this.render,t,"soft");e.load(),this.pages.push(e)}this.createSpread()}}class w{static GetDistanceBetweenTwoPoint(t,e){return t===null||e===null?1/0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static GetSegmentLength(t){return w.GetDistanceBetweenTwoPoint(t[0],t[1])}static GetAngleBetweenTwoLine(t,e){const n=t[0].y-t[1].y,h=e[0].y-e[1].y,b=t[1].x-t[0].x,g=e[1].x-e[0].x;return Math.acos((n*h+b*g)/(Math.sqrt(n*n+b*b)*Math.sqrt(h*h+g*g)))}static PointInRect(t,e){return e===null?null:e.x>=t.left&&e.x<=t.width+t.left&&e.y>=t.top&&e.y<=t.top+t.height?e:null}static GetRotatedPoint(t,e,n){return{x:t.x*Math.cos(n)+t.y*Math.sin(n)+e.x,y:t.y*Math.cos(n)-t.x*Math.sin(n)+e.y}}static LimitPointToCircle(t,e,n){if(w.GetDistanceBetweenTwoPoint(t,n)<=e)return n;const h=t.x,b=t.y,g=n.x,f=n.y;let E=Math.sqrt(Math.pow(e,2)*Math.pow(h-g,2)/(Math.pow(h-g,2)+Math.pow(b-f,2)))+h;n.x<0&&(E*=-1);let J=(E-h)*(b-f)/(h-g)+b;return h-g+b===0&&(J=e),{x:E,y:J}}static GetIntersectBetweenTwoSegment(t,e,n){return w.PointInRect(t,w.GetIntersectBeetwenTwoLine(e,n))}static GetIntersectBeetwenTwoLine(t,e){const n=t[0].y-t[1].y,h=e[0].y-e[1].y,b=t[1].x-t[0].x,g=e[1].x-e[0].x,f=t[0].x*t[1].y-t[1].x*t[0].y,E=e[0].x*e[1].y-e[1].x*e[0].y,J=n*E-h*f,nt=b*E-g*f,Z=-(f*g-E*b)/(n*g-h*b),Q=-(n*E-h*f)/(n*g-h*b);if(isFinite(Z)&&isFinite(Q))return{x:Z,y:Q};if(Math.abs(J-nt)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(t,e){const n=Math.abs(t.x-e.x),h=Math.abs(t.y-e.y),b=Math.max(n,h),g=[t];function f(E,J,nt,Z,Q){return J>E?E+Q*(nt/Z):J<E?E-Q*(nt/Z):E}for(let E=1;E<=b;E+=1)g.push({x:f(t.x,e.x,n,b,E),y:f(t.y,e.y,h,b,E)});return g}}class S extends i{constructor(t,e,n){super(t,n),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=e,this.element.classList.add("stf__item"),this.element.classList.add("--"+n)}newTemporaryCopy(){return this.nowDrawingDensity==="hard"?this:(this.temporaryCopy===null&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new S(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){this.temporaryCopy!==null&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(t){const e=t||this.nowDrawingDensity,n=this.render.convertToGlobal(this.state.position),h=this.render.getRect().pageWidth,b=this.render.getRect().height;this.element.classList.remove("--simple");const g=`
            display: block;
            z-index: ${this.element.style.zIndex};
            left: 0;
            top: 0;
            width: ${h}px;
            height: ${b}px;
        `;e==="hard"?this.drawHard(g):this.drawSoft(n,g)}drawHard(t=""){const e=this.render.getRect().left+this.render.getRect().width/2,n=this.state.hardDrawingAngle,h=t+`
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                clip-path: none;
                -webkit-clip-path: none;
            `+(this.orientation===0?`transform-origin: ${this.render.getRect().pageWidth}px 0; 
                   transform: translate3d(0, 0, 0) rotateY(${n}deg);`:`transform-origin: 0 0; 
                   transform: translate3d(${e}px, 0, 0) rotateY(${n}deg);`);this.element.style.cssText=h}drawSoft(t,e=""){let n="polygon( ";for(const b of this.state.area)if(b!==null){let g=this.render.getDirection()===1?{x:-b.x+this.state.position.x,y:b.y-this.state.position.y}:{x:b.x-this.state.position.x,y:b.y-this.state.position.y};g=w.GetRotatedPoint(g,{x:0,y:0},this.state.angle),n+=g.x+"px "+g.y+"px, "}n=n.slice(0,-2),n+=")";const h=e+`transform-origin: 0 0; clip-path: ${n}; -webkit-clip-path: ${n};`+(this.render.isSafari()&&this.state.angle===0?`transform: translate(${t.x}px, ${t.y}px);`:`transform: translate3d(${t.x}px, ${t.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=h}simpleDraw(t){const e=this.render.getRect(),n=e.pageWidth,h=e.height,b=t===1?e.left+e.pageWidth:e.left,g=e.top;this.element.classList.add("--simple"),this.element.style.cssText=`
            position: absolute; 
            display: block; 
            height: ${h}px; 
            left: ${b}px; 
            top: ${g}px; 
            width: ${n}px; 
            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(t){super.setOrientation(t),this.element.classList.remove("--left","--right"),this.element.classList.add(t===1?"--right":"--left")}setDrawingDensity(t){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+t),super.setDrawingDensity(t)}}class y extends M{constructor(t,e,n,h){super(t,e),this.element=n,this.pagesElement=h}load(){for(const t of this.pagesElement){const e=new S(this.render,t,t.dataset.density==="hard"?"hard":"soft");e.load(),this.pages.push(e)}this.createSpread()}}class C{constructor(t,e,n,h){this.direction=t,this.corner=e,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(n,10),this.pageHeight=parseInt(h,10)}calc(t){try{return this.position=this.calcAngleAndPosition(t),this.calculateIntersectPoint(this.position),!0}catch{return!1}}getFlippingClipArea(){const t=[];let e=!1;return t.push(this.rect.topLeft),t.push(this.topIntersectPoint),this.sideIntersectPoint===null?e=!0:(t.push(this.sideIntersectPoint),this.bottomIntersectPoint===null&&(e=!1)),t.push(this.bottomIntersectPoint),(e||this.corner==="bottom")&&t.push(this.rect.bottomLeft),t}getBottomClipArea(){const t=[];return t.push(this.topIntersectPoint),this.corner==="top"?t.push({x:this.pageWidth,y:0}):(this.topIntersectPoint!==null&&t.push({x:this.pageWidth,y:0}),t.push({x:this.pageWidth,y:this.pageHeight})),this.sideIntersectPoint!==null?w.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&t.push(this.sideIntersectPoint):this.corner==="top"&&t.push({x:this.pageWidth,y:this.pageHeight}),t.push(this.bottomIntersectPoint),t.push(this.topIntersectPoint),t}getAngle(){return this.direction===0?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return this.direction===0?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return this.direction===1?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return this.corner==="top"?this.topIntersectPoint:this.sideIntersectPoint!==null?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const t=w.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===0?t:Math.PI-t}calcAngleAndPosition(t){let e=t;if(this.updateAngleAndGeometry(e),e=this.corner==="top"?this.checkPositionAtCenterLine(e,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(e,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(e.x-this.pageWidth)<1&&Math.abs(e.y)<1)throw new Error("Point is too small");return e}updateAngleAndGeometry(t){this.angle=this.calculateAngle(t),this.rect=this.getPageRect(t)}calculateAngle(t){const e=this.pageWidth-t.x+1,n=this.corner==="bottom"?this.pageHeight-t.y:t.y;let h=2*Math.acos(e/Math.sqrt(n*n+e*e));n<0&&(h=-h);const b=Math.PI-h;if(!isFinite(h)||b>=0&&b<.003)throw new Error("The G point is too small");return this.corner==="bottom"&&(h=-h),h}getPageRect(t){return this.corner==="top"?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],t):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],t)}getRectFromBasePoint(t,e){return{topLeft:this.getRotatedPoint(t[0],e),topRight:this.getRotatedPoint(t[1],e),bottomLeft:this.getRotatedPoint(t[2],e),bottomRight:this.getRotatedPoint(t[3],e)}}getRotatedPoint(t,e){return{x:t.x*Math.cos(this.angle)+t.y*Math.sin(this.angle)+e.x,y:t.y*Math.cos(this.angle)-t.x*Math.sin(this.angle)+e.y}}calculateIntersectPoint(t){const e={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner==="top"?(this.topIntersectPoint=w.GetIntersectBetweenTwoSegment(e,[t,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=w.GetIntersectBetweenTwoSegment(e,[t,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=w.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=w.GetIntersectBetweenTwoSegment(e,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=w.GetIntersectBetweenTwoSegment(e,[t,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=w.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(t,e,n){let h=t;const b=w.LimitPointToCircle(e,this.pageWidth,h);h!==b&&(h=b,this.updateAngleAndGeometry(h));const g=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let f=this.rect.bottomRight,E=this.rect.topLeft;if(this.corner==="bottom"&&(f=this.rect.topRight,E=this.rect.bottomLeft),f.x<=0){const J=w.LimitPointToCircle(n,g,E);J!==h&&(h=J,this.updateAngleAndGeometry(h))}return h}getSegmentToShadowLine(){const t=this.getShadowStartPoint();return[t,t!==this.sideIntersectPoint&&this.sideIntersectPoint!==null?this.sideIntersectPoint:this.bottomIntersectPoint]}}class L{constructor(t,e){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=t,this.app=e}fold(t){this.setState("user_fold"),this.calc===null&&this.start(t),this.do(this.render.convertToPage(t))}flip(t){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(t)||(this.calc!==null&&this.render.finishAnimation(),!this.start(t)))return;const e=this.getBoundsRect();this.setState("flipping");const n=e.height/10,h=this.calc.getCorner()==="bottom"?e.height-n:n,b=this.calc.getCorner()==="bottom"?e.height:0;this.calc.calc({x:e.pageWidth-n,y:h}),this.animateFlippingTo({x:e.pageWidth-n,y:h},{x:-e.pageWidth,y:b},!0)}start(t){this.reset();const e=this.render.convertToBook(t),n=this.getBoundsRect(),h=this.getDirectionByPoint(e),b=e.y>=n.height/2?"bottom":"top";if(!this.checkDirection(h))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(h),this.bottomPage=this.app.getPageCollection().getBottomPage(h),this.render.getOrientation()==="landscape")if(h===1){const g=this.app.getPageCollection().nextBy(this.flippingPage);g!==null&&this.flippingPage.getDensity()!==g.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),g.setDrawingDensity("hard"))}else{const g=this.app.getPageCollection().prevBy(this.flippingPage);g!==null&&this.flippingPage.getDensity()!==g.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),g.setDrawingDensity("hard"))}return this.render.setDirection(h),this.calc=new C(h,b,n.pageWidth.toString(10),n.height.toString(10)),!0}catch{return!1}}do(t){if(this.calc!==null&&this.calc.calc(t)){const e=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===0?this.flippingPage.setHardAngle(90*(200-2*e)/100):this.flippingPage.setHardAngle(-90*(200-2*e)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),e,this.calc.getDirection())}}flipToPage(t,e){const n=this.app.getPageCollection().getCurrentSpreadIndex(),h=this.app.getPageCollection().getSpreadIndexByPage(t);try{h>n&&(this.app.getPageCollection().setCurrentSpreadIndex(h-1),this.flipNext(e)),h<n&&(this.app.getPageCollection().setCurrentSpreadIndex(h+1),this.flipPrev(e))}catch{}}flipNext(t){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:t==="top"?1:this.render.getRect().height-2})}flipPrev(t){this.flip({x:10,y:t==="top"?1:this.render.getRect().height-2})}stopMove(){if(this.calc===null)return;const t=this.calc.getPosition(),e=this.getBoundsRect(),n=this.calc.getCorner()==="bottom"?e.height:0;t.x<=0?this.animateFlippingTo(t,{x:-e.pageWidth,y:n},!0):this.animateFlippingTo(t,{x:e.pageWidth,y:n},!1)}showCorner(t){if(!this.checkState("read","fold_corner"))return;const e=this.getBoundsRect(),n=e.pageWidth;if(this.isPointOnCorners(t))if(this.calc===null){if(!this.start(t))return;this.setState("fold_corner"),this.calc.calc({x:n-1,y:1});const h=50,b=this.calc.getCorner()==="bottom"?e.height-1:1,g=this.calc.getCorner()==="bottom"?e.height-h:h;this.animateFlippingTo({x:n-1,y:b},{x:n-h,y:g},!1,!1)}else this.do(this.render.convertToPage(t));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(t,e,n,h=!0){const b=w.GetCordsFromTwoPoint(t,e),g=[];for(const E of b)g.push(()=>this.do(E));const f=this.getAnimationDuration(b.length);this.render.startAnimation(g,f,()=>{this.calc&&(n&&(this.calc.getDirection()===1?this.app.turnToPrevPage():this.app.turnToNextPage()),h&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(t){this.state!==t&&(this.app.updateState(t),this.state=t)}getDirectionByPoint(t){const e=this.getBoundsRect();if(this.render.getOrientation()==="portrait"){if(t.x-e.pageWidth<=e.width/5)return 1}else if(t.x<e.width/2)return 1;return 0}getAnimationDuration(t){const e=this.app.getSettings().flippingTime;return t>=1e3?e:t/1e3*e}checkDirection(t){return t===0?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...t){for(const e of t)if(this.state===e)return!0;return!1}isPointOnCorners(t){const e=this.getBoundsRect(),n=e.pageWidth,h=Math.sqrt(Math.pow(n,2)+Math.pow(e.height,2))/5,b=this.render.convertToBook(t);return b.x>0&&b.y>0&&b.x<e.width&&b.y<e.height&&(b.x<h||b.x>e.width-h)&&(b.y<h||b.y>e.height-h)}}class R{constructor(t,e){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=e,this.app=t;const n=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=n.exec(window.navigator.userAgent)!==null}render(t){if(this.animation!==null){const e=Math.round((t-this.animation.startedAt)/this.animation.durationFrame);e<this.animation.frames.length?this.animation.frames[e]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=t,this.drawFrame()}start(){this.update();const t=e=>{this.render(e),requestAnimationFrame(t)};requestAnimationFrame(t)}startAnimation(t,e,n){this.finishAnimation(),this.animation={frames:t,duration:e,durationFrame:e/t.length,onAnimateEnd:n,startedAt:this.timer}}finishAnimation(){this.animation!==null&&(this.animation.frames[this.animation.frames.length-1](),this.animation.onAnimateEnd!==null&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const t=this.calculateBoundsRect();this.orientation!==t&&(this.orientation=t,this.app.updateOrientation(t))}calculateBoundsRect(){let t="landscape";const e=this.getBlockWidth(),n=e/2,h=this.getBlockHeight()/2,b=this.setting.width/this.setting.height;let g=this.setting.width,f=this.setting.height,E=n-g;return this.setting.size==="stretch"?(e<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(t="portrait"),g=t==="portrait"?this.getBlockWidth():this.getBlockWidth()/2,g>this.setting.maxWidth&&(g=this.setting.maxWidth),f=g/b,f>this.getBlockHeight()&&(f=this.getBlockHeight(),g=f*b),E=t==="portrait"?n-g/2-g:n-g):e<2*g&&this.app.getSettings().usePortrait&&(t="portrait",E=n-g/2-g),this.boundsRect={left:E,top:h-f/2,width:2*g,height:f,pageWidth:g},t}setShadowData(t,e,n,h){if(!this.app.getSettings().drawShadow)return;const b=100*this.getSettings().maxShadowOpacity;this.shadow={pos:t,angle:e,width:3*this.getRect().pageWidth/4*n/100,opacity:(100-n)*b/100/100,direction:h,progress:2*n}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return this.boundsRect===null&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(t){this.pageRect=t}setDirection(t){this.direction=t}setRightPage(t){t!==null&&t.setOrientation(1),this.rightPage=t}setLeftPage(t){t!==null&&t.setOrientation(0),this.leftPage=t}setBottomPage(t){t!==null&&t.setOrientation(this.direction===1?0:1),this.bottomPage=t}setFlippingPage(t){t!==null&&t.setOrientation(this.direction===0&&this.orientation!=="portrait"?0:1),this.flippingPage=t}convertToBook(t){const e=this.getRect();return{x:t.x-e.left,y:t.y-e.top}}isSafari(){return this.safari}convertToPage(t,e){e||(e=this.direction);const n=this.getRect();return{x:e===0?t.x-n.left-n.width/2:n.width/2-t.x+n.left,y:t.y-n.top}}convertToGlobal(t,e){if(e||(e=this.direction),t==null)return null;const n=this.getRect();return{x:e===0?t.x+n.left+n.width/2:n.width/2-t.x+n.left,y:t.y+n.top}}convertRectToGlobal(t,e){return e||(e=this.direction),{topLeft:this.convertToGlobal(t.topLeft,e),topRight:this.convertToGlobal(t.topRight,e),bottomLeft:this.convertToGlobal(t.bottomLeft,e),bottomRight:this.convertToGlobal(t.bottomRight,e)}}}class T extends R{constructor(t,e,n){super(t,e),this.canvas=n,this.ctx=n.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),this.orientation!=="portrait"&&this.leftPage!=null&&this.leftPage.simpleDraw(0),this.rightPage!=null&&this.rightPage.simpleDraw(1),this.bottomPage!=null&&this.bottomPage.draw(),this.drawBookShadow(),this.flippingPage!=null&&this.flippingPage.draw(),this.shadow!=null&&(this.drawOuterShadow(),this.drawInnerShadow());const t=this.getRect();this.orientation==="portrait"&&(this.ctx.beginPath(),this.ctx.rect(t.left+t.pageWidth,t.top,t.width,t.height),this.ctx.clip())}drawBookShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=t.width/20;this.ctx.rect(t.left,t.top,t.width,t.height);const n={x:t.left+t.width/2-e/2,y:0};this.ctx.translate(n.x,n.y);const h=this.ctx.createLinearGradient(0,0,e,0);h.addColorStop(0,"rgba(0, 0, 0, 0)"),h.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),h.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),h.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),h.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),h.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=h,this.ctx.fillRect(0,0,e,2*t.height),this.ctx.restore()}drawOuterShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t.left,t.top,t.width,t.height);const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const n=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===0?(this.ctx.translate(0,-100),n.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),n.addColorStop(0,"rgba(0, 0, 0, 0)"),n.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,this.shadow.width,2*t.height),this.ctx.restore()}drawInnerShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),n=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(n.topLeft.x,n.topLeft.y),this.ctx.lineTo(n.topRight.x,n.topRight.y),this.ctx.lineTo(n.bottomRight.x,n.bottomRight.y),this.ctx.lineTo(n.bottomLeft.x,n.bottomLeft.y),this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const h=3*this.shadow.width/4,b=this.ctx.createLinearGradient(0,0,h,0);this.shadow.direction===0?(this.ctx.translate(-h,-100),b.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),b.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),b.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),b.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=b,this.ctx.fillRect(0,0,h,2*t.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class u{constructor(t,e,n){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=b=>{if(this.checkTarget(b.target)){const g=this.getMousePos(b.clientX,b.clientY);this.app.startUserTouch(g),b.preventDefault()}},this.onTouchStart=b=>{if(this.checkTarget(b.target)&&b.changedTouches.length>0){const g=b.changedTouches[0],f=this.getMousePos(g.clientX,g.clientY);this.touchPoint={point:f,time:Date.now()},setTimeout(()=>{this.touchPoint!==null&&this.app.startUserTouch(f)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||b.preventDefault()}},this.onMouseUp=b=>{const g=this.getMousePos(b.clientX,b.clientY);this.app.userStop(g)},this.onMouseMove=b=>{const g=this.getMousePos(b.clientX,b.clientY);this.app.userMove(g,!1)},this.onTouchMove=b=>{if(b.changedTouches.length>0){const g=b.changedTouches[0],f=this.getMousePos(g.clientX,g.clientY);this.app.getSettings().mobileScrollSupport?(this.touchPoint!==null&&(Math.abs(this.touchPoint.point.x-f.x)>10||this.app.getState()!=="read")&&b.cancelable&&this.app.userMove(f,!0),this.app.getState()!=="read"&&b.preventDefault()):this.app.userMove(f,!0)}},this.onTouchEnd=b=>{if(b.changedTouches.length>0){const g=b.changedTouches[0],f=this.getMousePos(g.clientX,g.clientY);let E=!1;if(this.touchPoint!==null){const J=f.x-this.touchPoint.point.x,nt=Math.abs(f.y-this.touchPoint.point.y);Math.abs(J)>this.swipeDistance&&nt<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(J>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),E=!0),this.touchPoint=null}this.app.userStop(f,E)}},this.parentElement=t,t.classList.add("stf__parent"),t.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=t.querySelector(".stf__wrapper"),this.app=e;const h=this.app.getSettings().usePortrait?1:2;t.style.minWidth=n.minWidth*h+"px",t.style.minHeight=n.minHeight+"px",n.size==="fixed"&&(t.style.minWidth=n.width*h+"px",t.style.minHeight=n.height+"px"),n.autoSize&&(t.style.width="100%",t.style.maxWidth=2*n.maxWidth+"px"),t.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=n.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(t){this.wrapper.classList.remove("--portrait","--landscape"),t==="portrait"?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(t,e){const n=this.distElement.getBoundingClientRect();return{x:t-n.left,y:e-n.top}}checkTarget(t){return!this.app.getSettings().clickEventForward||!["a","button"].includes(t.tagName.toLowerCase())}}class s extends u{constructor(t,e,n,h){super(t,e,n),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=t.querySelector(".stf__block"),this.items=h;for(const b of h)this.distElement.appendChild(b);this.setHandlers()}clear(){for(const t of this.items)this.parentElement.appendChild(t)}updateItems(t){this.removeHandlers(),this.distElement.innerHTML="";for(const e of t)this.distElement.appendChild(e);this.items=t,this.setHandlers()}update(){this.app.getRender().update()}}class o extends u{constructor(t,e,n){super(t,e,n),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=t.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const t=getComputedStyle(this.canvas),e=parseInt(t.getPropertyValue("width"),10),n=parseInt(t.getPropertyValue("height"),10);this.canvas.width=e,this.canvas.height=n}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class d extends R{constructor(t,e,n){super(t,e),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=n,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",`<div class="stf__outerShadow"></div>
             <div class="stf__innerShadow"></div>
             <div class="stf__hardShadow"></div>
             <div class="stf__hardInnerShadow"></div>`),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const t=this.getRect(),e=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let n=(100-e)*(2.5*t.pageWidth)/100+20;n>t.pageWidth&&(n=t.pageWidth);let h=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+5).toString(10)};
            width: ${n}px;
            height: ${t.height}px;
            background: linear-gradient(to right,
                rgba(0, 0, 0, ${this.shadow.opacity*e/100}) 5%,
                rgba(0, 0, 0, 0) 100%);
            left: ${t.left+t.width/2}px;
            transform-origin: 0 0;
        `;h+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=h}drawHardOuterShadow(){const t=this.getRect();let e=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*t.pageWidth)/100+20;e>t.pageWidth&&(e=t.pageWidth);let n=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+4).toString(10)};
            width: ${e}px;
            height: ${t.height}px;
            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);
            left: ${t.left+t.width/2}px;
            transform-origin: 0 0;
        `;n+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=n}drawInnerShadow(){const t=this.getRect(),e=3*this.shadow.width/4,n=this.getDirection()===0?e:0,h=this.getDirection()===0?"to left":"to right",b=this.convertToGlobal(this.shadow.pos),g=this.shadow.angle+3*Math.PI/2,f=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let E="polygon( ";for(const nt of f){let Z=this.getDirection()===1?{x:-nt.x+this.shadow.pos.x,y:nt.y-this.shadow.pos.y}:{x:nt.x-this.shadow.pos.x,y:nt.y-this.shadow.pos.y};Z=w.GetRotatedPoint(Z,{x:n,y:100},g),E+=Z.x+"px "+Z.y+"px, "}E=E.slice(0,-2),E+=")";const J=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${e}px;
            height: ${2*t.height}px;
            background: linear-gradient(${h},
                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,
                rgba(0, 0, 0, 0.05) 15%,
                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,
                rgba(0, 0, 0, 0) 100%);
            transform-origin: ${n}px 100px;
            transform: translate3d(${b.x-n}px, ${b.y-100}px, 0) rotate(${g}rad);
            clip-path: ${E};
            -webkit-clip-path: ${E};
        `;this.innerShadow.style.cssText=J}drawOuterShadow(){const t=this.getRect(),e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),n=this.shadow.angle+3*Math.PI/2,h=this.getDirection()===1?this.shadow.width:0,b=this.getDirection()===0?"to right":"to left",g=[{x:0,y:0},{x:t.pageWidth,y:0},{x:t.pageWidth,y:t.height},{x:0,y:t.height}];let f="polygon( ";for(const J of g)if(J!==null){let nt=this.getDirection()===1?{x:-J.x+this.shadow.pos.x,y:J.y-this.shadow.pos.y}:{x:J.x-this.shadow.pos.x,y:J.y-this.shadow.pos.y};nt=w.GetRotatedPoint(nt,{x:h,y:100},n),f+=nt.x+"px "+nt.y+"px, "}f=f.slice(0,-2),f+=")";const E=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${this.shadow.width}px;
            height: ${2*t.height}px;
            background: linear-gradient(${b}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));
            transform-origin: ${h}px 100px;
            transform: translate3d(${e.x-h}px, ${e.y-100}px, 0) rotate(${n}rad);
            clip-path: ${f};
            -webkit-clip-path: ${f};
        `;this.outerShadow.style.cssText=E}drawLeftPage(){this.orientation!=="portrait"&&this.leftPage!==null&&(this.direction===1&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){this.rightPage!==null&&(this.direction===0&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(this.bottomPage===null)return;const t=this.flippingPage!=null?this.flippingPage.getDrawingDensity():null;this.orientation==="portrait"&&this.direction===1||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(t))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),this.flippingPage!=null&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),this.shadow!=null&&this.flippingPage!==null&&(this.flippingPage.getDrawingDensity()==="soft"?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const t of this.app.getPageCollection().getPages())t!==this.leftPage&&t!==this.rightPage&&t!==this.flippingPage&&t!==this.bottomPage&&(t.getElement().style.cssText="display: none"),t.getTemporaryCopy()!==this.flippingPage&&t.hideTemporaryCopy()}update(){super.update(),this.rightPage!==null&&this.rightPage.setOrientation(1),this.leftPage!==null&&this.leftPage.setOrientation(0)}}class P{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(t){const e=this._default;if(Object.assign(e,t),e.size!=="stretch"&&e.size!=="fixed")throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(e.width<=0||e.height<=0)throw new Error("Invalid width or height");if(e.flippingTime<=0)throw new Error("Invalid flipping time");return e.size==="stretch"?(e.minWidth<=0&&(e.minWidth=100),e.maxWidth<e.minWidth&&(e.maxWidth=2e3),e.minHeight<=0&&(e.minHeight=100),e.maxHeight<e.minHeight&&(e.maxHeight=2e3)):(e.minWidth=e.width,e.maxWidth=e.width,e.minHeight=e.height,e.maxHeight=e.height),e}}(function(m,t){t===void 0&&(t={});var e=t.insertAt;if(m&&typeof document<"u"){var n=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");h.type="text/css",e==="top"&&n.firstChild?n.insertBefore(h,n.firstChild):n.appendChild(h),h.styleSheet?h.styleSheet.cssText=m:h.appendChild(document.createTextNode(m))}})(`.stf__parent {
  position: relative;
  display: block;
  box-sizing: border-box;
  transform: translateZ(0);

  -ms-touch-action: pan-y;
  touch-action: pan-y;
}

.sft__wrapper {
  position: relative;
  width: 100%;
  box-sizing: border-box;
}

.stf__parent canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}

.stf__block {
  position: absolute;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  perspective: 2000px;
}

.stf__item {
  display: none;
  position: absolute;
  transform-style: preserve-3d;
}

.stf__outerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__innerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardInnerShadow {
  position: absolute;
  left: 0;
  top: 0;
}`),A.PageFlip=class extends class{constructor(){this.events=new Map}on(m,t){return this.events.has(m)?this.events.get(m).push(t):this.events.set(m,[t]),this}off(m){this.events.delete(m)}trigger(m,t,e=null){if(this.events.has(m))for(const n of this.events.get(m))n({data:e,object:t})}}{constructor(m,t){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=new P().getSettings(t),this.block=m}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(m){this.ui=new o(this.block,this,this.setting);const t=this.ui.getCanvas();this.render=new T(this,this.setting,t),this.flipController=new L(this.render,this),this.pages=new D(this,this.render,m),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(m){this.ui=new s(this.block,this,this.setting,m),this.render=new d(this,this.setting,this.ui.getDistElement()),this.flipController=new L(this.render,this),this.pages=new y(this,this.render,this.ui.getDistElement(),m),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(m){const t=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new D(this,this.render,m),this.pages.load(),this.pages.show(t),this.trigger("update",this,{page:t,mode:this.render.getOrientation()})}updateFromHtml(m){const t=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new y(this,this.render,this.ui.getDistElement(),m),this.pages.load(),this.ui.updateItems(m),this.render.reload(),this.pages.show(t),this.trigger("update",this,{page:t,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(m){this.pages.show(m)}flipNext(m="top"){this.flipController.flipNext(m)}flipPrev(m="top"){this.flipController.flipPrev(m)}flip(m,t="top"){this.flipController.flipToPage(m,t)}updateState(m){this.trigger("changeState",this,m)}updatePageIndex(m){this.trigger("flip",this,m)}updateOrientation(m){this.ui.setOrientationStyle(m),this.update(),this.trigger("changeOrientation",this,m)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(m){return this.pages.getPage(m)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(m){this.mousePosition=m,this.isUserTouch=!0,this.isUserMove=!1}userMove(m,t){this.isUserTouch||t||!this.setting.showPageCorners?this.isUserTouch&&w.GetDistanceBetweenTwoPoint(this.mousePosition,m)>5&&(this.isUserMove=!0,this.flipController.fold(m)):this.flipController.showCorner(m)}userStop(m,t=!1){this.isUserTouch&&(this.isUserTouch=!1,t||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(m)))}},Object.defineProperty(A,"__esModule",{value:!0})})})(pageFlip_browser,pageFlip_browser.exports);var pageFlip_browserExports=pageFlip_browser.exports;const HTMLFlipBookForward=React.forwardRef((k,a)=>{const A=reactExports.useRef(null),i=reactExports.useRef([]),l=reactExports.useRef(),[M,D]=reactExports.useState([]);reactExports.useImperativeHandle(a,()=>({pageFlip:()=>l.current}));const w=reactExports.useCallback(()=>{l.current&&l.current.clear()},[]),S=reactExports.useCallback(()=>{const y=l.current;y&&(y.off("flip"),y.off("changeOrientation"),y.off("changeState"),y.off("init"),y.off("update"))},[]);return reactExports.useEffect(()=>{if(i.current=[],k.children){const y=React.Children.map(k.children,C=>React.cloneElement(C,{ref:L=>{L&&i.current.push(L)}}));(!k.renderOnlyPageLengthChange||M.length!==y.length)&&(y.length<M.length&&w(),D(y))}},[k.children]),reactExports.useEffect(()=>{const y=()=>{const C=l.current;C&&(k.onFlip&&C.on("flip",L=>k.onFlip(L)),k.onChangeOrientation&&C.on("changeOrientation",L=>k.onChangeOrientation(L)),k.onChangeState&&C.on("changeState",L=>k.onChangeState(L)),k.onInit&&C.on("init",L=>k.onInit(L)),k.onUpdate&&C.on("update",L=>k.onUpdate(L)))};M.length>0&&i.current.length>0&&(S(),A.current&&!l.current&&(l.current=new pageFlip_browserExports.PageFlip(A.current,k)),l.current.getFlipController()?l.current.updateFromHtml(i.current):l.current.loadFromHTML(i.current),y())},[M]),React.createElement("div",{ref:A,className:k.className,style:k.style},M)}),HTMLFlipBook=React.memo(HTMLFlipBookForward),HTMLFlipBook$1=HTMLFlipBook;function commonjsRequire(k){throw new Error('Could not dynamically require "'+k+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(a,A){module.exports=A()})(globalThis,()=>(()=>{var __webpack_modules__=[,(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.VerbosityLevel=a.Util=a.UnknownErrorException=a.UnexpectedResponseException=a.UNSUPPORTED_FEATURES=a.TextRenderingMode=a.StreamType=a.RenderingIntentFlag=a.PermissionFlag=a.PasswordResponses=a.PasswordException=a.PageActionEventType=a.OPS=a.MissingPDFException=a.LINE_FACTOR=a.LINE_DESCENT_FACTOR=a.InvalidPDFException=a.ImageKind=a.IDENTITY_MATRIX=a.FormatError=a.FontType=a.FeatureTest=a.FONT_IDENTITY_MATRIX=a.DocumentActionEventType=a.CMapCompressionType=a.BaseException=a.AnnotationType=a.AnnotationStateModelType=a.AnnotationReviewState=a.AnnotationReplyType=a.AnnotationMode=a.AnnotationMarkedState=a.AnnotationFlag=a.AnnotationFieldFlag=a.AnnotationEditorType=a.AnnotationEditorPrefix=a.AnnotationEditorParamsType=a.AnnotationBorderStyleType=a.AnnotationActionEventType=a.AbortException=void 0,a.arrayByteLength=rt,a.arraysToBytes=ut,a.assert=_,a.bytesToString=N,a.createPromiseCapability=gt,a.createValidAbsoluteUrl=I,a.escapeString=Tt,a.getModificationDate=at,a.getVerbosityLevel=st,a.info=ht,a.isArrayBuffer=Dt,a.isArrayEqual=te,a.isAscii=Mt,a.objectFromMap=it,a.objectSize=lt,a.setVerbosityLevel=K,a.shadow=B,a.string32=et,a.stringToBytes=G,a.stringToPDFString=xt,a.stringToUTF16BEString=Ft,a.stringToUTF8String=zt,a.unreachable=H,a.utf8StringToString=wt,a.warn=_t,A(2);const i=[1,0,0,1,0,0];a.IDENTITY_MATRIX=i;const l=[.001,0,0,.001,0,0];a.FONT_IDENTITY_MATRIX=l;const M=1.35;a.LINE_FACTOR=M;const D=.35;a.LINE_DESCENT_FACTOR=D;const w={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};a.RenderingIntentFlag=w;const S={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};a.AnnotationMode=S;const y="pdfjs_internal_editor_";a.AnnotationEditorPrefix=y;const C={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};a.AnnotationEditorType=C;const L={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};a.AnnotationEditorParamsType=L;const R={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};a.PermissionFlag=R;const T={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};a.TextRenderingMode=T;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};a.ImageKind=u;const s={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};a.AnnotationType=s;const o={MARKED:"Marked",REVIEW:"Review"};a.AnnotationStateModelType=o;const d={MARKED:"Marked",UNMARKED:"Unmarked"};a.AnnotationMarkedState=d;const P={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};a.AnnotationReviewState=P;const m={GROUP:"Group",REPLY:"R"};a.AnnotationReplyType=m;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};a.AnnotationFlag=t;const e={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};a.AnnotationFieldFlag=e;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};a.AnnotationBorderStyleType=n;const h={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};a.AnnotationActionEventType=h;const b={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};a.DocumentActionEventType=b;const g={O:"PageOpen",C:"PageClose"};a.PageActionEventType=g;const f={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};a.StreamType=f;const E={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};a.FontType=E;const J={ERRORS:0,WARNINGS:1,INFOS:5};a.VerbosityLevel=J;const nt={NONE:0,BINARY:1,STREAM:2};a.CMapCompressionType=nt;const Z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};a.OPS=Z;const Q={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};a.UNSUPPORTED_FEATURES=Q;const q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};a.PasswordResponses=q;let V=J.WARNINGS;function K(tt){Number.isInteger(tt)&&(V=tt)}function st(){return V}function ht(tt){V>=J.INFOS&&console.log(`Info: ${tt}`)}function _t(tt){V>=J.WARNINGS&&console.log(`Warning: ${tt}`)}function H(tt){throw new Error(tt)}function _(tt,$){tt||H($)}function p(tt){if(!tt)return!1;switch(tt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function I(tt,$=null,z=null){if(!tt)return null;try{if(z&&typeof tt=="string"){if(z.addDefaultProtocol&&tt.startsWith("www.")){const bt=tt.match(/\./g);bt&&bt.length>=2&&(tt=`http://${tt}`)}if(z.tryConvertEncoding)try{tt=zt(tt)}catch{}}const mt=$?new URL(tt,$):new URL(tt);if(p(mt))return mt}catch{}return null}function B(tt,$,z){return Object.defineProperty(tt,$,{value:z,enumerable:!0,configurable:!0,writable:!1}),z}const U=function(){function $(z,mt){this.constructor===$&&H("Cannot initialize BaseException."),this.message=z,this.name=mt}return $.prototype=new Error,$.constructor=$,$}();a.BaseException=U;class W extends U{constructor($,z){super($,"PasswordException"),this.code=z}}a.PasswordException=W;class X extends U{constructor($,z){super($,"UnknownErrorException"),this.details=z}}a.UnknownErrorException=X;class Y extends U{constructor($){super($,"InvalidPDFException")}}a.InvalidPDFException=Y;class c extends U{constructor($){super($,"MissingPDFException")}}a.MissingPDFException=c;class v extends U{constructor($,z){super($,"UnexpectedResponseException"),this.status=z}}a.UnexpectedResponseException=v;class x extends U{constructor($){super($,"FormatError")}}a.FormatError=x;class F extends U{constructor($){super($,"AbortException")}}a.AbortException=F;function N(tt){(typeof tt!="object"||tt===null||tt.length===void 0)&&H("Invalid argument for bytesToString");const $=tt.length,z=8192;if($<z)return String.fromCharCode.apply(null,tt);const mt=[];for(let bt=0;bt<$;bt+=z){const At=Math.min(bt+z,$),Pt=tt.subarray(bt,At);mt.push(String.fromCharCode.apply(null,Pt))}return mt.join("")}function G(tt){typeof tt!="string"&&H("Invalid argument for stringToBytes");const $=tt.length,z=new Uint8Array($);for(let mt=0;mt<$;++mt)z[mt]=tt.charCodeAt(mt)&255;return z}function rt(tt){if(tt.length!==void 0)return tt.length;if(tt.byteLength!==void 0)return tt.byteLength;H("Invalid argument for arrayByteLength")}function ut(tt){const $=tt.length;if($===1&&tt[0]instanceof Uint8Array)return tt[0];let z=0;for(let At=0;At<$;At++)z+=rt(tt[At]);let mt=0;const bt=new Uint8Array(z);for(let At=0;At<$;At++){let Pt=tt[At];Pt instanceof Uint8Array||(typeof Pt=="string"?Pt=G(Pt):Pt=new Uint8Array(Pt));const Ct=Pt.byteLength;bt.set(Pt,mt),mt+=Ct}return bt}function et(tt){return String.fromCharCode(tt>>24&255,tt>>16&255,tt>>8&255,tt&255)}function lt(tt){return Object.keys(tt).length}function it(tt){const $=Object.create(null);for(const[z,mt]of tt)$[z]=mt;return $}function ct(){const tt=new Uint8Array(4);return tt[0]=1,new Uint32Array(tt.buffer,0,1)[0]===1}function ft(){try{return new Function(""),!0}catch{return!1}}class j{static get isLittleEndian(){return B(this,"isLittleEndian",ct())}static get isEvalSupported(){return B(this,"isEvalSupported",ft())}static get isOffscreenCanvasSupported(){return B(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}a.FeatureTest=j;const pt=[...Array(256).keys()].map(tt=>tt.toString(16).padStart(2,"0"));class vt{static makeHexColor($,z,mt){return`#${pt[$]}${pt[z]}${pt[mt]}`}static scaleMinMax($,z){let mt;$[0]?($[0]<0&&(mt=z[0],z[0]=z[1],z[1]=mt),z[0]*=$[0],z[1]*=$[0],$[3]<0&&(mt=z[2],z[2]=z[3],z[3]=mt),z[2]*=$[3],z[3]*=$[3]):(mt=z[0],z[0]=z[2],z[2]=mt,mt=z[1],z[1]=z[3],z[3]=mt,$[1]<0&&(mt=z[2],z[2]=z[3],z[3]=mt),z[2]*=$[1],z[3]*=$[1],$[2]<0&&(mt=z[0],z[0]=z[1],z[1]=mt),z[0]*=$[2],z[1]*=$[2]),z[0]+=$[4],z[1]+=$[4],z[2]+=$[5],z[3]+=$[5]}static transform($,z){return[$[0]*z[0]+$[2]*z[1],$[1]*z[0]+$[3]*z[1],$[0]*z[2]+$[2]*z[3],$[1]*z[2]+$[3]*z[3],$[0]*z[4]+$[2]*z[5]+$[4],$[1]*z[4]+$[3]*z[5]+$[5]]}static applyTransform($,z){const mt=$[0]*z[0]+$[1]*z[2]+z[4],bt=$[0]*z[1]+$[1]*z[3]+z[5];return[mt,bt]}static applyInverseTransform($,z){const mt=z[0]*z[3]-z[1]*z[2],bt=($[0]*z[3]-$[1]*z[2]+z[2]*z[5]-z[4]*z[3])/mt,At=(-$[0]*z[1]+$[1]*z[0]+z[4]*z[1]-z[5]*z[0])/mt;return[bt,At]}static getAxialAlignedBoundingBox($,z){const mt=vt.applyTransform($,z),bt=vt.applyTransform($.slice(2,4),z),At=vt.applyTransform([$[0],$[3]],z),Pt=vt.applyTransform([$[2],$[1]],z);return[Math.min(mt[0],bt[0],At[0],Pt[0]),Math.min(mt[1],bt[1],At[1],Pt[1]),Math.max(mt[0],bt[0],At[0],Pt[0]),Math.max(mt[1],bt[1],At[1],Pt[1])]}static inverseTransform($){const z=$[0]*$[3]-$[1]*$[2];return[$[3]/z,-$[1]/z,-$[2]/z,$[0]/z,($[2]*$[5]-$[4]*$[3])/z,($[4]*$[1]-$[5]*$[0])/z]}static apply3dTransform($,z){return[$[0]*z[0]+$[1]*z[1]+$[2]*z[2],$[3]*z[0]+$[4]*z[1]+$[5]*z[2],$[6]*z[0]+$[7]*z[1]+$[8]*z[2]]}static singularValueDecompose2dScale($){const z=[$[0],$[2],$[1],$[3]],mt=$[0]*z[0]+$[1]*z[2],bt=$[0]*z[1]+$[1]*z[3],At=$[2]*z[0]+$[3]*z[2],Pt=$[2]*z[1]+$[3]*z[3],Ct=(mt+Pt)/2,Ot=Math.sqrt((mt+Pt)**2-4*(mt*Pt-At*bt))/2,kt=Ct+Ot||1,Et=Ct-Ot||1;return[Math.sqrt(kt),Math.sqrt(Et)]}static normalizeRect($){const z=$.slice(0);return $[0]>$[2]&&(z[0]=$[2],z[2]=$[0]),$[1]>$[3]&&(z[1]=$[3],z[3]=$[1]),z}static intersect($,z){const mt=Math.max(Math.min($[0],$[2]),Math.min(z[0],z[2])),bt=Math.min(Math.max($[0],$[2]),Math.max(z[0],z[2]));if(mt>bt)return null;const At=Math.max(Math.min($[1],$[3]),Math.min(z[1],z[3])),Pt=Math.min(Math.max($[1],$[3]),Math.max(z[1],z[3]));return At>Pt?null:[mt,At,bt,Pt]}static bezierBoundingBox($,z,mt,bt,At,Pt,Ct,Ot){const kt=[],Et=[[],[]];let Nt,Lt,Ut,Rt,jt,Ht,Vt,Xt;for(let Yt=0;Yt<2;++Yt){if(Yt===0?(Lt=6*$-12*mt+6*At,Nt=-3*$+9*mt-9*At+3*Ct,Ut=3*mt-3*$):(Lt=6*z-12*bt+6*Pt,Nt=-3*z+9*bt-9*Pt+3*Ot,Ut=3*bt-3*z),Math.abs(Nt)<1e-12){if(Math.abs(Lt)<1e-12)continue;Rt=-Ut/Lt,0<Rt&&Rt<1&&kt.push(Rt);continue}Vt=Lt*Lt-4*Ut*Nt,Xt=Math.sqrt(Vt),!(Vt<0)&&(jt=(-Lt+Xt)/(2*Nt),0<jt&&jt<1&&kt.push(jt),Ht=(-Lt-Xt)/(2*Nt),0<Ht&&Ht<1&&kt.push(Ht))}let qt=kt.length,Bt;const Gt=qt;for(;qt--;)Rt=kt[qt],Bt=1-Rt,Et[0][qt]=Bt*Bt*Bt*$+3*Bt*Bt*Rt*mt+3*Bt*Rt*Rt*At+Rt*Rt*Rt*Ct,Et[1][qt]=Bt*Bt*Bt*z+3*Bt*Bt*Rt*bt+3*Bt*Rt*Rt*Pt+Rt*Rt*Rt*Ot;return Et[0][Gt]=$,Et[1][Gt]=z,Et[0][Gt+1]=Ct,Et[1][Gt+1]=Ot,Et[0].length=Et[1].length=Gt+2,[Math.min(...Et[0]),Math.min(...Et[1]),Math.max(...Et[0]),Math.max(...Et[1])]}}a.Util=vt;const St=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function xt(tt){if(tt[0]>="ï"){let z;if(tt[0]==="þ"&&tt[1]==="ÿ"?z="utf-16be":tt[0]==="ÿ"&&tt[1]==="þ"?z="utf-16le":tt[0]==="ï"&&tt[1]==="»"&&tt[2]==="¿"&&(z="utf-8"),z)try{const mt=new TextDecoder(z,{fatal:!0}),bt=G(tt);return mt.decode(bt)}catch(mt){_t(`stringToPDFString: "${mt}".`)}}const $=[];for(let z=0,mt=tt.length;z<mt;z++){const bt=St[tt.charCodeAt(z)];$.push(bt?String.fromCharCode(bt):tt.charAt(z))}return $.join("")}function Tt(tt){return tt.replace(/([()\\\n\r])/g,$=>$===`
`?"\\n":$==="\r"?"\\r":`\\${$}`)}function Mt(tt){return/^[\x00-\x7F]*$/.test(tt)}function Ft(tt){const $=["þÿ"];for(let z=0,mt=tt.length;z<mt;z++){const bt=tt.charCodeAt(z);$.push(String.fromCharCode(bt>>8&255),String.fromCharCode(bt&255))}return $.join("")}function zt(tt){return decodeURIComponent(escape(tt))}function wt(tt){return unescape(encodeURIComponent(tt))}function Dt(tt){return typeof tt=="object"&&tt!==null&&tt.byteLength!==void 0}function te(tt,$){if(tt.length!==$.length)return!1;for(let z=0,mt=tt.length;z<mt;z++)if(tt[z]!==$[z])return!1;return!0}function at(tt=new Date){return[tt.getUTCFullYear().toString(),(tt.getUTCMonth()+1).toString().padStart(2,"0"),tt.getUTCDate().toString().padStart(2,"0"),tt.getUTCHours().toString().padStart(2,"0"),tt.getUTCMinutes().toString().padStart(2,"0"),tt.getUTCSeconds().toString().padStart(2,"0")].join("")}function gt(){const tt=Object.create(null);let $=!1;return Object.defineProperty(tt,"settled",{get(){return $}}),tt.promise=new Promise(function(z,mt){tt.resolve=function(bt){$=!0,z(bt)},tt.reject=function(bt){$=!0,mt(bt)}}),tt}},(k,a,A)=>{A(3)},(k,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isNodeJS=void 0;const A=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");a.isNodeJS=A},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var k,A,i,l,M,D,w,S,y,le,L,R;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:u,NodeCMapReaderFactory:s,NodeStandardFontDataFactory:o}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=u,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=o}let createPDFNetworkStream;function setPDFNetworkStreamFactory(u){createPDFNetworkStream=u}function getDocument(u){const s=new PDFDocumentLoadingTask;let o;if(typeof u=="string"||u instanceof URL)o={url:u};else if((0,_util.isArrayBuffer)(u))o={data:u};else if(u instanceof PDFDataRangeTransport)o={range:u};else{if(typeof u!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!u.url&&!u.data&&!u.range)throw new Error("Invalid parameter object: need either .data, .range or .url");o=u}const d=Object.create(null);let P=null,m=null;for(const e in o){const n=o[e];switch(e){case"url":if(typeof window<"u")try{d[e]=new URL(n,window.location).href;continue}catch(h){(0,_util.warn)(`Cannot create valid URL: "${h}".`)}else if(typeof n=="string"||n instanceof URL){d[e]=n.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":P=n;continue;case"worker":m=n;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&n instanceof Buffer)d[e]=new Uint8Array(n);else{if(n instanceof Uint8Array)break;if(typeof n=="string")d[e]=(0,_util.stringToBytes)(n);else if(typeof n=="object"&&n!==null&&!isNaN(n.length))d[e]=new Uint8Array(n);else if((0,_util.isArrayBuffer)(n))d[e]=new Uint8Array(n);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}d[e]=n}if(d.CMapReaderFactory=d.CMapReaderFactory||DefaultCMapReaderFactory,d.StandardFontDataFactory=d.StandardFontDataFactory||DefaultStandardFontDataFactory,d.ignoreErrors=d.stopAtErrors!==!0,d.fontExtraProperties=d.fontExtraProperties===!0,d.pdfBug=d.pdfBug===!0,d.enableXfa=d.enableXfa===!0,(!Number.isInteger(d.rangeChunkSize)||d.rangeChunkSize<1)&&(d.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof d.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(d.docBaseUrl))&&(d.docBaseUrl=null),(!Number.isInteger(d.maxImageSize)||d.maxImageSize<-1)&&(d.maxImageSize=-1),typeof d.cMapUrl!="string"&&(d.cMapUrl=null),typeof d.standardFontDataUrl!="string"&&(d.standardFontDataUrl=null),typeof d.useWorkerFetch!="boolean"&&(d.useWorkerFetch=d.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&d.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof d.isEvalSupported!="boolean"&&(d.isEvalSupported=!0),typeof d.disableFontFace!="boolean"&&(d.disableFontFace=_is_node.isNodeJS),typeof d.useSystemFonts!="boolean"&&(d.useSystemFonts=!_is_node.isNodeJS&&!d.disableFontFace),(typeof d.ownerDocument!="object"||d.ownerDocument===null)&&(d.ownerDocument=globalThis.document),typeof d.disableRange!="boolean"&&(d.disableRange=!1),typeof d.disableStream!="boolean"&&(d.disableStream=!1),typeof d.disableAutoFetch!="boolean"&&(d.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(d.verbosity),!m){const e={verbosity:d.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};m=e.port?PDFWorker.fromPort(e):new PDFWorker(e),s._worker=m}const t=s.docId;return m.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(m,d,P,t),n=new Promise(function(h){let b;P?b=new _transport_stream.PDFDataTransportStream({length:d.length,initialData:d.initialData,progressiveDone:d.progressiveDone,contentDispositionFilename:d.contentDispositionFilename,disableRange:d.disableRange,disableStream:d.disableStream},P):d.data||(b=createPDFNetworkStream({url:d.url,length:d.length,httpHeaders:d.httpHeaders,withCredentials:d.withCredentials,rangeChunkSize:d.rangeChunkSize,disableRange:d.disableRange,disableStream:d.disableStream})),h(b)});return Promise.all([e,n]).then(function([h,b]){if(s.destroyed)throw new Error("Loading aborted");const g=new _message_handler.MessageHandler(t,h,m.port),f=new WorkerTransport(g,s,b,d);s._transport=f,g.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(u,s,o,d){if(u.destroyed)throw new Error("Worker was destroyed");o&&(s.length=o.length,s.initialData=o.initialData,s.progressiveDone=o.progressiveDone,s.contentDispositionFilename=o.contentDispositionFilename);const P=await u.messageHandler.sendWithPromise("GetDocRequest",{docId:d,apiVersion:"2.16.105",source:{data:s.data,url:s.url,password:s.password,disableAutoFetch:s.disableAutoFetch,rangeChunkSize:s.rangeChunkSize,length:s.length},maxImageSize:s.maxImageSize,disableFontFace:s.disableFontFace,docBaseUrl:s.docBaseUrl,ignoreErrors:s.ignoreErrors,isEvalSupported:s.isEvalSupported,fontExtraProperties:s.fontExtraProperties,enableXfa:s.enableXfa,useSystemFonts:s.useSystemFonts,cMapUrl:s.useWorkerFetch?s.cMapUrl:null,standardFontDataUrl:s.useWorkerFetch?s.standardFontDataUrl:null});if(s.data&&(s.data=null),u.destroyed)throw new Error("Worker was destroyed");return P}const a=class a{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${oe(a,k)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var s;this.destroyed=!0,await((s=this._transport)==null?void 0:s.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};k=new WeakMap,ot(a,k,0);let PDFDocumentLoadingTask=a;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,o,d=!1,P=null){this.length=s,this.initialData=o,this.progressiveDone=d,this.contentDispositionFilename=P,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,o){for(const d of this._rangeListeners)d(s,o)}onDataProgress(s,o){this._readyCapability.promise.then(()=>{for(const d of this._progressListeners)d(s,o)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const o of this._progressiveReadListeners)o(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,o){this._pdfInfo=s,this._transport=o,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(s,o,d,P,m=!1){this._pageIndex=s,this._pageInfo=o,this._ownerDocument=P,this._transport=d,this._stats=m?new _display_utils.StatTimer:null,this._pdfBug=m,this.commonObjs=d.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:o=this.rotate,offsetX:d=0,offsetY:P=0,dontFlip:m=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:o,offsetX:d,offsetY:P,dontFlip:m})}getAnnotations({intent:s="display"}={}){const o=this._transport.getRenderingIntent(s);let d=this._annotationPromises.get(o.cacheKey);return d||(d=this._transport.getAnnotations(this._pageIndex,o.renderingIntent),this._annotationPromises.set(o.cacheKey,d),d=d.then(P=>{for(const m of P)m.titleObj!==void 0&&Object.defineProperty(m,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),m.titleObj.str}}),m.contentsObj!==void 0&&Object.defineProperty(m,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),m.contentsObj.str}});return P})),d}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null}render({canvasContext:s,viewport:o,intent:d="display",annotationMode:P=_util.AnnotationMode.ENABLE,transform:m=null,imageLayer:t=null,canvasFactory:e=null,background:n=null,optionalContentConfigPromise:h=null,annotationCanvasMap:b=null,pageColors:g=null,printAnnotationStorage:f=null}){var K,st;((K=arguments[0])==null?void 0:K.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&P===_util.AnnotationMode.ENABLE&&(P=_util.AnnotationMode.ENABLE_FORMS)),((st=arguments[0])==null?void 0:st.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&P===_util.AnnotationMode.ENABLE&&(P=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const E=this._transport.getRenderingIntent(d,P,f);this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let J=this._intentStates.get(E.cacheKey);J||(J=Object.create(null),this._intentStates.set(E.cacheKey,J)),J.streamReaderCancelTimeout&&(clearTimeout(J.streamReaderCancelTimeout),J.streamReaderCancelTimeout=null);const nt=e||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Z=!!(E.renderingIntent&_util.RenderingIntentFlag.PRINT);J.displayReadyCapability||(J.displayReadyCapability=(0,_util.createPromiseCapability)(),J.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(E));const Q=ht=>{J.renderTasks.delete(q),(this.cleanupAfterRender||Z)&&(this.pendingCleanup=!0),this._tryCleanup(),ht?(q.capability.reject(ht),this._abortOperatorList({intentState:J,reason:ht instanceof Error?ht:new Error(ht)})):q.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},q=new InternalRenderTask({callback:Q,params:{canvasContext:s,viewport:o,transform:m,imageLayer:t,background:n},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:b,operatorList:J.operatorList,pageIndex:this._pageIndex,canvasFactory:nt,useRequestAnimationFrame:!Z,pdfBug:this._pdfBug,pageColors:g});(J.renderTasks||(J.renderTasks=new Set)).add(q);const V=q.task;return Promise.all([J.displayReadyCapability.promise,h]).then(([ht,_t])=>{if(this.pendingCleanup){Q();return}this._stats&&this._stats.time("Rendering"),q.initializeGraphics({transparency:ht,optionalContentConfig:_t}),q.operatorListChanged()}).catch(Q),V}getOperatorList({intent:s="display",annotationMode:o=_util.AnnotationMode.ENABLE,printAnnotationStorage:d=null}={}){function P(){t.operatorList.lastChunk&&(t.opListReadCapability.resolve(t.operatorList),t.renderTasks.delete(e))}const m=this._transport.getRenderingIntent(s,o,d,!0);let t=this._intentStates.get(m.cacheKey);t||(t=Object.create(null),this._intentStates.set(m.cacheKey,t));let e;return t.opListReadCapability||(e=Object.create(null),e.operatorListChanged=P,t.opListReadCapability=(0,_util.createPromiseCapability)(),(t.renderTasks||(t.renderTasks=new Set)).add(e),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(m)),t.opListReadCapability.promise}streamTextContent({disableCombineTextItems:s=!1,includeMarkedContent:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:s!==!0,includeMarkedContent:o===!0},{highWaterMark:100,size(P){return P.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(d=>_xfa_text.XfaText.textContent(d));const o=this.streamTextContent(s);return new Promise(function(d,P){function m(){t.read().then(function({value:n,done:h}){if(h){d(e);return}Object.assign(e.styles,n.styles),e.items.push(...n.items),m()},P)}const t=o.getReader(),e={items:[],styles:Object.create(null)};m()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const s=[];for(const o of this._intentStates.values())if(this._abortOperatorList({intentState:o,reason:new Error("Page was destroyed."),force:!0}),!o.opListReadCapability)for(const d of o.renderTasks)s.push(d.completed),d.cancel();this.objs.clear();for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(s)}cleanup(s=!1){return this.pendingCleanup=!0,this._tryCleanup(s)}_tryCleanup(s=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:o,operatorList:d}of this._intentStates.values())if(o.size>0||!d.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,s&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(s,o){const d=this._intentStates.get(o);d&&(this._stats&&this._stats.timeEnd("Page Request"),d.displayReadyCapability&&d.displayReadyCapability.resolve(s))}_renderPageChunk(s,o){for(let d=0,P=s.length;d<P;d++)o.operatorList.fnArray.push(s.fnArray[d]),o.operatorList.argsArray.push(s.argsArray[d]);o.operatorList.lastChunk=s.lastChunk,o.operatorList.separateAnnots=s.separateAnnots;for(const d of o.renderTasks)d.operatorListChanged();s.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:s,cacheKey:o,annotationStorageMap:d}){const m=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:o,annotationStorage:d}).getReader(),t=this._intentStates.get(o);t.streamReader=m;const e=()=>{m.read().then(({value:n,done:h})=>{if(h){t.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(n,t),e())},n=>{if(t.streamReader=null,!this._transport.destroyed){if(t.operatorList){t.operatorList.lastChunk=!0;for(const h of t.renderTasks)h.operatorListChanged();this._tryCleanup()}if(t.displayReadyCapability)t.displayReadyCapability.reject(n);else if(t.opListReadCapability)t.opListReadCapability.reject(n);else throw n}})};e()}_abortOperatorList({intentState:s,reason:o,force:d=!1}){if(s.streamReader){if(!d){if(s.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){s.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:s,reason:o,force:!0}),s.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(s.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[P,m]of this._intentStates)if(m===s){this._intentStates.delete(P);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(s,o){const d={data:structuredClone(s,o)};this._deferred.then(()=>{for(const P of this._listeners)P.call(this,d)})}addEventListener(s,o){this._listeners.push(o)}removeEventListener(s,o){const d=this._listeners.indexOf(o);this._listeners.splice(d,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const u=(A=document==null?void 0:document.currentScript)==null?void 0:A.src;u&&(PDFWorkerUtil.fallbackWorkerSrc=u.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(u,s){let o;try{if(o=new URL(u),!o.origin||o.origin==="null")return!1}catch{return!1}const d=new URL(s,o);return o.origin===d.origin},PDFWorkerUtil.createCDNWrapper=function(u){const s=`importScripts("${u}");`;return URL.createObjectURL(new Blob([s]))}}const _PDFWorker=class _PDFWorker{constructor({name:u=null,port:s=null,verbosity:o=(0,_util.getVerbosityLevel)()}={}){if(s&&O(_PDFWorker,i).has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=u,this.destroyed=!1,this.verbosity=o,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,s){O(_PDFWorker,i).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(u){this._port=u,this._messageHandler=new _message_handler.MessageHandler("main","worker",u),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:u}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,u)||(u=PDFWorkerUtil.createCDNWrapper(new URL(u,window.location).href));const s=new Worker(u),o=new _message_handler.MessageHandler("main","worker",s),d=()=>{s.removeEventListener("error",P),o.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},P=()=>{this._webWorker||d()};s.addEventListener("error",P),o.on("test",t=>{if(s.removeEventListener("error",P),this.destroyed){d();return}t?(this._messageHandler=o,this._port=s,this._webWorker=s,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),o.destroy(),s.terminate())}),o.on("ready",t=>{if(s.removeEventListener("error",P),this.destroyed){d();return}try{m()}catch{this._setupFakeWorker()}});const m=()=>{const t=new Uint8Array;o.send("test",t,[t.buffer])};m();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(u=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const o=`fake${PDFWorkerUtil.fakeWorkerId++}`,d=new _message_handler.MessageHandler(o+"_worker",o,s);u.setup(d,s);const P=new _message_handler.MessageHandler(o,o+"_worker",s);this._messageHandler=P,this._readyCapability.resolve(),P.send("configure",{verbosity:this.verbosity})}).catch(u=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${u.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),O(_PDFWorker,i).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(u){if(!(u!=null&&u.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return O(this,i).has(u.port)?O(this,i).get(u.port):new _PDFWorker(u)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var u;try{return((u=globalThis.pdfjsWorker)==null?void 0:u.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};i=new WeakMap,ot(_PDFWorker,i,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(s,o,d,P){ot(this,l,null);ot(this,M,new Map);ot(this,D,new Map);ot(this,w,null);this.messageHandler=s,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:o.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:P.ownerDocument,styleElement:P.styleElement}),this._params=P,P.useWorkerFetch||(this.CMapReaderFactory=new P.CMapReaderFactory({baseUrl:P.cMapUrl,isCompressed:P.cMapPacked}),this.StandardFontDataFactory=new P.StandardFontDataFactory({baseUrl:P.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=d,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return O(this,l)}getRenderingIntent(s,o=_util.AnnotationMode.ENABLE,d=null,P=!1){let m=_util.RenderingIntentFlag.DISPLAY,t=null;switch(s){case"any":m=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":m=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(o){case _util.AnnotationMode.DISABLE:m+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:m+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:m+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,t=(m&_util.RenderingIntentFlag.PRINT&&d instanceof _annotation_storage.PrintAnnotationStorage?d:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${o}`)}return P&&(m+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:m,cacheKey:`${m}_${_annotation_storage.AnnotationStorage.getHash(t)}`,annotationStorageMap:t}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const d of O(this,M).values())s.push(d._destroy());O(this,M).clear(),O(this,D).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const o=this.messageHandler.sendWithPromise("Terminate",null);return s.push(o),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),yt(this,w,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:o}=this;s.on("GetReader",(d,P)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=m=>{this._lastProgress={loaded:m.loaded,total:m.total}},P.onPull=()=>{this._fullReader.read().then(function({value:m,done:t}){if(t){P.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(m),"GetReader - expected an ArrayBuffer."),P.enqueue(new Uint8Array(m),1,[m])}).catch(m=>{P.error(m)})},P.onCancel=m=>{this._fullReader.cancel(m),P.ready.catch(t=>{if(!this.destroyed)throw t})}}),s.on("ReaderHeadersReady",d=>{const P=(0,_util.createPromiseCapability)(),m=this._fullReader;return m.headersReady.then(()=>{var t;(!m.isStreamingSupported||!m.isRangeSupported)&&(this._lastProgress&&((t=o.onProgress)==null||t.call(o,this._lastProgress)),m.onProgress=e=>{var n;(n=o.onProgress)==null||n.call(o,{loaded:e.loaded,total:e.total})}),P.resolve({isStreamingSupported:m.isStreamingSupported,isRangeSupported:m.isRangeSupported,contentLength:m.contentLength})},P.reject),P.promise}),s.on("GetRangeReader",(d,P)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const m=this._networkStream.getRangeReader(d.begin,d.end);if(!m){P.close();return}P.onPull=()=>{m.read().then(function({value:t,done:e}){if(e){P.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(t),"GetRangeReader - expected an ArrayBuffer."),P.enqueue(new Uint8Array(t),1,[t])}).catch(t=>{P.error(t)})},P.onCancel=t=>{m.cancel(t),P.ready.catch(e=>{if(!this.destroyed)throw e})}}),s.on("GetDoc",({pdfInfo:d})=>{this._numPages=d.numPages,this._htmlForXfa=d.htmlForXfa,delete d.htmlForXfa,o._capability.resolve(new PDFDocumentProxy(d,this))}),s.on("DocException",function(d){let P;switch(d.name){case"PasswordException":P=new _util.PasswordException(d.message,d.code);break;case"InvalidPDFException":P=new _util.InvalidPDFException(d.message);break;case"MissingPDFException":P=new _util.MissingPDFException(d.message);break;case"UnexpectedResponseException":P=new _util.UnexpectedResponseException(d.message,d.status);break;case"UnknownErrorException":P=new _util.UnknownErrorException(d.message,d.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}o._capability.reject(P)}),s.on("PasswordRequest",d=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),o.onPassword){const P=m=>{m instanceof Error?this._passwordCapability.reject(m):this._passwordCapability.resolve({password:m})};try{o.onPassword(P,d.code)}catch(m){this._passwordCapability.reject(m)}}else this._passwordCapability.reject(new _util.PasswordException(d.message,d.code));return this._passwordCapability.promise}),s.on("DataLoaded",d=>{var P;(P=o.onProgress)==null||P.call(o,{loaded:d.length,total:d.length}),this.downloadInfoCapability.resolve(d)}),s.on("StartRenderPage",d=>{if(this.destroyed)return;O(this,M).get(d.pageIndex)._startRenderPage(d.transparency,d.cacheKey)}),s.on("commonobj",([d,P,m])=>{var t;if(!this.destroyed&&!this.commonObjs.has(d))switch(P){case"Font":const e=this._params;if("error"in m){const b=m.error;(0,_util.warn)(`Error during font loading: ${b}`),this.commonObjs.resolve(d,b);break}let n=null;e.pdfBug&&((t=globalThis.FontInspector)!=null&&t.enabled)&&(n={registerFont(b,g){globalThis.FontInspector.fontAdded(b,g)}});const h=new _font_loader.FontFaceObject(m,{isEvalSupported:e.isEvalSupported,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:n});this.fontLoader.bind(h).catch(b=>s.sendWithPromise("FontFallback",{id:d})).finally(()=>{!e.fontExtraProperties&&h.data&&(h.data=null),this.commonObjs.resolve(d,h)});break;case"FontPath":case"Image":this.commonObjs.resolve(d,m);break;default:throw new Error(`Got unknown common object type ${P}`)}}),s.on("obj",([d,P,m,t])=>{var n;if(this.destroyed)return;const e=O(this,M).get(P);if(!e.objs.has(d))switch(m){case"Image":e.objs.resolve(d,t);const h=8e6;if(t){let b;if(t.bitmap){const{bitmap:g,width:f,height:E}=t;b=f*E*4,e._bitmaps.add(g)}else b=((n=t.data)==null?void 0:n.length)||0;b>h&&(e.cleanupAfterRender=!0)}break;case"Pattern":e.objs.resolve(d,t);break;default:throw new Error(`Got unknown object type ${m}`)}}),s.on("DocProgress",d=>{var P;this.destroyed||(P=o.onProgress)==null||P.call(o,{loaded:d.loaded,total:d.total})}),s.on("DocStats",d=>{this.destroyed||yt(this,l,Object.freeze({streamTypes:Object.freeze(d.streamTypes),fontTypes:Object.freeze(d.fontTypes)}))}),s.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),s.on("FetchBuiltInCMap",d=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(d):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",d=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(d):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:s}){var o,d;this.destroyed||(d=(o=this.loadingTask).onUnsupportedFeature)==null||d.call(o,s)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const o=s-1,d=O(this,D).get(o);if(d)return d;const P=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(m=>{if(this.destroyed)throw new Error("Transport destroyed");const t=new PDFPageProxy(o,m,this,this._params.ownerDocument,this._params.pdfBug);return O(this,M).set(o,t),t});return O(this,D).set(o,P),P}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:o})}saveDocument(){var s;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return O(this,w)||yt(this,w,this.messageHandler.sendWithPromise("GetMetadata",null).then(s=>{var o,d;return{info:s[0],metadata:s[1]?new _metadata.Metadata(s[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((d=this._fullReader)==null?void 0:d.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const o of O(this,M).values())if(!o.cleanup())throw new Error(`startCleanup: Page ${o.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),yt(this,w,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const s=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s.disableAutoFetch,enableXfa:s.enableXfa})}}l=new WeakMap,M=new WeakMap,D=new WeakMap,w=new WeakMap;class PDFObjects{constructor(){ot(this,y);ot(this,S,Object.create(null))}get(s,o=null){if(o){const P=dt(this,y,le).call(this,s);return P.capability.promise.then(()=>o(P.data)),null}const d=O(this,S)[s];if(!(d!=null&&d.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return d.data}has(s){const o=O(this,S)[s];return(o==null?void 0:o.capability.settled)||!1}resolve(s,o=null){const d=dt(this,y,le).call(this,s);d.data=o,d.capability.resolve()}clear(){yt(this,S,Object.create(null))}}S=new WeakMap,y=new WeakSet,le=function(s){const o=O(this,S)[s];return o||(O(this,S)[s]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(s){ot(this,L,null);yt(this,L,s),this.onContinue=null}get promise(){return O(this,L).capability.promise}cancel(){O(this,L).cancel()}get separateAnnots(){const{separateAnnots:s}=O(this,L).operatorList;if(!s)return!1;const{annotationCanvasMap:o}=O(this,L);return s.form||s.canvas&&(o==null?void 0:o.size)>0}}L=new WeakMap,exports.RenderTask=RenderTask;const T=class T{constructor({callback:s,params:o,objs:d,commonObjs:P,annotationCanvasMap:m,operatorList:t,pageIndex:e,canvasFactory:n,useRequestAnimationFrame:h=!1,pdfBug:b=!1,pageColors:g=null}){this.callback=s,this.params=o,this.objs=d,this.commonObjs=P,this.annotationCanvasMap=m,this.operatorListIdx=null,this.operatorList=t,this._pageIndex=e,this.canvasFactory=n,this._pdfBug=b,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:o}){var n;if(this.cancelled)return;if(this._canvas){if(O(T,R).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");O(T,R).add(this._canvas)}this._pdfBug&&((n=globalThis.StepperManager)!=null&&n.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:d,viewport:P,transform:m,imageLayer:t,background:e}=this.params;this.gfx=new _canvas.CanvasGraphics(d,this.commonObjs,this.objs,this.canvasFactory,t,o,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:m,viewport:P,transparency:s,background:e}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(s=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&O(T,R).delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&O(T,R).delete(this._canvas),this.callback())))}};R=new WeakMap,ot(T,R,new WeakSet);let InternalRenderTask=T;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(k,a,A)=>{var S,we,C;Object.defineProperty(a,"__esModule",{value:!0}),a.PrintAnnotationStorage=a.AnnotationStorage=void 0;var i=A(1),l=A(6),M=A(10);class D{constructor(){ot(this,S);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(R,T){const u=this._storage.get(R);return u===void 0?T:Object.assign(T,u)}getRawValue(R){return this._storage.get(R)}remove(R){if(this._storage.delete(R),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const T of this._storage.values())if(T instanceof l.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(R,T){const u=this._storage.get(R);let s=!1;if(u!==void 0)for(const[o,d]of Object.entries(T))u[o]!==d&&(s=!0,u[o]=d);else s=!0,this._storage.set(R,T);s&&dt(this,S,we).call(this),T instanceof l.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(T.constructor._type)}has(R){return this._storage.has(R)}getAll(){return this._storage.size>0?(0,i.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new w(this)}get serializable(){if(this._storage.size===0)return null;const R=new Map;for(const[T,u]of this._storage){const s=u instanceof l.AnnotationEditor?u.serialize():u;s&&R.set(T,s)}return R}static getHash(R){if(!R)return"";const T=new M.MurmurHash3_64;for(const[u,s]of R)T.update(`${u}:${JSON.stringify(s)}`);return T.hexdigest()}}S=new WeakSet,we=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},a.AnnotationStorage=D;class w extends D{constructor(T){super();ot(this,C,null);yt(this,C,structuredClone(T.serializable))}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return O(this,C)}}C=new WeakMap,a.PrintAnnotationStorage=w},(k,a,A)=>{var D,w,S,y,C,L;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditor=void 0;var i=A(7),l=A(1);const R=class R{constructor(u){ot(this,D,this.focusin.bind(this));ot(this,w,this.focusout.bind(this));ot(this,S,!1);ot(this,y,!1);ot(this,C,!1);ot(this,L,R._zIndex++);this.constructor===R&&(0,l.unreachable)("Cannot initialize AnnotationEditor."),this.parent=u.parent,this.id=u.id,this.width=this.height=null,this.pageIndex=u.parent.pageIndex,this.name=u.name,this.div=null;const[s,o]=this.parent.viewportBaseDimensions;this.x=u.x/s,this.y=u.y/o,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,l.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=O(this,L)}focusin(u){O(this,S)?yt(this,S,!1):this.parent.setSelected(this)}focusout(u){if(!this.isAttachedToDOM)return;const s=u.relatedTarget;s!=null&&s.closest(`#${this.id}`)||(u.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(u){const s=this.parent.div.getBoundingClientRect();this.startX=u.clientX-s.x,this.startY=u.clientY-s.y,u.dataTransfer.setData("text/plain",this.id),u.dataTransfer.effectAllowed="move"}setAt(u,s,o,d){const[P,m]=this.parent.viewportBaseDimensions;[o,d]=this.screenToPageTranslation(o,d),this.x=(u+o)/P,this.y=(s+d)/m,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(u,s){const[o,d]=this.parent.viewportBaseDimensions;[u,s]=this.screenToPageTranslation(u,s),this.x+=u/o,this.y+=s/d,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(u,s){const{rotation:o}=this.parent.viewport;switch(o){case 90:return[s,-u];case 180:return[-u,-s];case 270:return[-s,u];default:return[u,s]}}setDims(u,s){const[o,d]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*u/o}%`,this.div.style.height=`${100*s/d}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",O(this,D)),this.div.addEventListener("focusout",O(this,w));const[u,s]=this.getInitialTranslation();return this.translate(u,s),(0,i.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(u){const s=i.KeyboardManager.platform.isMac;if(u.button!==0||u.ctrlKey&&s){u.preventDefault();return}u.ctrlKey&&!s||u.shiftKey||u.metaKey&&s?this.parent.toggleSelected(this):this.parent.setSelected(this),yt(this,S,!0)}getRect(u,s){const[o,d]=this.parent.viewportBaseDimensions,[P,m]=this.parent.pageDimensions,t=P*u/o,e=m*s/d,n=this.x*P,h=this.y*m,b=this.width*P,g=this.height*m;switch(this.rotation){case 0:return[n+t,m-h-e-g,n+t+b,m-h-e];case 90:return[n+e,m-h+t,n+e+g,m-h+t+b];case 180:return[n-t-b,m-h+e,n-t,m-h+e+g];case 270:return[n-e-g,m-h-t-b,n-e,m-h-t];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(u,s){const[o,d,P,m]=u,t=P-o,e=m-d;switch(this.rotation){case 0:return[o,s-m,t,e];case 90:return[o,s-d,e,t];case 180:return[P,s-d,t,e];case 270:return[P,s-m,e,t];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){yt(this,C,!0)}disableEditMode(){yt(this,C,!1)}isInEditMode(){return O(this,C)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var u;(u=this.div)==null||u.addEventListener("focusin",O(this,D))}serialize(){(0,l.unreachable)("An editor must be serializable")}static deserialize(u,s){const o=new this.prototype.constructor({parent:s,id:s.getNextId()});o.rotation=u.rotation;const[d,P]=s.pageDimensions,[m,t,e,n]=o.getRectInCurrentCoords(u.rect,P);return o.x=m/d,o.y=t/P,o.width=e/d,o.height=n/P,o}remove(){this.div.removeEventListener("focusin",O(this,D)),this.div.removeEventListener("focusout",O(this,w)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var u;(u=this.div)==null||u.classList.add("selectedEditor")}unselect(){var u;(u=this.div)==null||u.classList.remove("selectedEditor")}updateParams(u,s){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return O(this,y)}set isEditing(u){yt(this,y,u),u?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};D=new WeakMap,w=new WeakMap,S=new WeakMap,y=new WeakMap,C=new WeakMap,L=new WeakMap,It(R,"_colorManager",new i.ColorManager),It(R,"_zIndex",1);let M=R;a.AnnotationEditor=M},(k,a,A)=>{var T,u,s,o,d,P,Ee,e,h,b,g,f,E,J,nt,Z,Q,q,V,K,st,ht,_t,H,_,p,Te,B,ce,W,Wt,Y,Qt,v,Ce,F,Re,G,he,ut,Zt,lt,ee;Object.defineProperty(a,"__esModule",{value:!0}),a.KeyboardManager=a.CommandManager=a.ColorManager=a.AnnotationEditorUIManager=void 0,a.bindEvents=M,a.opacityToHex=D;var i=A(1),l=A(8);function M(ft,j,pt){for(const vt of pt)j.addEventListener(vt,ft[vt].bind(ft))}function D(ft){return Math.round(Math.min(255,Math.max(1,255*ft))).toString(16).padStart(2,"0")}class w{constructor(){ot(this,T,0)}getId(){return`${i.AnnotationEditorPrefix}${oe(this,T)._++}`}}T=new WeakMap;class S{constructor(j=128){ot(this,u,[]);ot(this,s,!1);ot(this,o,void 0);ot(this,d,-1);yt(this,o,j)}add({cmd:j,undo:pt,mustExec:vt,type:St=NaN,overwriteIfSameType:xt=!1,keepUndo:Tt=!1}){if(vt&&j(),O(this,s))return;const Mt={cmd:j,undo:pt,type:St};if(O(this,d)===-1){O(this,u).length>0&&(O(this,u).length=0),yt(this,d,0),O(this,u).push(Mt);return}if(xt&&O(this,u)[O(this,d)].type===St){Tt&&(Mt.undo=O(this,u)[O(this,d)].undo),O(this,u)[O(this,d)]=Mt;return}const Ft=O(this,d)+1;Ft===O(this,o)?O(this,u).splice(0,1):(yt(this,d,Ft),Ft<O(this,u).length&&O(this,u).splice(Ft)),O(this,u).push(Mt)}undo(){O(this,d)!==-1&&(yt(this,s,!0),O(this,u)[O(this,d)].undo(),yt(this,s,!1),yt(this,d,O(this,d)-1))}redo(){O(this,d)<O(this,u).length-1&&(yt(this,d,O(this,d)+1),yt(this,s,!0),O(this,u)[O(this,d)].cmd(),yt(this,s,!1))}hasSomethingToUndo(){return O(this,d)!==-1}hasSomethingToRedo(){return O(this,d)<O(this,u).length-1}destroy(){yt(this,u,null)}}u=new WeakMap,s=new WeakMap,o=new WeakMap,d=new WeakMap,a.CommandManager=S;const t=class t{constructor(j){ot(this,P);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const pt=t.platform.isMac;for(const[vt,St]of j)for(const xt of vt){const Tt=xt.startsWith("mac+");pt&&Tt?(this.callbacks.set(xt.slice(4),St),this.allKeys.add(xt.split("+").at(-1))):!pt&&!Tt&&(this.callbacks.set(xt,St),this.allKeys.add(xt.split("+").at(-1)))}}static get platform(){const j=typeof navigator<"u"?navigator.platform:"";return(0,i.shadow)(this,"platform",{isWin:j.includes("Win"),isMac:j.includes("Mac")})}exec(j,pt){if(!this.allKeys.has(pt.key))return;const vt=this.callbacks.get(dt(this,P,Ee).call(this,pt));vt&&(vt.bind(j)(),pt.stopPropagation(),pt.preventDefault())}};P=new WeakSet,Ee=function(j){j.altKey&&this.buffer.push("alt"),j.ctrlKey&&this.buffer.push("ctrl"),j.metaKey&&this.buffer.push("meta"),j.shiftKey&&this.buffer.push("shift"),this.buffer.push(j.key);const pt=this.buffer.join("+");return this.buffer.length=0,pt};let y=t;a.KeyboardManager=y;class C{constructor(){ot(this,e,null)}copy(j){j&&(Array.isArray(j)?yt(this,e,j.map(pt=>pt.serialize())):yt(this,e,[j.serialize()]),yt(this,e,O(this,e).filter(pt=>!!pt)),O(this,e).length===0&&yt(this,e,null))}paste(){return O(this,e)}isEmpty(){return O(this,e)===null}destroy(){yt(this,e,null)}}e=new WeakMap;const n=class n{get _colors(){const j=new Map([["CanvasText",null],["Canvas",null]]);return(0,l.getColorValues)(j),(0,i.shadow)(this,"_colors",j)}convert(j){const pt=(0,l.getRGB)(j);if(!window.matchMedia("(forced-colors: active)").matches)return pt;for(const[vt,St]of this._colors)if(St.every((xt,Tt)=>xt===pt[Tt]))return n._colorsMapping.get(vt);return pt}getHexCode(j){const pt=this._colors.get(j);return pt?i.Util.makeHexColor(...pt):j}};It(n,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=n;a.ColorManager=L;const ct=class ct{constructor(j,pt){ot(this,p);ot(this,B);ot(this,W);ot(this,Y);ot(this,v);ot(this,F);ot(this,G);ot(this,ut);ot(this,lt);ot(this,h,null);ot(this,b,new Map);ot(this,g,new Map);ot(this,f,new C);ot(this,E,new S);ot(this,J,0);ot(this,nt,null);ot(this,Z,null);ot(this,Q,new w);ot(this,q,!1);ot(this,V,i.AnnotationEditorType.NONE);ot(this,K,new Set);ot(this,st,this.keydown.bind(this));ot(this,ht,this.onEditingAction.bind(this));ot(this,_t,this.onPageChanging.bind(this));ot(this,H,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ot(this,_,null);yt(this,_,j),yt(this,Z,pt),O(this,Z)._on("editingaction",O(this,ht)),O(this,Z)._on("pagechanging",O(this,_t))}destroy(){dt(this,B,ce).call(this),O(this,Z)._off("editingaction",O(this,ht)),O(this,Z)._off("pagechanging",O(this,_t));for(const j of O(this,g).values())j.destroy();O(this,g).clear(),O(this,b).clear(),yt(this,h,null),O(this,K).clear(),O(this,f).destroy(),O(this,E).destroy()}onPageChanging({pageNumber:j}){yt(this,J,j-1)}focusMainContainer(){O(this,_).focus()}keydown(j){var pt;(pt=this.getActive())!=null&&pt.shouldGetKeyboardEvents()||ct._keyboardManager.exec(this,j)}onEditingAction(j){["undo","redo","cut","copy","paste","delete","selectAll"].includes(j.name)&&this[j.name]()}setEditingState(j){j?(dt(this,p,Te).call(this),dt(this,W,Wt).call(this,{isEditing:O(this,V)!==i.AnnotationEditorType.NONE,isEmpty:dt(this,ut,Zt).call(this),hasSomethingToUndo:O(this,E).hasSomethingToUndo(),hasSomethingToRedo:O(this,E).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:O(this,f).isEmpty()})):(dt(this,B,ce).call(this),dt(this,W,Wt).call(this,{isEditing:!1}))}registerEditorTypes(j){yt(this,nt,j);for(const pt of O(this,nt))dt(this,Y,Qt).call(this,pt.defaultPropertiesToUpdate)}getId(){return O(this,Q).getId()}addLayer(j){O(this,g).set(j.pageIndex,j),O(this,q)?j.enable():j.disable()}removeLayer(j){O(this,g).delete(j.pageIndex)}updateMode(j){if(yt(this,V,j),j===i.AnnotationEditorType.NONE)this.setEditingState(!1),dt(this,F,Re).call(this);else{this.setEditingState(!0),dt(this,v,Ce).call(this);for(const pt of O(this,g).values())pt.updateMode(j)}}updateToolbar(j){j!==O(this,V)&&O(this,Z).dispatch("switchannotationeditormode",{source:this,mode:j})}updateParams(j,pt){for(const vt of O(this,K))vt.updateParams(j,pt);for(const vt of O(this,nt))vt.updateDefaultParams(j,pt)}getEditors(j){const pt=[];for(const vt of O(this,b).values())vt.pageIndex===j&&pt.push(vt);return pt}getEditor(j){return O(this,b).get(j)}addEditor(j){O(this,b).set(j.id,j)}removeEditor(j){O(this,b).delete(j.id),this.unselect(j)}setActiveEditor(j){O(this,h)!==j&&(yt(this,h,j),j&&dt(this,Y,Qt).call(this,j.propertiesToUpdate))}toggleSelected(j){if(O(this,K).has(j)){O(this,K).delete(j),j.unselect(),dt(this,W,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}O(this,K).add(j),j.select(),dt(this,Y,Qt).call(this,j.propertiesToUpdate),dt(this,W,Wt).call(this,{hasSelectedEditor:!0})}setSelected(j){for(const pt of O(this,K))pt!==j&&pt.unselect();O(this,K).clear(),O(this,K).add(j),j.select(),dt(this,Y,Qt).call(this,j.propertiesToUpdate),dt(this,W,Wt).call(this,{hasSelectedEditor:!0})}isSelected(j){return O(this,K).has(j)}unselect(j){j.unselect(),O(this,K).delete(j),dt(this,W,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return O(this,K).size!==0}undo(){O(this,E).undo(),dt(this,W,Wt).call(this,{hasSomethingToUndo:O(this,E).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:dt(this,ut,Zt).call(this)})}redo(){O(this,E).redo(),dt(this,W,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:O(this,E).hasSomethingToRedo(),isEmpty:dt(this,ut,Zt).call(this)})}addCommands(j){O(this,E).add(j),dt(this,W,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:dt(this,ut,Zt).call(this)})}delete(){if(O(this,h)&&O(this,h).commitOrRemove(),!this.hasSelection)return;const j=[...O(this,K)],pt=()=>{for(const St of j)St.remove()},vt=()=>{for(const St of j)dt(this,G,he).call(this,St)};this.addCommands({cmd:pt,undo:vt,mustExec:!0})}copy(){if(O(this,h)&&O(this,h).commitOrRemove(),this.hasSelection){const j=[];for(const pt of O(this,K))pt.isEmpty()||j.push(pt);if(j.length===0)return;O(this,f).copy(j),dt(this,W,Wt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(O(this,f).isEmpty())return;this.unselectAll();const j=O(this,g).get(O(this,J)),pt=O(this,f).paste().map(xt=>j.deserialize(xt)),vt=()=>{for(const xt of pt)dt(this,G,he).call(this,xt);dt(this,lt,ee).call(this,pt)},St=()=>{for(const xt of pt)xt.remove()};this.addCommands({cmd:vt,undo:St,mustExec:!0})}selectAll(){for(const j of O(this,K))j.commit();dt(this,lt,ee).call(this,O(this,b).values())}unselectAll(){if(O(this,h)){O(this,h).commitOrRemove();return}if(dt(this,lt,ee).size!==0){for(const j of O(this,K))j.unselect();O(this,K).clear(),dt(this,W,Wt).call(this,{hasSelectedEditor:!1})}}isActive(j){return O(this,h)===j}getActive(){return O(this,h)}getMode(){return O(this,V)}};h=new WeakMap,b=new WeakMap,g=new WeakMap,f=new WeakMap,E=new WeakMap,J=new WeakMap,nt=new WeakMap,Z=new WeakMap,Q=new WeakMap,q=new WeakMap,V=new WeakMap,K=new WeakMap,st=new WeakMap,ht=new WeakMap,_t=new WeakMap,H=new WeakMap,_=new WeakMap,p=new WeakSet,Te=function(){O(this,_).addEventListener("keydown",O(this,st))},B=new WeakSet,ce=function(){O(this,_).removeEventListener("keydown",O(this,st))},W=new WeakSet,Wt=function(j){Object.entries(j).some(([vt,St])=>O(this,H)[vt]!==St)&&O(this,Z).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(O(this,H),j)})},Y=new WeakSet,Qt=function(j){O(this,Z).dispatch("annotationeditorparamschanged",{source:this,details:j})},v=new WeakSet,Ce=function(){if(!O(this,q)){yt(this,q,!0);for(const j of O(this,g).values())j.enable()}},F=new WeakSet,Re=function(){if(this.unselectAll(),O(this,q)){yt(this,q,!1);for(const j of O(this,g).values())j.disable()}},G=new WeakSet,he=function(j){const pt=O(this,g).get(j.pageIndex);pt?pt.addOrRebuild(j):this.addEditor(j)},ut=new WeakSet,Zt=function(){if(O(this,b).size===0)return!0;if(O(this,b).size===1)for(const j of O(this,b).values())return j.isEmpty();return!1},lt=new WeakSet,ee=function(j){O(this,K).clear();for(const pt of j)pt.isEmpty()||(O(this,K).add(pt),pt.select());dt(this,W,Wt).call(this,{hasSelectedEditor:!0})},It(ct,"_keyboardManager",new y([[["ctrl+a","mac+meta+a"],ct.prototype.selectAll],[["ctrl+c","mac+meta+c"],ct.prototype.copy],[["ctrl+v","mac+meta+v"],ct.prototype.paste],[["ctrl+x","mac+meta+x"],ct.prototype.cut],[["ctrl+z","mac+meta+z"],ct.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ct.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ct.prototype.delete],[["Escape","mac+Escape"],ct.prototype.unselectAll]]));let R=ct;a.AnnotationEditorUIManager=R},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.StatTimer=a.RenderingCancelledException=a.PixelsPerInch=a.PageViewport=a.PDFDateString=a.DOMStandardFontDataFactory=a.DOMSVGFactory=a.DOMCanvasFactory=a.DOMCMapReaderFactory=a.AnnotationPrefix=void 0,a.deprecated=n,a.getColorValues=E,a.getCurrentTransform=J,a.getCurrentTransformInverse=nt,a.getFilenameFromUrl=d,a.getPdfFilenameFromUrl=P,a.getRGB=f,a.getXfaPageViewport=g,a.isDataScheme=s,a.isPdfFile=o,a.isValidFetchUrl=t,a.loadScript=e;var i=A(9),l=A(1);const M="http://www.w3.org/2000/svg",D="pdfjs_internal_id_";a.AnnotationPrefix=D;const Z=class Z{};It(Z,"CSS",96),It(Z,"PDF",72),It(Z,"PDF_TO_CSS_UNITS",Z.CSS/Z.PDF);let w=Z;a.PixelsPerInch=w;class S extends i.BaseCanvasFactory{constructor({ownerDocument:q=globalThis.document}={}){super(),this._document=q}_createCanvas(q,V){const K=this._document.createElement("canvas");return K.width=q,K.height=V,K}}a.DOMCanvasFactory=S;async function y(Q,q=!1){if(t(Q,document.baseURI)){const V=await fetch(Q);if(!V.ok)throw new Error(V.statusText);return q?new Uint8Array(await V.arrayBuffer()):(0,l.stringToBytes)(await V.text())}return new Promise((V,K)=>{const st=new XMLHttpRequest;st.open("GET",Q,!0),q&&(st.responseType="arraybuffer"),st.onreadystatechange=()=>{if(st.readyState===XMLHttpRequest.DONE){if(st.status===200||st.status===0){let ht;if(q&&st.response?ht=new Uint8Array(st.response):!q&&st.responseText&&(ht=(0,l.stringToBytes)(st.responseText)),ht){V(ht);return}}K(new Error(st.statusText))}},st.send(null)})}class C extends i.BaseCMapReaderFactory{_fetchData(q,V){return y(q,this.isCompressed).then(K=>({cMapData:K,compressionType:V}))}}a.DOMCMapReaderFactory=C;class L extends i.BaseStandardFontDataFactory{_fetchData(q){return y(q,!0)}}a.DOMStandardFontDataFactory=L;class R extends i.BaseSVGFactory{_createSVG(q){return document.createElementNS(M,q)}}a.DOMSVGFactory=R;class T{constructor({viewBox:q,scale:V,rotation:K,offsetX:st=0,offsetY:ht=0,dontFlip:_t=!1}){this.viewBox=q,this.scale=V,this.rotation=K,this.offsetX=st,this.offsetY=ht;const H=(q[2]+q[0])/2,_=(q[3]+q[1])/2;let p,I,B,U;switch(K%=360,K<0&&(K+=360),K){case 180:p=-1,I=0,B=0,U=1;break;case 90:p=0,I=1,B=1,U=0;break;case 270:p=0,I=-1,B=-1,U=0;break;case 0:p=1,I=0,B=0,U=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}_t&&(B=-B,U=-U);let W,X,Y,c;p===0?(W=Math.abs(_-q[1])*V+st,X=Math.abs(H-q[0])*V+ht,Y=Math.abs(q[3]-q[1])*V,c=Math.abs(q[2]-q[0])*V):(W=Math.abs(H-q[0])*V+st,X=Math.abs(_-q[1])*V+ht,Y=Math.abs(q[2]-q[0])*V,c=Math.abs(q[3]-q[1])*V),this.transform=[p*V,I*V,B*V,U*V,W-p*V*H-B*V*_,X-I*V*H-U*V*_],this.width=Y,this.height=c}clone({scale:q=this.scale,rotation:V=this.rotation,offsetX:K=this.offsetX,offsetY:st=this.offsetY,dontFlip:ht=!1}={}){return new T({viewBox:this.viewBox.slice(),scale:q,rotation:V,offsetX:K,offsetY:st,dontFlip:ht})}convertToViewportPoint(q,V){return l.Util.applyTransform([q,V],this.transform)}convertToViewportRectangle(q){const V=l.Util.applyTransform([q[0],q[1]],this.transform),K=l.Util.applyTransform([q[2],q[3]],this.transform);return[V[0],V[1],K[0],K[1]]}convertToPdfPoint(q,V){return l.Util.applyInverseTransform([q,V],this.transform)}}a.PageViewport=T;class u extends l.BaseException{constructor(q,V){super(q,"RenderingCancelledException"),this.type=V}}a.RenderingCancelledException=u;function s(Q){const q=Q.length;let V=0;for(;V<q&&Q[V].trim()==="";)V++;return Q.substring(V,V+5).toLowerCase()==="data:"}function o(Q){return typeof Q=="string"&&/\.pdf$/i.test(Q)}function d(Q){const q=Q.indexOf("#"),V=Q.indexOf("?"),K=Math.min(q>0?q:Q.length,V>0?V:Q.length);return Q.substring(Q.lastIndexOf("/",K)+1,K)}function P(Q,q="document.pdf"){if(typeof Q!="string")return q;if(s(Q))return(0,l.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),q;const V=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,K=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,st=V.exec(Q);let ht=K.exec(st[1])||K.exec(st[2])||K.exec(st[3]);if(ht&&(ht=ht[0],ht.includes("%")))try{ht=K.exec(decodeURIComponent(ht))[0]}catch{}return ht||q}class m{constructor(){this.started=Object.create(null),this.times=[]}time(q){q in this.started&&(0,l.warn)(`Timer is already running for ${q}`),this.started[q]=Date.now()}timeEnd(q){q in this.started||(0,l.warn)(`Timer has not been started for ${q}`),this.times.push({name:q,start:this.started[q],end:Date.now()}),delete this.started[q]}toString(){const q=[];let V=0;for(const K of this.times){const st=K.name;st.length>V&&(V=st.length)}for(const K of this.times){const st=K.end-K.start;q.push(`${K.name.padEnd(V)} ${st}ms
`)}return q.join("")}}a.StatTimer=m;function t(Q,q){try{const{protocol:V}=q?new URL(Q,q):new URL(Q);return V==="http:"||V==="https:"}catch{return!1}}function e(Q,q=!1){return new Promise((V,K)=>{const st=document.createElement("script");st.src=Q,st.onload=function(ht){q&&st.remove(),V(ht)},st.onerror=function(){K(new Error(`Cannot load script at: ${st.src}`))},(document.head||document.documentElement).append(st)})}function n(Q){console.log("Deprecated API usage: "+Q)}let h;class b{static toDateObject(q){if(!q||typeof q!="string")return null;h||(h=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const V=h.exec(q);if(!V)return null;const K=parseInt(V[1],10);let st=parseInt(V[2],10);st=st>=1&&st<=12?st-1:0;let ht=parseInt(V[3],10);ht=ht>=1&&ht<=31?ht:1;let _t=parseInt(V[4],10);_t=_t>=0&&_t<=23?_t:0;let H=parseInt(V[5],10);H=H>=0&&H<=59?H:0;let _=parseInt(V[6],10);_=_>=0&&_<=59?_:0;const p=V[7]||"Z";let I=parseInt(V[8],10);I=I>=0&&I<=23?I:0;let B=parseInt(V[9],10)||0;return B=B>=0&&B<=59?B:0,p==="-"?(_t+=I,H+=B):p==="+"&&(_t-=I,H-=B),new Date(Date.UTC(K,st,ht,_t,H,_))}}a.PDFDateString=b;function g(Q,{scale:q=1,rotation:V=0}){const{width:K,height:st}=Q.attributes.style,ht=[0,0,parseInt(K),parseInt(st)];return new T({viewBox:ht,scale:q,rotation:V})}function f(Q){if(Q.startsWith("#")){const q=parseInt(Q.slice(1),16);return[(q&16711680)>>16,(q&65280)>>8,q&255]}return Q.startsWith("rgb(")?Q.slice(4,-1).split(",").map(q=>parseInt(q)):Q.startsWith("rgba(")?Q.slice(5,-1).split(",").map(q=>parseInt(q)).slice(0,3):((0,l.warn)(`Not a valid color format: "${Q}"`),[0,0,0])}function E(Q){const q=document.createElement("span");q.style.visibility="hidden",document.body.append(q);for(const V of Q.keys()){q.style.color=V;const K=window.getComputedStyle(q).color;Q.set(V,f(K))}q.remove()}function J(Q){const{a:q,b:V,c:K,d:st,e:ht,f:_t}=Q.getTransform();return[q,V,K,st,ht,_t]}function nt(Q){const{a:q,b:V,c:K,d:st,e:ht,f:_t}=Q.getTransform().invertSelf();return[q,V,K,st,ht,_t]}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BaseStandardFontDataFactory=a.BaseSVGFactory=a.BaseCanvasFactory=a.BaseCMapReaderFactory=void 0;var i=A(1);class l{constructor(){this.constructor===l&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(y,C){if(y<=0||C<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(y,C);return{canvas:L,context:L.getContext("2d")}}reset(y,C,L){if(!y.canvas)throw new Error("Canvas is not specified");if(C<=0||L<=0)throw new Error("Invalid canvas size");y.canvas.width=C,y.canvas.height=L}destroy(y){if(!y.canvas)throw new Error("Canvas is not specified");y.canvas.width=0,y.canvas.height=0,y.canvas=null,y.context=null}_createCanvas(y,C){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}a.BaseCanvasFactory=l;class M{constructor({baseUrl:y=null,isCompressed:C=!1}){this.constructor===M&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=y,this.isCompressed=C}async fetch({name:y}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!y)throw new Error("CMap name must be specified.");const C=this.baseUrl+y+(this.isCompressed?".bcmap":""),L=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(C,L).catch(R=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${C}`)})}_fetchData(y,C){(0,i.unreachable)("Abstract method `_fetchData` called.")}}a.BaseCMapReaderFactory=M;class D{constructor({baseUrl:y=null}){this.constructor===D&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=y}async fetch({filename:y}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!y)throw new Error("Font filename must be specified.");const C=`${this.baseUrl}${y}`;return this._fetchData(C).catch(L=>{throw new Error(`Unable to load font data at: ${C}`)})}_fetchData(y){(0,i.unreachable)("Abstract method `_fetchData` called.")}}a.BaseStandardFontDataFactory=D;class w{constructor(){this.constructor===w&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(y,C,L=!1){if(y<=0||C<=0)throw new Error("Invalid SVG dimensions");const R=this._createSVG("svg:svg");return R.setAttribute("version","1.1"),L||(R.setAttribute("width",`${y}px`),R.setAttribute("height",`${C}px`)),R.setAttribute("preserveAspectRatio","none"),R.setAttribute("viewBox",`0 0 ${y} ${C}`),R}createElement(y){if(typeof y!="string")throw new Error("Invalid SVG element type");return this._createSVG(y)}_createSVG(y){(0,i.unreachable)("Abstract method `_createSVG` called.")}}a.BaseSVGFactory=w},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MurmurHash3_64=void 0;var i=A(1);const l=3285377520,M=4294901760,D=65535;class w{constructor(y){this.h1=y?y&4294967295:l,this.h2=y?y&4294967295:l}update(y){let C,L;if(typeof y=="string"){C=new Uint8Array(y.length*2),L=0;for(let h=0,b=y.length;h<b;h++){const g=y.charCodeAt(h);g<=255?C[L++]=g:(C[L++]=g>>>8,C[L++]=g&255)}}else if((0,i.isArrayBuffer)(y))C=y.slice(),L=C.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const R=L>>2,T=L-R*4,u=new Uint32Array(C.buffer,0,R);let s=0,o=0,d=this.h1,P=this.h2;const m=3432918353,t=461845907,e=m&D,n=t&D;for(let h=0;h<R;h++)h&1?(s=u[h],s=s*m&M|s*e&D,s=s<<15|s>>>17,s=s*t&M|s*n&D,d^=s,d=d<<13|d>>>19,d=d*5+3864292196):(o=u[h],o=o*m&M|o*e&D,o=o<<15|o>>>17,o=o*t&M|o*n&D,P^=o,P=P<<13|P>>>19,P=P*5+3864292196);switch(s=0,T){case 3:s^=C[R*4+2]<<16;case 2:s^=C[R*4+1]<<8;case 1:s^=C[R*4],s=s*m&M|s*e&D,s=s<<15|s>>>17,s=s*t&M|s*n&D,R&1?d^=s:P^=s}this.h1=d,this.h2=P}hexdigest(){let y=this.h1,C=this.h2;y^=C>>>1,y=y*3981806797&M|y*36045&D,C=C*4283543511&M|((C<<16|y>>>16)*2950163797&M)>>>16,y^=C>>>1,y=y*444984403&M|y*60499&D,C=C*3301882366&M|((C<<16|y>>>16)*3120437893&M)>>>16,y^=C>>>1;const L=(y>>>0).toString(16),R=(C>>>0).toString(16);return L.padStart(8,"0")+R.padStart(8,"0")}}a.MurmurHash3_64=w},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FontLoader=a.FontFaceObject=void 0;var i=A(1);class l{constructor({docId:S,onUnsupportedFeature:y,ownerDocument:C=globalThis.document,styleElement:L=null}){this.constructor===l&&(0,i.unreachable)("Cannot initialize BaseFontLoader."),this.docId=S,this._onUnsupportedFeature=y,this._document=C,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(S){this.nativeFontFaces.push(S),this._document.fonts.add(S)}insertRule(S){let y=this.styleElement;y||(y=this.styleElement=this._document.createElement("style"),y.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(y));const C=y.sheet;C.insertRule(S,C.cssRules.length)}clear(){for(const S of this.nativeFontFaces)this._document.fonts.delete(S);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(S){if(S.attached||S.missingFile)return;if(S.attached=!0,this.isFontLoadingAPISupported){const C=S.createNativeFontFace();if(C){this.addNativeFontFace(C);try{await C.loaded}catch(L){throw this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,i.warn)(`Failed to load font '${C.family}': '${L}'.`),S.disableFontFace=!0,L}}return}const y=S.createFontFaceRule();if(y){if(this.insertRule(y),this.isSyncFontLoadingSupported)return;await new Promise(C=>{const L=this._queueLoadingCallback(C);this._prepareFontLoadEvent([y],[S],L)})}}_queueLoadingCallback(S){(0,i.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var y;const S=!!((y=this._document)!=null&&y.fonts);return(0,i.shadow)(this,"isFontLoadingAPISupported",S)}get isSyncFontLoadingSupported(){(0,i.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,i.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(S,y,C){(0,i.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let M;a.FontLoader=M,a.FontLoader=M=class extends l{constructor(S){super(S),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let S=!1;if(typeof navigator>"u")S=!0;else{const y=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(y==null?void 0:y[1])>=14&&(S=!0)}return(0,i.shadow)(this,"isSyncFontLoadingSupported",S)}_queueLoadingCallback(S){function y(){for((0,i.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;C.requests.length>0&&C.requests[0].done;){const R=C.requests.shift();setTimeout(R.callback,0)}}const C=this.loadingContext,L={id:`pdfjs-font-loading-${C.nextRequestId++}`,done:!1,complete:y,callback:S};return C.requests.push(L),L}get _loadTestFont(){const S=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,i.shadow)(this,"_loadTestFont",S())}_prepareFontLoadEvent(S,y,C){function L(nt,Z){return nt.charCodeAt(Z)<<24|nt.charCodeAt(Z+1)<<16|nt.charCodeAt(Z+2)<<8|nt.charCodeAt(Z+3)&255}function R(nt,Z,Q,q){const V=nt.substring(0,Z),K=nt.substring(Z+Q);return V+q+K}let T,u;const s=this._document.createElement("canvas");s.width=1,s.height=1;const o=s.getContext("2d");let d=0;function P(nt,Z){if(d++,d>30){(0,i.warn)("Load test font never loaded."),Z();return}if(o.font="30px "+nt,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0){Z();return}setTimeout(P.bind(null,nt,Z))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let t=this._loadTestFont;t=R(t,976,m.length,m);const n=16,h=1482184792;let b=L(t,n);for(T=0,u=m.length-3;T<u;T+=4)b=b-h+L(m,T)|0;T<m.length&&(b=b-h+L(m+"XXX",T)|0),t=R(t,n,4,(0,i.string32)(b));const g=`url(data:font/opentype;base64,${btoa(t)});`,f=`@font-face {font-family:"${m}";src:${g}}`;this.insertRule(f);const E=[];for(const nt of y)E.push(nt.loadedName);E.push(m);const J=this._document.createElement("div");J.style.visibility="hidden",J.style.width=J.style.height="10px",J.style.position="absolute",J.style.top=J.style.left="0px";for(const nt of E){const Z=this._document.createElement("span");Z.textContent="Hi",Z.style.fontFamily=nt,J.append(Z)}this._document.body.append(J),P(m,()=>{J.remove(),C.complete()})}};class D{constructor(S,{isEvalSupported:y=!0,disableFontFace:C=!1,ignoreErrors:L=!1,onUnsupportedFeature:R,fontRegistry:T=null}){this.compiledGlyphs=Object.create(null);for(const u in S)this[u]=S[u];this.isEvalSupported=y!==!1,this.disableFontFace=C===!0,this.ignoreErrors=L===!0,this._onUnsupportedFeature=R,this.fontRegistry=T}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let S;if(!this.cssFontInfo)S=new FontFace(this.loadedName,this.data,{});else{const y={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(y.style=`oblique ${this.cssFontInfo.italicAngle}deg`),S=new FontFace(this.cssFontInfo.fontFamily,this.data,y)}return this.fontRegistry&&this.fontRegistry.registerFont(this),S}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const S=(0,i.bytesToString)(this.data),y=`url(data:${this.mimetype};base64,${btoa(S)});`;let C;if(!this.cssFontInfo)C=`@font-face {font-family:"${this.loadedName}";src:${y}}`;else{let L=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(L+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),C=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${L}src:${y}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,y),C}getPathGenerator(S,y){if(this.compiledGlyphs[y]!==void 0)return this.compiledGlyphs[y];let C;try{C=S.get(this.loadedName+"_path_"+y)}catch(L){if(!this.ignoreErrors)throw L;return this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,i.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[y]=function(R,T){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const L=[];for(const R of C){const T=R.args!==void 0?R.args.join(","):"";L.push("c.",R.cmd,"(",T,`);
`)}return this.compiledGlyphs[y]=new Function("c","size",L.join(""))}return this.compiledGlyphs[y]=function(L,R){for(const T of C)T.cmd==="scale"&&(T.args=[R,-R]),L[T.cmd].apply(L,T.args)}}}a.FontFaceObject=D},(k,a,A)=>{var st,de;Object.defineProperty(a,"__esModule",{value:!0}),a.CanvasGraphics=void 0;var i=A(8),l=A(1),M=A(13),D=A(14),w=A(3);const S=16,y=100,C=4096,L=15,R=10,T=w.isNodeJS&&typeof Path2D>"u"?-1:1e3,u=16;function s(H,_){if(H._removeMirroring)throw new Error("Context is already forwarding operations.");H.__originalSave=H.save,H.__originalRestore=H.restore,H.__originalRotate=H.rotate,H.__originalScale=H.scale,H.__originalTranslate=H.translate,H.__originalTransform=H.transform,H.__originalSetTransform=H.setTransform,H.__originalResetTransform=H.resetTransform,H.__originalClip=H.clip,H.__originalMoveTo=H.moveTo,H.__originalLineTo=H.lineTo,H.__originalBezierCurveTo=H.bezierCurveTo,H.__originalRect=H.rect,H.__originalClosePath=H.closePath,H.__originalBeginPath=H.beginPath,H._removeMirroring=()=>{H.save=H.__originalSave,H.restore=H.__originalRestore,H.rotate=H.__originalRotate,H.scale=H.__originalScale,H.translate=H.__originalTranslate,H.transform=H.__originalTransform,H.setTransform=H.__originalSetTransform,H.resetTransform=H.__originalResetTransform,H.clip=H.__originalClip,H.moveTo=H.__originalMoveTo,H.lineTo=H.__originalLineTo,H.bezierCurveTo=H.__originalBezierCurveTo,H.rect=H.__originalRect,H.closePath=H.__originalClosePath,H.beginPath=H.__originalBeginPath,delete H._removeMirroring},H.save=function(){_.save(),this.__originalSave()},H.restore=function(){_.restore(),this.__originalRestore()},H.translate=function(I,B){_.translate(I,B),this.__originalTranslate(I,B)},H.scale=function(I,B){_.scale(I,B),this.__originalScale(I,B)},H.transform=function(I,B,U,W,X,Y){_.transform(I,B,U,W,X,Y),this.__originalTransform(I,B,U,W,X,Y)},H.setTransform=function(I,B,U,W,X,Y){_.setTransform(I,B,U,W,X,Y),this.__originalSetTransform(I,B,U,W,X,Y)},H.resetTransform=function(){_.resetTransform(),this.__originalResetTransform()},H.rotate=function(I){_.rotate(I),this.__originalRotate(I)},H.clip=function(I){_.clip(I),this.__originalClip(I)},H.moveTo=function(p,I){_.moveTo(p,I),this.__originalMoveTo(p,I)},H.lineTo=function(p,I){_.lineTo(p,I),this.__originalLineTo(p,I)},H.bezierCurveTo=function(p,I,B,U,W,X){_.bezierCurveTo(p,I,B,U,W,X),this.__originalBezierCurveTo(p,I,B,U,W,X)},H.rect=function(p,I,B,U){_.rect(p,I,B,U),this.__originalRect(p,I,B,U)},H.closePath=function(){_.closePath(),this.__originalClosePath()},H.beginPath=function(){_.beginPath(),this.__originalBeginPath()}}class o{constructor(_){this.canvasFactory=_,this.cache=Object.create(null)}getCanvas(_,p,I){let B;return this.cache[_]!==void 0?(B=this.cache[_],this.canvasFactory.reset(B,p,I)):(B=this.canvasFactory.create(p,I),this.cache[_]=B),B}delete(_){delete this.cache[_]}clear(){for(const _ in this.cache){const p=this.cache[_];this.canvasFactory.destroy(p),delete this.cache[_]}}}function d(H,_,p,I,B,U,W,X,Y,c){const[v,x,F,N,G,rt]=(0,i.getCurrentTransform)(H);if(x===0&&F===0){const lt=W*v+G,it=Math.round(lt),ct=X*N+rt,ft=Math.round(ct),j=(W+Y)*v+G,pt=Math.abs(Math.round(j)-it)||1,vt=(X+c)*N+rt,St=Math.abs(Math.round(vt)-ft)||1;return H.setTransform(Math.sign(v),0,0,Math.sign(N),it,ft),H.drawImage(_,p,I,B,U,0,0,pt,St),H.setTransform(v,x,F,N,G,rt),[pt,St]}if(v===0&&N===0){const lt=X*F+G,it=Math.round(lt),ct=W*x+rt,ft=Math.round(ct),j=(X+c)*F+G,pt=Math.abs(Math.round(j)-it)||1,vt=(W+Y)*x+rt,St=Math.abs(Math.round(vt)-ft)||1;return H.setTransform(0,Math.sign(x),Math.sign(F),0,it,ft),H.drawImage(_,p,I,B,U,0,0,St,pt),H.setTransform(v,x,F,N,G,rt),[St,pt]}H.drawImage(_,p,I,B,U,W,X,Y,c);const ut=Math.hypot(v,x),et=Math.hypot(F,N);return[ut*Y,et*c]}function P(H){const{width:_,height:p}=H;if(_>T||p>T)return null;const I=1e3,B=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),U=_+1;let W=new Uint8Array(U*(p+1)),X,Y,c;const v=_+7&-8;let x=new Uint8Array(v*p),F=0;for(const et of H.data){let lt=128;for(;lt>0;)x[F++]=et&lt?0:255,lt>>=1}let N=0;for(F=0,x[F]!==0&&(W[0]=1,++N),Y=1;Y<_;Y++)x[F]!==x[F+1]&&(W[Y]=x[F]?2:1,++N),F++;for(x[F]!==0&&(W[Y]=2,++N),X=1;X<p;X++){F=X*v,c=X*U,x[F-v]!==x[F]&&(W[c]=x[F]?1:8,++N);let et=(x[F]?4:0)+(x[F-v]?8:0);for(Y=1;Y<_;Y++)et=(et>>2)+(x[F+1]?4:0)+(x[F-v+1]?8:0),B[et]&&(W[c+Y]=B[et],++N),F++;if(x[F-v]!==x[F]&&(W[c+Y]=x[F]?2:4,++N),N>I)return null}for(F=v*(p-1),c=X*U,x[F]!==0&&(W[c]=8,++N),Y=1;Y<_;Y++)x[F]!==x[F+1]&&(W[c+Y]=x[F]?4:8,++N),F++;if(x[F]!==0&&(W[c+Y]=4,++N),N>I)return null;const G=new Int32Array([0,U,-1,0,-U,0,0,0,1]),rt=new Path2D;for(X=0;N&&X<=p;X++){let et=X*U;const lt=et+_;for(;et<lt&&!W[et];)et++;if(et===lt)continue;rt.moveTo(et%U,X);const it=et;let ct=W[et];do{const ft=G[ct];do et+=ft;while(!W[et]);const j=W[et];j!==5&&j!==10?(ct=j,W[et]=0):(ct=j&51*ct>>4,W[et]&=ct>>2|ct<<2),rt.lineTo(et%U,et/U|0),W[et]||--N}while(it!==et);--X}return x=null,W=null,function(et){et.save(),et.scale(1/_,-1/p),et.translate(0,-p),et.fill(rt),et.beginPath(),et.restore()}}class m{constructor(_,p){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=l.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=l.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=l.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,_,p])}clone(){const _=Object.create(this);return _.clipBox=this.clipBox.slice(),_}setCurrentPoint(_,p){this.x=_,this.y=p}updatePathMinMax(_,p,I){[p,I]=l.Util.applyTransform([p,I],_),this.minX=Math.min(this.minX,p),this.minY=Math.min(this.minY,I),this.maxX=Math.max(this.maxX,p),this.maxY=Math.max(this.maxY,I)}updateRectMinMax(_,p){const I=l.Util.applyTransform(p,_),B=l.Util.applyTransform(p.slice(2),_);this.minX=Math.min(this.minX,I[0],B[0]),this.minY=Math.min(this.minY,I[1],B[1]),this.maxX=Math.max(this.maxX,I[0],B[0]),this.maxY=Math.max(this.maxY,I[1],B[1])}updateScalingPathMinMax(_,p){l.Util.scaleMinMax(_,p),this.minX=Math.min(this.minX,p[0]),this.maxX=Math.max(this.maxX,p[1]),this.minY=Math.min(this.minY,p[2]),this.maxY=Math.max(this.maxY,p[3])}updateCurvePathMinMax(_,p,I,B,U,W,X,Y,c,v){const x=l.Util.bezierBoundingBox(p,I,B,U,W,X,Y,c);if(v){v[0]=Math.min(v[0],x[0],x[2]),v[1]=Math.max(v[1],x[0],x[2]),v[2]=Math.min(v[2],x[1],x[3]),v[3]=Math.max(v[3],x[1],x[3]);return}this.updateRectMinMax(_,x)}getPathBoundingBox(_=M.PathType.FILL,p=null){const I=[this.minX,this.minY,this.maxX,this.maxY];if(_===M.PathType.STROKE){p||(0,l.unreachable)("Stroke bounding box must include transform.");const B=l.Util.singularValueDecompose2dScale(p),U=B[0]*this.lineWidth/2,W=B[1]*this.lineWidth/2;I[0]-=U,I[1]-=W,I[2]+=U,I[3]+=W}return I}updateClipFromPath(){const _=l.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(_||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(_){this.clipBox=_,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(_=M.PathType.FILL,p=null){return l.Util.intersect(this.clipBox,this.getPathBoundingBox(_,p))}}function t(H,_,p=null){if(typeof ImageData<"u"&&_ instanceof ImageData){H.putImageData(_,0,0);return}const I=_.height,B=_.width,U=I%u,W=(I-U)/u,X=U===0?W:W+1,Y=H.createImageData(B,u);let c=0,v;const x=_.data,F=Y.data;let N,G,rt,ut,et,lt,it,ct;if(p)switch(p.length){case 1:et=p[0],lt=p[0],it=p[0],ct=p[0];break;case 4:et=p[0],lt=p[1],it=p[2],ct=p[3];break}if(_.kind===l.ImageKind.GRAYSCALE_1BPP){const ft=x.byteLength,j=new Uint32Array(F.buffer,0,F.byteLength>>2),pt=j.length,vt=B+7>>3;let St=4294967295,xt=l.FeatureTest.isLittleEndian?4278190080:255;for(ct&&ct[0]===255&&ct[255]===0&&([St,xt]=[xt,St]),N=0;N<X;N++){for(rt=N<W?u:U,v=0,G=0;G<rt;G++){const Tt=ft-c;let Mt=0;const Ft=Tt>vt?B:Tt*8-7,zt=Ft&-8;let wt=0,Dt=0;for(;Mt<zt;Mt+=8)Dt=x[c++],j[v++]=Dt&128?St:xt,j[v++]=Dt&64?St:xt,j[v++]=Dt&32?St:xt,j[v++]=Dt&16?St:xt,j[v++]=Dt&8?St:xt,j[v++]=Dt&4?St:xt,j[v++]=Dt&2?St:xt,j[v++]=Dt&1?St:xt;for(;Mt<Ft;Mt++)wt===0&&(Dt=x[c++],wt=128),j[v++]=Dt&wt?St:xt,wt>>=1}for(;v<pt;)j[v++]=0;H.putImageData(Y,0,N*u)}}else if(_.kind===l.ImageKind.RGBA_32BPP){const ft=!!(et||lt||it);for(G=0,ut=B*u*4,N=0;N<W;N++){if(F.set(x.subarray(c,c+ut)),c+=ut,ft)for(let j=0;j<ut;j+=4)et&&(F[j+0]=et[F[j+0]]),lt&&(F[j+1]=lt[F[j+1]]),it&&(F[j+2]=it[F[j+2]]);H.putImageData(Y,0,G),G+=u}if(N<X){if(ut=B*U*4,F.set(x.subarray(c,c+ut)),ft)for(let j=0;j<ut;j+=4)et&&(F[j+0]=et[F[j+0]]),lt&&(F[j+1]=lt[F[j+1]]),it&&(F[j+2]=it[F[j+2]]);H.putImageData(Y,0,G)}}else if(_.kind===l.ImageKind.RGB_24BPP){const ft=!!(et||lt||it);for(rt=u,ut=B*rt,N=0;N<X;N++){for(N>=W&&(rt=U,ut=B*rt),v=0,G=ut;G--;)F[v++]=x[c++],F[v++]=x[c++],F[v++]=x[c++],F[v++]=255;if(ft)for(let j=0;j<v;j+=4)et&&(F[j+0]=et[F[j+0]]),lt&&(F[j+1]=lt[F[j+1]]),it&&(F[j+2]=it[F[j+2]]);H.putImageData(Y,0,N*u)}}else throw new Error(`bad image kind: ${_.kind}`)}function e(H,_){if(_.bitmap){H.drawImage(_.bitmap,0,0);return}const p=_.height,I=_.width,B=p%u,U=(p-B)/u,W=B===0?U:U+1,X=H.createImageData(I,u);let Y=0;const c=_.data,v=X.data;for(let x=0;x<W;x++){const F=x<U?u:B;({srcPos:Y}=(0,D.applyMaskImageData)({src:c,srcPos:Y,dest:v,width:I,height:F})),H.putImageData(X,0,x*u)}}function n(H,_){const p=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let I=0,B=p.length;I<B;I++){const U=p[I];H[U]!==void 0&&(_[U]=H[U])}H.setLineDash!==void 0&&(_.setLineDash(H.getLineDash()),_.lineDashOffset=H.lineDashOffset)}function h(H,_){H.strokeStyle=H.fillStyle=_||"#000000",H.fillRule="nonzero",H.globalAlpha=1,H.lineWidth=1,H.lineCap="butt",H.lineJoin="miter",H.miterLimit=10,H.globalCompositeOperation="source-over",H.font="10px sans-serif",H.setLineDash!==void 0&&(H.setLineDash([]),H.lineDashOffset=0)}function b(H,_,p,I){const B=H.length;for(let U=3;U<B;U+=4){const W=H[U];if(W===0)H[U-3]=_,H[U-2]=p,H[U-1]=I;else if(W<255){const X=255-W;H[U-3]=H[U-3]*W+_*X>>8,H[U-2]=H[U-2]*W+p*X>>8,H[U-1]=H[U-1]*W+I*X>>8}}}function g(H,_,p){const I=H.length,B=1/255;for(let U=3;U<I;U+=4){const W=p?p[H[U]]:H[U];_[U]=_[U]*W*B|0}}function f(H,_,p){const I=H.length;for(let B=3;B<I;B+=4){const U=H[B-3]*77+H[B-2]*152+H[B-1]*28;_[B]=p?_[B]*p[U>>8]>>8:_[B]*U>>16}}function E(H,_,p,I,B,U,W,X,Y,c,v){const x=!!U,F=x?U[0]:0,N=x?U[1]:0,G=x?U[2]:0;let rt;B==="Luminosity"?rt=f:rt=g;const et=Math.min(I,Math.ceil(1048576/p));for(let lt=0;lt<I;lt+=et){const it=Math.min(et,I-lt),ct=H.getImageData(X-c,lt+(Y-v),p,it),ft=_.getImageData(X,lt+Y,p,it);x&&b(ct.data,F,N,G),rt(ct.data,ft.data,W),_.putImageData(ft,X,lt+Y)}}function J(H,_,p,I){const B=I[0],U=I[1],W=I[2]-B,X=I[3]-U;W===0||X===0||(E(_.context,p,W,X,_.subtype,_.backdrop,_.transferMap,B,U,_.offsetX,_.offsetY),H.save(),H.globalAlpha=1,H.globalCompositeOperation="source-over",H.setTransform(1,0,0,1,0,0),H.drawImage(p.canvas,0,0),H.restore())}function nt(H,_){const p=l.Util.singularValueDecompose2dScale(H);p[0]=Math.fround(p[0]),p[1]=Math.fround(p[1]);const I=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return _!==void 0?_:p[0]<=I||p[1]<=I}const Z=["butt","round","square"],Q=["miter","round","bevel"],q={},V={},_t=class _t{constructor(_,p,I,B,U,W,X,Y){ot(this,st);this.ctx=_,this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=p,this.objs=I,this.canvasFactory=B,this.imageLayer=U,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=W,this.cachedCanvases=new o(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=X,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(Y==null?void 0:Y.background)||null,this.foregroundColor=(Y==null?void 0:Y.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(_,p=null){return typeof _=="string"?_.startsWith("g_")?this.commonObjs.get(_):this.objs.get(_):p}beginDrawing({transform:_,viewport:p,transparency:I=!1,background:B=null}){const U=this.ctx.canvas.width,W=this.ctx.canvas.height,X=B||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Y=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const c=this.backgroundColor=this.ctx.fillStyle;let v=!0,x=X;if(this.ctx.fillStyle=X,x=this.ctx.fillStyle,v=typeof x=="string"&&/^#[0-9A-Fa-f]{6}$/.test(x),Y==="#000000"&&c==="#ffffff"||Y===c||!v)this.foregroundColor=this.backgroundColor=null;else{const[F,N,G]=(0,i.getRGB)(x),rt=et=>(et/=255,et<=.03928?et/12.92:((et+.055)/1.055)**2.4),ut=Math.round(.2126*rt(F)+.7152*rt(N)+.0722*rt(G));this.selectColor=(et,lt,it)=>{const ct=.2126*rt(et)+.7152*rt(lt)+.0722*rt(it);return Math.round(ct)===ut?c:Y}}}if(this.ctx.fillStyle=this.backgroundColor||X,this.ctx.fillRect(0,0,U,W),this.ctx.restore(),I){const Y=this.cachedCanvases.getCanvas("transparent",U,W);this.compositeCtx=this.ctx,this.transparentCanvas=Y.canvas,this.ctx=Y.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),h(this.ctx,this.foregroundColor),_&&(this.ctx.transform(..._),this.outputScaleX=_[0],this.outputScaleY=_[0]),this.ctx.transform(...p.transform),this.viewportScale=p.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx),this.imageLayer&&((0,i.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(_,p,I,B){const U=_.argsArray,W=_.fnArray;let X=p||0;const Y=U.length;if(Y===X)return X;const c=Y-X>R&&typeof I=="function",v=c?Date.now()+L:0;let x=0;const F=this.commonObjs,N=this.objs;let G;for(;;){if(B!==void 0&&X===B.nextBreakPoint)return B.breakIt(X,I),X;if(G=W[X],G!==l.OPS.dependency)this[G].apply(this,U[X]);else for(const rt of U[X]){const ut=rt.startsWith("g_")?F:N;if(!ut.has(rt))return ut.get(rt,I),X}if(X++,X===Y)return X;if(c&&++x>R){if(Date.now()>v)return I(),X;x=0}}}endDrawing(){dt(this,st,de).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const _ of this._cachedBitmapsMap.values()){for(const p of _.values())typeof HTMLCanvasElement<"u"&&p instanceof HTMLCanvasElement&&(p.width=p.height=0);_.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(_,p){const I=_.width,B=_.height;let U=Math.max(Math.hypot(p[0],p[1]),1),W=Math.max(Math.hypot(p[2],p[3]),1),X=I,Y=B,c="prescale1",v,x;for(;U>2&&X>1||W>2&&Y>1;){let F=X,N=Y;U>2&&X>1&&(F=Math.ceil(X/2),U/=X/F),W>2&&Y>1&&(N=Math.ceil(Y/2),W/=Y/N),v=this.cachedCanvases.getCanvas(c,F,N),x=v.context,x.clearRect(0,0,F,N),x.drawImage(_,0,0,X,Y,0,0,F,N),_=v.canvas,X=F,Y=N,c=c==="prescale1"?"prescale2":"prescale1"}return{img:_,paintWidth:X,paintHeight:Y}}_createMaskCanvas(_){const p=this.ctx,{width:I,height:B}=_,U=this.current.fillColor,W=this.current.patternFill,X=(0,i.getCurrentTransform)(p);let Y,c,v,x;if((_.bitmap||_.data)&&_.count>1){const pt=_.bitmap||_.data.buffer,vt=X.slice(0,4);c=JSON.stringify(W?vt:[vt,U]),Y=this._cachedBitmapsMap.get(pt),Y||(Y=new Map,this._cachedBitmapsMap.set(pt,Y));const St=Y.get(c);if(St&&!W){const xt=Math.round(Math.min(X[0],X[2])+X[4]),Tt=Math.round(Math.min(X[1],X[3])+X[5]);return{canvas:St,offsetX:xt,offsetY:Tt}}v=St}v||(x=this.cachedCanvases.getCanvas("maskCanvas",I,B),e(x.context,_));let F=l.Util.transform(X,[1/I,0,0,-1/B,0,0]);F=l.Util.transform(F,[1,0,0,1,0,-B]);const N=l.Util.applyTransform([0,0],F),G=l.Util.applyTransform([I,B],F),rt=l.Util.normalizeRect([N[0],N[1],G[0],G[1]]),ut=Math.round(rt[2]-rt[0])||1,et=Math.round(rt[3]-rt[1])||1,lt=this.cachedCanvases.getCanvas("fillCanvas",ut,et),it=lt.context,ct=Math.min(N[0],G[0]),ft=Math.min(N[1],G[1]);it.translate(-ct,-ft),it.transform(...F),v||(v=this._scaleImage(x.canvas,(0,i.getCurrentTransformInverse)(it)),v=v.img,Y&&W&&Y.set(c,v)),it.imageSmoothingEnabled=nt((0,i.getCurrentTransform)(it),_.interpolate),d(it,v,0,0,v.width,v.height,0,0,I,B),it.globalCompositeOperation="source-in";const j=l.Util.transform((0,i.getCurrentTransformInverse)(it),[1,0,0,1,-ct,-ft]);return it.fillStyle=W?U.getPattern(p,this,j,M.PathType.FILL):U,it.fillRect(0,0,I,B),Y&&!W&&(this.cachedCanvases.delete("fillCanvas"),Y.set(c,lt.canvas)),{canvas:lt.canvas,offsetX:Math.round(ct),offsetY:Math.round(ft)}}setLineWidth(_){_!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=_,this.ctx.lineWidth=_}setLineCap(_){this.ctx.lineCap=Z[_]}setLineJoin(_){this.ctx.lineJoin=Q[_]}setMiterLimit(_){this.ctx.miterLimit=_}setDash(_,p){const I=this.ctx;I.setLineDash!==void 0&&(I.setLineDash(_),I.lineDashOffset=p)}setRenderingIntent(_){}setFlatness(_){}setGState(_){for(let p=0,I=_.length;p<I;p++){const B=_[p],U=B[0],W=B[1];switch(U){case"LW":this.setLineWidth(W);break;case"LC":this.setLineCap(W);break;case"LJ":this.setLineJoin(W);break;case"ML":this.setMiterLimit(W);break;case"D":this.setDash(W[0],W[1]);break;case"RI":this.setRenderingIntent(W);break;case"FL":this.setFlatness(W);break;case"Font":this.setFont(W[0],W[1]);break;case"CA":this.current.strokeAlpha=B[1];break;case"ca":this.current.fillAlpha=B[1],this.ctx.globalAlpha=B[1];break;case"BM":this.ctx.globalCompositeOperation=W;break;case"SMask":this.current.activeSMask=W?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=W}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const _=this.inSMaskMode;this.current.activeSMask&&!_?this.beginSMaskMode():!this.current.activeSMask&&_&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const _=this.ctx.canvas.width,p=this.ctx.canvas.height,I="smaskGroupAt"+this.groupLevel,B=this.cachedCanvases.getCanvas(I,_,p);this.suspendedCtx=this.ctx,this.ctx=B.context;const U=this.ctx;U.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,U),s(U,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(_){if(!this.current.activeSMask)return;_?(_[0]=Math.floor(_[0]),_[1]=Math.floor(_[1]),_[2]=Math.ceil(_[2]),_[3]=Math.ceil(_[3])):_=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const p=this.current.activeSMask,I=this.suspendedCtx;J(I,p,this.ctx,_),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const _=this.current;this.stateStack.push(_),this.current=_.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(_,p,I,B,U,W){this.ctx.transform(_,p,I,B,U,W),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(_,p,I){const B=this.ctx,U=this.current;let W=U.x,X=U.y,Y,c;const v=(0,i.getCurrentTransform)(B),x=v[0]===0&&v[3]===0||v[1]===0&&v[2]===0,F=x?I.slice(0):null;for(let N=0,G=0,rt=_.length;N<rt;N++)switch(_[N]|0){case l.OPS.rectangle:W=p[G++],X=p[G++];const ut=p[G++],et=p[G++],lt=W+ut,it=X+et;B.moveTo(W,X),ut===0||et===0?B.lineTo(lt,it):(B.lineTo(lt,X),B.lineTo(lt,it),B.lineTo(W,it)),x||U.updateRectMinMax(v,[W,X,lt,it]),B.closePath();break;case l.OPS.moveTo:W=p[G++],X=p[G++],B.moveTo(W,X),x||U.updatePathMinMax(v,W,X);break;case l.OPS.lineTo:W=p[G++],X=p[G++],B.lineTo(W,X),x||U.updatePathMinMax(v,W,X);break;case l.OPS.curveTo:Y=W,c=X,W=p[G+4],X=p[G+5],B.bezierCurveTo(p[G],p[G+1],p[G+2],p[G+3],W,X),U.updateCurvePathMinMax(v,Y,c,p[G],p[G+1],p[G+2],p[G+3],W,X,F),G+=6;break;case l.OPS.curveTo2:Y=W,c=X,B.bezierCurveTo(W,X,p[G],p[G+1],p[G+2],p[G+3]),U.updateCurvePathMinMax(v,Y,c,W,X,p[G],p[G+1],p[G+2],p[G+3],F),W=p[G+2],X=p[G+3],G+=4;break;case l.OPS.curveTo3:Y=W,c=X,W=p[G+2],X=p[G+3],B.bezierCurveTo(p[G],p[G+1],W,X,W,X),U.updateCurvePathMinMax(v,Y,c,p[G],p[G+1],W,X,W,X,F),G+=4;break;case l.OPS.closePath:B.closePath();break}x&&U.updateScalingPathMinMax(v,F),U.setCurrentPoint(W,X)}closePath(){this.ctx.closePath()}stroke(_){_=typeof _<"u"?_:!0;const p=this.ctx,I=this.current.strokeColor;p.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof I=="object"&&(I!=null&&I.getPattern)?(p.save(),p.strokeStyle=I.getPattern(p,this,(0,i.getCurrentTransformInverse)(p),M.PathType.STROKE),this.rescaleAndStroke(!1),p.restore()):this.rescaleAndStroke(!0)),_&&this.consumePath(this.current.getClippedPathBoundingBox()),p.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(_){_=typeof _<"u"?_:!0;const p=this.ctx,I=this.current.fillColor,B=this.current.patternFill;let U=!1;B&&(p.save(),p.fillStyle=I.getPattern(p,this,(0,i.getCurrentTransformInverse)(p),M.PathType.FILL),U=!0);const W=this.current.getClippedPathBoundingBox();this.contentVisible&&W!==null&&(this.pendingEOFill?(p.fill("evenodd"),this.pendingEOFill=!1):p.fill()),U&&p.restore(),_&&this.consumePath(W)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=q}eoClip(){this.pendingClip=V}beginText(){this.current.textMatrix=l.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const _=this.pendingTextPaths,p=this.ctx;if(_===void 0){p.beginPath();return}p.save(),p.beginPath();for(const I of _)p.setTransform(...I.transform),p.translate(I.x,I.y),I.addToPath(p,I.fontSize);p.restore(),p.clip(),p.beginPath(),delete this.pendingTextPaths}setCharSpacing(_){this.current.charSpacing=_}setWordSpacing(_){this.current.wordSpacing=_}setHScale(_){this.current.textHScale=_/100}setLeading(_){this.current.leading=-_}setFont(_,p){const I=this.commonObjs.get(_),B=this.current;if(!I)throw new Error(`Can't find font for ${_}`);if(B.fontMatrix=I.fontMatrix||l.FONT_IDENTITY_MATRIX,(B.fontMatrix[0]===0||B.fontMatrix[3]===0)&&(0,l.warn)("Invalid font matrix for font "+_),p<0?(p=-p,B.fontDirection=-1):B.fontDirection=1,this.current.font=I,this.current.fontSize=p,I.isType3Font)return;const U=I.loadedName||"sans-serif";let W="normal";I.black?W="900":I.bold&&(W="bold");const X=I.italic?"italic":"normal",Y=`"${U}", ${I.fallbackName}`;let c=p;p<S?c=S:p>y&&(c=y),this.current.fontSizeScale=p/c,this.ctx.font=`${X} ${W} ${c}px ${Y}`}setTextRenderingMode(_){this.current.textRenderingMode=_}setTextRise(_){this.current.textRise=_}moveText(_,p){this.current.x=this.current.lineX+=_,this.current.y=this.current.lineY+=p}setLeadingMoveText(_,p){this.setLeading(-p),this.moveText(_,p)}setTextMatrix(_,p,I,B,U,W){this.current.textMatrix=[_,p,I,B,U,W],this.current.textMatrixScale=Math.hypot(_,p),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(_,p,I,B){const U=this.ctx,W=this.current,X=W.font,Y=W.textRenderingMode,c=W.fontSize/W.fontSizeScale,v=Y&l.TextRenderingMode.FILL_STROKE_MASK,x=!!(Y&l.TextRenderingMode.ADD_TO_PATH_FLAG),F=W.patternFill&&!X.missingFile;let N;(X.disableFontFace||x||F)&&(N=X.getPathGenerator(this.commonObjs,_)),X.disableFontFace||F?(U.save(),U.translate(p,I),U.beginPath(),N(U,c),B&&U.setTransform(...B),(v===l.TextRenderingMode.FILL||v===l.TextRenderingMode.FILL_STROKE)&&U.fill(),(v===l.TextRenderingMode.STROKE||v===l.TextRenderingMode.FILL_STROKE)&&U.stroke(),U.restore()):((v===l.TextRenderingMode.FILL||v===l.TextRenderingMode.FILL_STROKE)&&U.fillText(_,p,I),(v===l.TextRenderingMode.STROKE||v===l.TextRenderingMode.FILL_STROKE)&&U.strokeText(_,p,I)),x&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,i.getCurrentTransform)(U),x:p,y:I,fontSize:c,addToPath:N})}get isFontSubpixelAAEnabled(){const{context:_}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);_.scale(1.5,1),_.fillText("I",0,10);const p=_.getImageData(0,0,10,10).data;let I=!1;for(let B=3;B<p.length;B+=4)if(p[B]>0&&p[B]<255){I=!0;break}return(0,l.shadow)(this,"isFontSubpixelAAEnabled",I)}showText(_){const p=this.current,I=p.font;if(I.isType3Font)return this.showType3Text(_);const B=p.fontSize;if(B===0)return;const U=this.ctx,W=p.fontSizeScale,X=p.charSpacing,Y=p.wordSpacing,c=p.fontDirection,v=p.textHScale*c,x=_.length,F=I.vertical,N=F?1:-1,G=I.defaultVMetrics,rt=B*p.fontMatrix[0],ut=p.textRenderingMode===l.TextRenderingMode.FILL&&!I.disableFontFace&&!p.patternFill;U.save(),U.transform(...p.textMatrix),U.translate(p.x,p.y+p.textRise),c>0?U.scale(v,-1):U.scale(v,1);let et;if(p.patternFill){U.save();const j=p.fillColor.getPattern(U,this,(0,i.getCurrentTransformInverse)(U),M.PathType.FILL);et=(0,i.getCurrentTransform)(U),U.restore(),U.fillStyle=j}let lt=p.lineWidth;const it=p.textMatrixScale;if(it===0||lt===0){const j=p.textRenderingMode&l.TextRenderingMode.FILL_STROKE_MASK;(j===l.TextRenderingMode.STROKE||j===l.TextRenderingMode.FILL_STROKE)&&(lt=this.getSinglePixelWidth())}else lt/=it;W!==1&&(U.scale(W,W),lt/=W),U.lineWidth=lt;let ct=0,ft;for(ft=0;ft<x;++ft){const j=_[ft];if(typeof j=="number"){ct+=N*j*B/1e3;continue}let pt=!1;const vt=(j.isSpace?Y:0)+X,St=j.fontChar,xt=j.accent;let Tt,Mt,Ft=j.width;if(F){const wt=j.vmetric||G,Dt=-(j.vmetric?wt[1]:Ft*.5)*rt,te=wt[2]*rt;Ft=wt?-wt[0]:Ft,Tt=Dt/W,Mt=(ct+te)/W}else Tt=ct/W,Mt=0;if(I.remeasure&&Ft>0){const wt=U.measureText(St).width*1e3/B*W;if(Ft<wt&&this.isFontSubpixelAAEnabled){const Dt=Ft/wt;pt=!0,U.save(),U.scale(Dt,1),Tt/=Dt}else Ft!==wt&&(Tt+=(Ft-wt)/2e3*B/W)}if(this.contentVisible&&(j.isInFont||I.missingFile)){if(ut&&!xt)U.fillText(St,Tt,Mt);else if(this.paintChar(St,Tt,Mt,et),xt){const wt=Tt+B*xt.offset.x/W,Dt=Mt-B*xt.offset.y/W;this.paintChar(xt.fontChar,wt,Dt,et)}}let zt;F?zt=Ft*rt-vt*c:zt=Ft*rt+vt*c,ct+=zt,pt&&U.restore()}F?p.y-=ct:p.x+=ct*v,U.restore(),this.compose()}showType3Text(_){const p=this.ctx,I=this.current,B=I.font,U=I.fontSize,W=I.fontDirection,X=B.vertical?1:-1,Y=I.charSpacing,c=I.wordSpacing,v=I.textHScale*W,x=I.fontMatrix||l.FONT_IDENTITY_MATRIX,F=_.length,N=I.textRenderingMode===l.TextRenderingMode.INVISIBLE;let G,rt,ut,et;if(!(N||U===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,p.save(),p.transform(...I.textMatrix),p.translate(I.x,I.y),p.scale(v,W),G=0;G<F;++G){if(rt=_[G],typeof rt=="number"){et=X*rt*U/1e3,this.ctx.translate(et,0),I.x+=et*v;continue}const lt=(rt.isSpace?c:0)+Y,it=B.charProcOperatorList[rt.operatorListId];if(!it){(0,l.warn)(`Type3 character "${rt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=rt,this.save(),p.scale(U,U),p.transform(...x),this.executeOperatorList(it),this.restore()),ut=l.Util.applyTransform([rt.width,0],x)[0]*U+lt,p.translate(ut,0),I.x+=ut*v}p.restore(),this.processingType3=null}}setCharWidth(_,p){}setCharWidthAndBounds(_,p,I,B,U,W){this.ctx.rect(I,B,U-I,W-B),this.ctx.clip(),this.endPath()}getColorN_Pattern(_){let p;if(_[0]==="TilingPattern"){const I=_[1],B=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),U={createCanvasGraphics:W=>new _t(W,this.commonObjs,this.objs,this.canvasFactory)};p=new M.TilingPattern(_,I,this.ctx,U,B)}else p=this._getPattern(_[1],_[2]);return p}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(_,p,I){var U;const B=((U=this.selectColor)==null?void 0:U.call(this,_,p,I))||l.Util.makeHexColor(_,p,I);this.ctx.strokeStyle=B,this.current.strokeColor=B}setFillRGBColor(_,p,I){var U;const B=((U=this.selectColor)==null?void 0:U.call(this,_,p,I))||l.Util.makeHexColor(_,p,I);this.ctx.fillStyle=B,this.current.fillColor=B,this.current.patternFill=!1}_getPattern(_,p=null){let I;return this.cachedPatterns.has(_)?I=this.cachedPatterns.get(_):(I=(0,M.getShadingPattern)(this.objs.get(_)),this.cachedPatterns.set(_,I)),p&&(I.matrix=p),I}shadingFill(_){if(!this.contentVisible)return;const p=this.ctx;this.save();const I=this._getPattern(_);p.fillStyle=I.getPattern(p,this,(0,i.getCurrentTransformInverse)(p),M.PathType.SHADING);const B=(0,i.getCurrentTransformInverse)(p);if(B){const U=p.canvas,W=U.width,X=U.height,Y=l.Util.applyTransform([0,0],B),c=l.Util.applyTransform([0,X],B),v=l.Util.applyTransform([W,0],B),x=l.Util.applyTransform([W,X],B),F=Math.min(Y[0],c[0],v[0],x[0]),N=Math.min(Y[1],c[1],v[1],x[1]),G=Math.max(Y[0],c[0],v[0],x[0]),rt=Math.max(Y[1],c[1],v[1],x[1]);this.ctx.fillRect(F,N,G-F,rt-N)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,l.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,l.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(_,p){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(_)&&_.length===6&&this.transform(..._),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),p)){const I=p[2]-p[0],B=p[3]-p[1];this.ctx.rect(p[0],p[1],I,B),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),p),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(_){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const p=this.ctx;_.isolated||(0,l.info)("TODO: Support non-isolated groups."),_.knockout&&(0,l.warn)("Knockout groups not supported.");const I=(0,i.getCurrentTransform)(p);if(_.matrix&&p.transform(..._.matrix),!_.bbox)throw new Error("Bounding box is required.");let B=l.Util.getAxialAlignedBoundingBox(_.bbox,(0,i.getCurrentTransform)(p));const U=[0,0,p.canvas.width,p.canvas.height];B=l.Util.intersect(B,U)||[0,0,0,0];const W=Math.floor(B[0]),X=Math.floor(B[1]);let Y=Math.max(Math.ceil(B[2])-W,1),c=Math.max(Math.ceil(B[3])-X,1),v=1,x=1;Y>C&&(v=Y/C,Y=C),c>C&&(x=c/C,c=C),this.current.startNewPathAndClipBox([0,0,Y,c]);let F="groupAt"+this.groupLevel;_.smask&&(F+="_smask_"+this.smaskCounter++%2);const N=this.cachedCanvases.getCanvas(F,Y,c),G=N.context;G.scale(1/v,1/x),G.translate(-W,-X),G.transform(...I),_.smask?this.smaskStack.push({canvas:N.canvas,context:G,offsetX:W,offsetY:X,scaleX:v,scaleY:x,subtype:_.smask.subtype,backdrop:_.smask.backdrop,transferMap:_.smask.transferMap||null,startTransformInverse:null}):(p.setTransform(1,0,0,1,0,0),p.translate(W,X),p.scale(v,x),p.save()),n(p,G),this.ctx=G,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(p),this.groupLevel++}endGroup(_){if(!this.contentVisible)return;this.groupLevel--;const p=this.ctx,I=this.groupStack.pop();if(this.ctx=I,this.ctx.imageSmoothingEnabled=!1,_.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const B=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...B);const U=l.Util.getAxialAlignedBoundingBox([0,0,p.canvas.width,p.canvas.height],B);this.ctx.drawImage(p.canvas,0,0),this.ctx.restore(),this.compose(U)}}beginAnnotation(_,p,I,B,U){if(dt(this,st,de).call(this),h(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(p)&&p.length===4){const W=p[2]-p[0],X=p[3]-p[1];if(U&&this.annotationCanvasMap){I=I.slice(),I[4]-=p[0],I[5]-=p[1],p=p.slice(),p[0]=p[1]=0,p[2]=W,p[3]=X;const[Y,c]=l.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:v}=this,x=Math.ceil(W*this.outputScaleX*v),F=Math.ceil(X*this.outputScaleY*v);this.annotationCanvas=this.canvasFactory.create(x,F);const{canvas:N,context:G}=this.annotationCanvas;this.annotationCanvasMap.set(_,N),this.annotationCanvas.savedCtx=this.ctx,this.ctx=G,this.ctx.setTransform(Y,0,0,-c,0,X*c),h(this.ctx,this.foregroundColor)}else h(this.ctx,this.foregroundColor),this.ctx.rect(p[0],p[1],W,X),this.ctx.clip(),this.endPath()}this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...I),this.transform(...B)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(_){if(!this.contentVisible)return;const p=_.count;_=this.getObject(_.data,_),_.count=p;const I=this.ctx,B=this.processingType3;if(B&&(B.compiled===void 0&&(B.compiled=P(_)),B.compiled)){B.compiled(I);return}const U=this._createMaskCanvas(_),W=U.canvas;I.save(),I.setTransform(1,0,0,1,0,0),I.drawImage(W,U.offsetX,U.offsetY),I.restore(),this.compose()}paintImageMaskXObjectRepeat(_,p,I=0,B=0,U,W){if(!this.contentVisible)return;_=this.getObject(_.data,_);const X=this.ctx;X.save();const Y=(0,i.getCurrentTransform)(X);X.transform(p,I,B,U,0,0);const c=this._createMaskCanvas(_);X.setTransform(1,0,0,1,0,0);for(let v=0,x=W.length;v<x;v+=2){const F=l.Util.transform(Y,[p,I,B,U,W[v],W[v+1]]),[N,G]=l.Util.applyTransform([0,0],F);X.drawImage(c.canvas,N,G)}X.restore(),this.compose()}paintImageMaskXObjectGroup(_){if(!this.contentVisible)return;const p=this.ctx,I=this.current.fillColor,B=this.current.patternFill;for(const U of _){const{data:W,width:X,height:Y,transform:c}=U,v=this.cachedCanvases.getCanvas("maskCanvas",X,Y),x=v.context;x.save();const F=this.getObject(W,U);e(x,F),x.globalCompositeOperation="source-in",x.fillStyle=B?I.getPattern(x,this,(0,i.getCurrentTransformInverse)(p),M.PathType.FILL):I,x.fillRect(0,0,X,Y),x.restore(),p.save(),p.transform(...c),p.scale(1,-1),d(p,v.canvas,0,0,X,Y,0,-1,1,1),p.restore()}this.compose()}paintImageXObject(_){if(!this.contentVisible)return;const p=this.getObject(_);if(!p){(0,l.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(p)}paintImageXObjectRepeat(_,p,I,B){if(!this.contentVisible)return;const U=this.getObject(_);if(!U){(0,l.warn)("Dependent image isn't ready yet");return}const W=U.width,X=U.height,Y=[];for(let c=0,v=B.length;c<v;c+=2)Y.push({transform:[p,0,0,I,B[c],B[c+1]],x:0,y:0,w:W,h:X});this.paintInlineImageXObjectGroup(U,Y)}paintInlineImageXObject(_){if(!this.contentVisible)return;const p=_.width,I=_.height,B=this.ctx;this.save(),B.scale(1/p,-1/I);let U;if(typeof HTMLElement=="function"&&_ instanceof HTMLElement||!_.data)U=_;else{const c=this.cachedCanvases.getCanvas("inlineImage",p,I),v=c.context;t(v,_,this.current.transferMaps),U=c.canvas}const W=this._scaleImage(U,(0,i.getCurrentTransformInverse)(B));B.imageSmoothingEnabled=nt((0,i.getCurrentTransform)(B),_.interpolate);const[X,Y]=d(B,W.img,0,0,W.paintWidth,W.paintHeight,0,-I,p,I);if(this.imageLayer){const[c,v]=l.Util.applyTransform([0,-I],(0,i.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:_,left:c,top:v,width:X,height:Y})}this.compose(),this.restore()}paintInlineImageXObjectGroup(_,p){if(!this.contentVisible)return;const I=this.ctx,B=_.width,U=_.height,W=this.cachedCanvases.getCanvas("inlineImage",B,U),X=W.context;t(X,_,this.current.transferMaps);for(const Y of p){if(I.save(),I.transform(...Y.transform),I.scale(1,-1),d(I,W.canvas,Y.x,Y.y,Y.w,Y.h,0,-1,1,1),this.imageLayer){const[c,v]=l.Util.applyTransform([Y.x,Y.y],(0,i.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:_,left:c,top:v,width:B,height:U})}I.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(_){}markPointProps(_,p){}beginMarkedContent(_){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(_,p){_==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(p)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(_){const p=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(_);const I=this.ctx;this.pendingClip&&(p||(this.pendingClip===V?I.clip("evenodd"):I.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),I.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const _=(0,i.getCurrentTransform)(this.ctx);if(_[1]===0&&_[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(_[0]),Math.abs(_[3]));else{const p=Math.abs(_[0]*_[3]-_[2]*_[1]),I=Math.hypot(_[0],_[2]),B=Math.hypot(_[1],_[3]);this._cachedGetSinglePixelWidth=Math.max(I,B)/p}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:_}=this.current,p=(0,i.getCurrentTransform)(this.ctx);let I,B;if(p[1]===0&&p[2]===0){const U=Math.abs(p[0]),W=Math.abs(p[3]);if(_===0)I=1/U,B=1/W;else{const X=U*_,Y=W*_;I=X<1?1/X:1,B=Y<1?1/Y:1}}else{const U=Math.abs(p[0]*p[3]-p[2]*p[1]),W=Math.hypot(p[0],p[1]),X=Math.hypot(p[2],p[3]);if(_===0)I=X/U,B=W/U;else{const Y=_*U;I=X>Y?X/Y:1,B=W>Y?W/Y:1}}this._cachedScaleForStroking=[I,B]}return this._cachedScaleForStroking}rescaleAndStroke(_){const{ctx:p}=this,{lineWidth:I}=this.current,[B,U]=this.getScaleForStroking();if(p.lineWidth=I||1,B===1&&U===1){p.stroke();return}let W,X,Y;_&&(W=(0,i.getCurrentTransform)(p),X=p.getLineDash().slice(),Y=p.lineDashOffset),p.scale(B,U);const c=Math.max(B,U);p.setLineDash(p.getLineDash().map(v=>v/c)),p.lineDashOffset/=c,p.stroke(),_&&(p.setTransform(...W),p.setLineDash(X),p.lineDashOffset=Y)}isContentVisible(){for(let _=this.markedContentStack.length-1;_>=0;_--)if(!this.markedContentStack[_].visible)return!1;return!0}};st=new WeakSet,de=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let K=_t;a.CanvasGraphics=K;for(const H in l.OPS)K.prototype[H]!==void 0&&(K.prototype[l.OPS[H]]=K.prototype[H])},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TilingPattern=a.PathType=void 0,a.getShadingPattern=u;var i=A(1),l=A(8),M=A(3);const D={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};a.PathType=D;function w(d,P){if(!P||M.isNodeJS)return;const m=P[2]-P[0],t=P[3]-P[1],e=new Path2D;e.rect(P[0],P[1],m,t),d.clip(e)}class S{constructor(){this.constructor===S&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class y extends S{constructor(P){super(),this._type=P[1],this._bbox=P[2],this._colorStops=P[3],this._p0=P[4],this._p1=P[5],this._r0=P[6],this._r1=P[7],this.matrix=null}_createGradient(P){let m;this._type==="axial"?m=P.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(m=P.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)m.addColorStop(t[0],t[1]);return m}getPattern(P,m,t,e){let n;if(e===D.STROKE||e===D.FILL){const h=m.current.getClippedPathBoundingBox(e,(0,l.getCurrentTransform)(P))||[0,0,0,0],b=Math.ceil(h[2]-h[0])||1,g=Math.ceil(h[3]-h[1])||1,f=m.cachedCanvases.getCanvas("pattern",b,g,!0),E=f.context;E.clearRect(0,0,E.canvas.width,E.canvas.height),E.beginPath(),E.rect(0,0,E.canvas.width,E.canvas.height),E.translate(-h[0],-h[1]),t=i.Util.transform(t,[1,0,0,1,h[0],h[1]]),E.transform(...m.baseTransform),this.matrix&&E.transform(...this.matrix),w(E,this._bbox),E.fillStyle=this._createGradient(E),E.fill(),n=P.createPattern(f.canvas,"no-repeat");const J=new DOMMatrix(t);try{n.setTransform(J)}catch(nt){(0,i.warn)(`RadialAxialShadingPattern.getPattern: "${nt==null?void 0:nt.message}".`)}}else w(P,this._bbox),n=this._createGradient(P);return n}}function C(d,P,m,t,e,n,h,b){const g=P.coords,f=P.colors,E=d.data,J=d.width*4;let nt;g[m+1]>g[t+1]&&(nt=m,m=t,t=nt,nt=n,n=h,h=nt),g[t+1]>g[e+1]&&(nt=t,t=e,e=nt,nt=h,h=b,b=nt),g[m+1]>g[t+1]&&(nt=m,m=t,t=nt,nt=n,n=h,h=nt);const Z=(g[m]+P.offsetX)*P.scaleX,Q=(g[m+1]+P.offsetY)*P.scaleY,q=(g[t]+P.offsetX)*P.scaleX,V=(g[t+1]+P.offsetY)*P.scaleY,K=(g[e]+P.offsetX)*P.scaleX,st=(g[e+1]+P.offsetY)*P.scaleY;if(Q>=st)return;const ht=f[n],_t=f[n+1],H=f[n+2],_=f[h],p=f[h+1],I=f[h+2],B=f[b],U=f[b+1],W=f[b+2],X=Math.round(Q),Y=Math.round(st);let c,v,x,F,N,G,rt,ut;for(let et=X;et<=Y;et++){if(et<V){let j;et<Q?j=0:j=(Q-et)/(Q-V),c=Z-(Z-q)*j,v=ht-(ht-_)*j,x=_t-(_t-p)*j,F=H-(H-I)*j}else{let j;et>st?j=1:V===st?j=0:j=(V-et)/(V-st),c=q-(q-K)*j,v=_-(_-B)*j,x=p-(p-U)*j,F=I-(I-W)*j}let lt;et<Q?lt=0:et>st?lt=1:lt=(Q-et)/(Q-st),N=Z-(Z-K)*lt,G=ht-(ht-B)*lt,rt=_t-(_t-U)*lt,ut=H-(H-W)*lt;const it=Math.round(Math.min(c,N)),ct=Math.round(Math.max(c,N));let ft=J*et+it*4;for(let j=it;j<=ct;j++)lt=(c-j)/(c-N),lt<0?lt=0:lt>1&&(lt=1),E[ft++]=v-(v-G)*lt|0,E[ft++]=x-(x-rt)*lt|0,E[ft++]=F-(F-ut)*lt|0,E[ft++]=255}}function L(d,P,m){const t=P.coords,e=P.colors;let n,h;switch(P.type){case"lattice":const b=P.verticesPerRow,g=Math.floor(t.length/b)-1,f=b-1;for(n=0;n<g;n++){let E=n*b;for(let J=0;J<f;J++,E++)C(d,m,t[E],t[E+1],t[E+b],e[E],e[E+1],e[E+b]),C(d,m,t[E+b+1],t[E+1],t[E+b],e[E+b+1],e[E+1],e[E+b])}break;case"triangles":for(n=0,h=t.length;n<h;n+=3)C(d,m,t[n],t[n+1],t[n+2],e[n],e[n+1],e[n+2]);break;default:throw new Error("illegal figure")}}class R extends S{constructor(P){super(),this._coords=P[2],this._colors=P[3],this._figures=P[4],this._bounds=P[5],this._bbox=P[7],this._background=P[8],this.matrix=null}_createMeshCanvas(P,m,t){const b=Math.floor(this._bounds[0]),g=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-b,E=Math.ceil(this._bounds[3])-g,J=Math.min(Math.ceil(Math.abs(f*P[0]*1.1)),3e3),nt=Math.min(Math.ceil(Math.abs(E*P[1]*1.1)),3e3),Z=f/J,Q=E/nt,q={coords:this._coords,colors:this._colors,offsetX:-b,offsetY:-g,scaleX:1/Z,scaleY:1/Q},V=J+2*2,K=nt+2*2,st=t.getCanvas("mesh",V,K,!1),ht=st.context,_t=ht.createImageData(J,nt);if(m){const _=_t.data;for(let p=0,I=_.length;p<I;p+=4)_[p]=m[0],_[p+1]=m[1],_[p+2]=m[2],_[p+3]=255}for(const _ of this._figures)L(_t,_,q);return ht.putImageData(_t,2,2),{canvas:st.canvas,offsetX:b-2*Z,offsetY:g-2*Q,scaleX:Z,scaleY:Q}}getPattern(P,m,t,e){w(P,this._bbox);let n;if(e===D.SHADING)n=i.Util.singularValueDecompose2dScale((0,l.getCurrentTransform)(P));else if(n=i.Util.singularValueDecompose2dScale(m.baseTransform),this.matrix){const b=i.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*b[0],n[1]*b[1]]}const h=this._createMeshCanvas(n,e===D.SHADING?null:this._background,m.cachedCanvases);return e!==D.SHADING&&(P.setTransform(...m.baseTransform),this.matrix&&P.transform(...this.matrix)),P.translate(h.offsetX,h.offsetY),P.scale(h.scaleX,h.scaleY),P.createPattern(h.canvas,"no-repeat")}}class T extends S{getPattern(){return"hotpink"}}function u(d){switch(d[0]){case"RadialAxial":return new y(d);case"Mesh":return new R(d);case"Dummy":return new T}throw new Error(`Unknown IR type: ${d[0]}`)}const s={COLORED:1,UNCOLORED:2};class o{static get MAX_PATTERN_SIZE(){return(0,i.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(P,m,t,e,n){this.operatorList=P[2],this.matrix=P[3]||[1,0,0,1,0,0],this.bbox=P[4],this.xstep=P[5],this.ystep=P[6],this.paintType=P[7],this.tilingType=P[8],this.color=m,this.ctx=t,this.canvasGraphicsFactory=e,this.baseTransform=n}createPatternCanvas(P){const m=this.operatorList,t=this.bbox,e=this.xstep,n=this.ystep,h=this.paintType,b=this.tilingType,g=this.color,f=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+b);const E=t[0],J=t[1],nt=t[2],Z=t[3],Q=i.Util.singularValueDecompose2dScale(this.matrix),q=i.Util.singularValueDecompose2dScale(this.baseTransform),V=[Q[0]*q[0],Q[1]*q[1]],K=this.getSizeAndScale(e,this.ctx.canvas.width,V[0]),st=this.getSizeAndScale(n,this.ctx.canvas.height,V[1]),ht=P.cachedCanvases.getCanvas("pattern",K.size,st.size,!0),_t=ht.context,H=f.createCanvasGraphics(_t);H.groupLevel=P.groupLevel,this.setFillAndStrokeStyleToContext(H,h,g);let _=E,p=J,I=nt,B=Z;return E<0&&(_=0,I+=Math.abs(E)),J<0&&(p=0,B+=Math.abs(J)),_t.translate(-(K.scale*_),-(st.scale*p)),H.transform(K.scale,0,0,st.scale,0,0),_t.save(),this.clipBbox(H,_,p,I,B),H.baseTransform=(0,l.getCurrentTransform)(H.ctx),H.executeOperatorList(m),H.endDrawing(),{canvas:ht.canvas,scaleX:K.scale,scaleY:st.scale,offsetX:_,offsetY:p}}getSizeAndScale(P,m,t){P=Math.abs(P);const e=Math.max(o.MAX_PATTERN_SIZE,m);let n=Math.ceil(P*t);return n>=e?n=e:t=n/P,{scale:t,size:n}}clipBbox(P,m,t,e,n){const h=e-m,b=n-t;P.ctx.rect(m,t,h,b),P.current.updateRectMinMax((0,l.getCurrentTransform)(P.ctx),[m,t,e,n]),P.clip(),P.endPath()}setFillAndStrokeStyleToContext(P,m,t){const e=P.ctx,n=P.current;switch(m){case s.COLORED:const h=this.ctx;e.fillStyle=h.fillStyle,e.strokeStyle=h.strokeStyle,n.fillColor=h.fillStyle,n.strokeColor=h.strokeStyle;break;case s.UNCOLORED:const b=i.Util.makeHexColor(t[0],t[1],t[2]);e.fillStyle=b,e.strokeStyle=b,n.fillColor=b,n.strokeColor=b;break;default:throw new i.FormatError(`Unsupported paint type: ${m}`)}}getPattern(P,m,t,e){let n=t;e!==D.SHADING&&(n=i.Util.transform(n,m.baseTransform),this.matrix&&(n=i.Util.transform(n,this.matrix)));const h=this.createPatternCanvas(m);let b=new DOMMatrix(n);b=b.translate(h.offsetX,h.offsetY),b=b.scale(1/h.scaleX,1/h.scaleY);const g=P.createPattern(h.canvas,"repeat");try{g.setTransform(b)}catch(f){(0,i.warn)(`TilingPattern.getPattern: "${f==null?void 0:f.message}".`)}return g}}a.TilingPattern=o},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.applyMaskImageData=l;var i=A(1);function l({src:M,srcPos:D=0,dest:w,destPos:S=0,width:y,height:C,inverseDecode:L=!1}){const R=i.FeatureTest.isLittleEndian?4278190080:255,[T,u]=L?[0,R]:[R,0],s=y>>3,o=y&7,d=M.length;w=new Uint32Array(w.buffer);for(let P=0;P<C;P++){for(const t=D+s;D<t;D++){const e=D<d?M[D]:255;w[S++]=e&128?u:T,w[S++]=e&64?u:T,w[S++]=e&32?u:T,w[S++]=e&16?u:T,w[S++]=e&8?u:T,w[S++]=e&4?u:T,w[S++]=e&2?u:T,w[S++]=e&1?u:T}if(o===0)continue;const m=D<d?M[D++]:255;for(let t=0;t<o;t++)w[S++]=m&1<<7-t?u:T}return{srcPos:D,destPos:S}}},(k,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlobalWorkerOptions=void 0;const A=Object.create(null);a.GlobalWorkerOptions=A,A.workerPort=A.workerPort===void 0?null:A.workerPort,A.workerSrc=A.workerSrc===void 0?"":A.workerSrc},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MessageHandler=void 0;var i=A(1);const l={UNKNOWN:0,DATA:1,ERROR:2},M={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function D(S){switch(S instanceof Error||typeof S=="object"&&S!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new i.AbortException(S.message);case"MissingPDFException":return new i.MissingPDFException(S.message);case"PasswordException":return new i.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new i.UnknownErrorException(S.message,S.details);default:return new i.UnknownErrorException(S.message,S.toString())}}class w{constructor(y,C,L){this.sourceName=y,this.targetName=C,this.comObj=L,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=R=>{const T=R.data;if(T.targetName!==this.sourceName)return;if(T.stream){this._processStreamMessage(T);return}if(T.callback){const s=T.callbackId,o=this.callbackCapabilities[s];if(!o)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],T.callback===l.DATA)o.resolve(T.data);else if(T.callback===l.ERROR)o.reject(D(T.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[T.action];if(!u)throw new Error(`Unknown action from worker: ${T.action}`);if(T.callbackId){const s=this.sourceName,o=T.sourceName;new Promise(function(d){d(u(T.data))}).then(function(d){L.postMessage({sourceName:s,targetName:o,callback:l.DATA,callbackId:T.callbackId,data:d})},function(d){L.postMessage({sourceName:s,targetName:o,callback:l.ERROR,callbackId:T.callbackId,reason:D(d)})});return}if(T.streamId){this._createStreamSink(T);return}u(T.data)},L.addEventListener("message",this._onComObjOnMessage)}on(y,C){const L=this.actionHandler;if(L[y])throw new Error(`There is already an actionName called "${y}"`);L[y]=C}send(y,C,L){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,data:C},L)}sendWithPromise(y,C,L){const R=this.callbackId++,T=(0,i.createPromiseCapability)();this.callbackCapabilities[R]=T;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,callbackId:R,data:C},L)}catch(u){T.reject(u)}return T.promise}sendWithStream(y,C,L,R){const T=this.streamId++,u=this.sourceName,s=this.targetName,o=this.comObj;return new ReadableStream({start:d=>{const P=(0,i.createPromiseCapability)();return this.streamControllers[T]={controller:d,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:u,targetName:s,action:y,streamId:T,data:C,desiredSize:d.desiredSize},R),P.promise},pull:d=>{const P=(0,i.createPromiseCapability)();return this.streamControllers[T].pullCall=P,o.postMessage({sourceName:u,targetName:s,stream:M.PULL,streamId:T,desiredSize:d.desiredSize}),P.promise},cancel:d=>{(0,i.assert)(d instanceof Error,"cancel must have a valid reason");const P=(0,i.createPromiseCapability)();return this.streamControllers[T].cancelCall=P,this.streamControllers[T].isClosed=!0,o.postMessage({sourceName:u,targetName:s,stream:M.CANCEL,streamId:T,reason:D(d)}),P.promise}},L)}_createStreamSink(y){const C=y.streamId,L=this.sourceName,R=y.sourceName,T=this.comObj,u=this,s=this.actionHandler[y.action],o={enqueue(d,P=1,m){if(this.isCancelled)return;const t=this.desiredSize;this.desiredSize-=P,t>0&&this.desiredSize<=0&&(this.sinkCapability=(0,i.createPromiseCapability)(),this.ready=this.sinkCapability.promise),T.postMessage({sourceName:L,targetName:R,stream:M.ENQUEUE,streamId:C,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,T.postMessage({sourceName:L,targetName:R,stream:M.CLOSE,streamId:C}),delete u.streamSinks[C])},error(d){(0,i.assert)(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,T.postMessage({sourceName:L,targetName:R,stream:M.ERROR,streamId:C,reason:D(d)}))},sinkCapability:(0,i.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:y.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[C]=o,new Promise(function(d){d(s(y.data,o))}).then(function(){T.postMessage({sourceName:L,targetName:R,stream:M.START_COMPLETE,streamId:C,success:!0})},function(d){T.postMessage({sourceName:L,targetName:R,stream:M.START_COMPLETE,streamId:C,reason:D(d)})})}_processStreamMessage(y){const C=y.streamId,L=this.sourceName,R=y.sourceName,T=this.comObj,u=this.streamControllers[C],s=this.streamSinks[C];switch(y.stream){case M.START_COMPLETE:y.success?u.startCall.resolve():u.startCall.reject(D(y.reason));break;case M.PULL_COMPLETE:y.success?u.pullCall.resolve():u.pullCall.reject(D(y.reason));break;case M.PULL:if(!s){T.postMessage({sourceName:L,targetName:R,stream:M.PULL_COMPLETE,streamId:C,success:!0});break}s.desiredSize<=0&&y.desiredSize>0&&s.sinkCapability.resolve(),s.desiredSize=y.desiredSize,new Promise(function(o){o(s.onPull&&s.onPull())}).then(function(){T.postMessage({sourceName:L,targetName:R,stream:M.PULL_COMPLETE,streamId:C,success:!0})},function(o){T.postMessage({sourceName:L,targetName:R,stream:M.PULL_COMPLETE,streamId:C,reason:D(o)})});break;case M.ENQUEUE:if((0,i.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(y.chunk);break;case M.CLOSE:if((0,i.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),this._deleteStreamController(u,C);break;case M.ERROR:(0,i.assert)(u,"error should have stream controller"),u.controller.error(D(y.reason)),this._deleteStreamController(u,C);break;case M.CANCEL_COMPLETE:y.success?u.cancelCall.resolve():u.cancelCall.reject(D(y.reason)),this._deleteStreamController(u,C);break;case M.CANCEL:if(!s)break;new Promise(function(o){o(s.onCancel&&s.onCancel(D(y.reason)))}).then(function(){T.postMessage({sourceName:L,targetName:R,stream:M.CANCEL_COMPLETE,streamId:C,success:!0})},function(o){T.postMessage({sourceName:L,targetName:R,stream:M.CANCEL_COMPLETE,streamId:C,reason:D(o)})}),s.sinkCapability.reject(D(y.reason)),s.isCancelled=!0,delete this.streamSinks[C];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(y,C){await Promise.allSettled([y.startCall&&y.startCall.promise,y.pullCall&&y.pullCall.promise,y.cancelCall&&y.cancelCall.promise]),delete this.streamControllers[C]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}a.MessageHandler=w},(k,a,A)=>{var M,D;Object.defineProperty(a,"__esModule",{value:!0}),a.Metadata=void 0;var i=A(1);class l{constructor({parsedData:S,rawData:y}){ot(this,M,void 0);ot(this,D,void 0);yt(this,M,S),yt(this,D,y)}getRaw(){return O(this,D)}get(S){return O(this,M).get(S)??null}getAll(){return(0,i.objectFromMap)(O(this,M))}has(S){return O(this,M).has(S)}}M=new WeakMap,D=new WeakMap,a.Metadata=l},(k,a,A)=>{var w,S,y,C,L,R,ue;Object.defineProperty(a,"__esModule",{value:!0}),a.OptionalContentConfig=void 0;var i=A(1);const l=Symbol("INTERNAL");class M{constructor(s,o){ot(this,w,!0);this.name=s,this.intent=o}get visible(){return O(this,w)}_setVisible(s,o){s!==l&&(0,i.unreachable)("Internal method `_setVisible` called."),yt(this,w,o)}}w=new WeakMap;class D{constructor(s){ot(this,R);ot(this,S,!0);ot(this,y,new Map);ot(this,C,null);ot(this,L,null);if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,yt(this,L,s.order);for(const o of s.groups)O(this,y).set(o.id,new M(o.name,o.intent));if(s.baseState==="OFF")for(const o of O(this,y).values())o._setVisible(l,!1);for(const o of s.on)O(this,y).get(o)._setVisible(l,!0);for(const o of s.off)O(this,y).get(o)._setVisible(l,!1);yt(this,C,new Map);for(const[o,d]of O(this,y))O(this,C).set(o,d.visible)}}isVisible(s){if(O(this,y).size===0)return!0;if(!s)return(0,i.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return O(this,y).has(s.id)?O(this,y).get(s.id).visible:((0,i.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return dt(this,R,ue).call(this,s.expression);if(!s.policy||s.policy==="AnyOn"){for(const o of s.ids){if(!O(this,y).has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(O(this,y).get(o).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const o of s.ids){if(!O(this,y).has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(!O(this,y).get(o).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const o of s.ids){if(!O(this,y).has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(!O(this,y).get(o).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const o of s.ids){if(!O(this,y).has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(O(this,y).get(o).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,i.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,o=!0){if(!O(this,y).has(s)){(0,i.warn)(`Optional content group not found: ${s}`);return}O(this,y).get(s)._setVisible(l,!!o),yt(this,S,null)}get hasInitialVisibility(){if(O(this,S)!==null)return O(this,S);for(const[s,o]of O(this,y)){const d=O(this,C).get(s);if(o.visible!==d)return yt(this,S,!1)}return yt(this,S,!0)}getOrder(){return O(this,y).size?O(this,L)?O(this,L).slice():[...O(this,y).keys()]:null}getGroups(){return O(this,y).size>0?(0,i.objectFromMap)(O(this,y)):null}getGroup(s){return O(this,y).get(s)||null}}S=new WeakMap,y=new WeakMap,C=new WeakMap,L=new WeakMap,R=new WeakSet,ue=function(s){const o=s.length;if(o<2)return!0;const d=s[0];for(let P=1;P<o;P++){const m=s[P];let t;if(Array.isArray(m))t=dt(this,R,ue).call(this,m);else if(O(this,y).has(m))t=O(this,y).get(m).visible;else return(0,i.warn)(`Optional content group not found: ${m}`),!0;switch(d){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return d==="And"},a.OptionalContentConfig=D},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFDataTransportStream=void 0;var i=A(1),l=A(8);class M{constructor(y,C){(0,i.assert)(C,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=y.progressiveDone||!1,this._contentDispositionFilename=y.contentDispositionFilename||null;const L=y.initialData;if((L==null?void 0:L.length)>0){const R=new Uint8Array(L).buffer;this._queuedChunks.push(R)}this._pdfDataRangeTransport=C,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._contentLength=y.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((R,T)=>{this._onReceiveData({begin:R,chunk:T})}),this._pdfDataRangeTransport.addProgressListener((R,T)=>{this._onProgress({loaded:R,total:T})}),this._pdfDataRangeTransport.addProgressiveReadListener(R=>{this._onReceiveData({chunk:R})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(y){const C=new Uint8Array(y.chunk).buffer;if(y.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(C):this._queuedChunks.push(C);else{const L=this._rangeReaders.some(function(R){return R._begin!==y.begin?!1:(R._enqueue(C),!0)});(0,i.assert)(L,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}_onProgress(y){if(y.total===void 0){const C=this._rangeReaders[0];C!=null&&C.onProgress&&C.onProgress({loaded:y.loaded})}else{const C=this._fullRequestReader;C!=null&&C.onProgress&&C.onProgress({loaded:y.loaded,total:y.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(y){const C=this._rangeReaders.indexOf(y);C>=0&&this._rangeReaders.splice(C,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const y=this._queuedChunks;return this._queuedChunks=null,new D(this,y,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(y,C){if(C<=this._progressiveDataLength)return null;const L=new w(this,y,C);return this._pdfDataRangeTransport.requestDataRange(y,C),this._rangeReaders.push(L),L}cancelAllRequests(y){this._fullRequestReader&&this._fullRequestReader.cancel(y);for(const C of this._rangeReaders.slice(0))C.cancel(y);this._pdfDataRangeTransport.abort()}}a.PDFDataTransportStream=M;class D{constructor(y,C,L=!1,R=null){this._stream=y,this._done=L||!1,this._filename=(0,l.isPdfFile)(R)?R:null,this._queuedChunks=C||[],this._loaded=0;for(const T of this._queuedChunks)this._loaded+=T.byteLength;this._requests=[],this._headersReady=Promise.resolve(),y._fullRequestReader=this,this.onProgress=null}_enqueue(y){this._done||(this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunks.push(y),this._loaded+=y.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=(0,i.createPromiseCapability)();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const C of this._requests)C.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class w{constructor(y,C,L){this._stream=y,this._begin=C,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(y){if(!this._done){if(this._requests.length===0)this._queuedChunk=y;else{this._requests.shift().resolve({value:y,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const C=this._queuedChunk;return this._queuedChunk=null,{value:C,done:!1}}if(this._done)return{value:void 0,done:!0};const y=(0,i.createPromiseCapability)();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const C of this._requests)C.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(k,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaText=void 0;class A{static textContent(l){const M=[],D={items:M,styles:Object.create(null)};function w(S){var L;if(!S)return;let y=null;const C=S.name;if(C==="#text")y=S.value;else if(A.shouldBuildText(C))(L=S==null?void 0:S.attributes)!=null&&L.textContent?y=S.attributes.textContent:S.value&&(y=S.value);else return;if(y!==null&&M.push({str:y}),!!S.children)for(const R of S.children)w(R)}return w(l),D}static shouldBuildText(l){return!(l==="textarea"||l==="input"||l==="option"||l==="select")}}a.XfaText=A},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NodeStandardFontDataFactory=a.NodeCanvasFactory=a.NodeCMapReaderFactory=void 0;var i=A(9);const l=function(S){return new Promise((y,C)=>{require$$5.readFile(S,(R,T)=>{if(R||!T){C(new Error(R));return}y(new Uint8Array(T))})})};class M extends i.BaseCanvasFactory{_createCanvas(y,C){return require$$5.createCanvas(y,C)}}a.NodeCanvasFactory=M;class D extends i.BaseCMapReaderFactory{_fetchData(y,C){return l(y).then(L=>({cMapData:L,compressionType:C}))}}a.NodeCMapReaderFactory=D;class w extends i.BaseStandardFontDataFactory{_fetchData(y){return l(y)}}a.NodeStandardFontDataFactory=w},(k,a,A)=>{var S,y,C,L,R,T,u,s,o,pe,P,ke,t,fe,n,Fe;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditorLayer=void 0;var i=A(7),l=A(1),M=A(23),D=A(24);const b=class b{constructor(f){ot(this,o);ot(this,P);ot(this,t);ot(this,n);ot(this,S,void 0);ot(this,y,!1);ot(this,C,this.pointerup.bind(this));ot(this,L,this.pointerdown.bind(this));ot(this,R,new Map);ot(this,T,!1);ot(this,u,!1);ot(this,s,void 0);b._initialized||(b._initialized=!0,M.FreeTextEditor.initialize(f.l10n),D.InkEditor.initialize(f.l10n),f.uiManager.registerEditorTypes([M.FreeTextEditor,D.InkEditor])),yt(this,s,f.uiManager),this.annotationStorage=f.annotationStorage,this.pageIndex=f.pageIndex,this.div=f.div,yt(this,S,f.accessibilityManager),O(this,s).addLayer(this)}updateToolbar(f){O(this,s).updateToolbar(f)}updateMode(f=O(this,s).getMode()){dt(this,n,Fe).call(this),f===l.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),O(this,s).unselectAll()}addInkEditorIfNeeded(f){if(!f&&O(this,s).getMode()!==l.AnnotationEditorType.INK)return;if(!f){for(const J of O(this,R).values())if(J.isEmpty()){J.setInBackground();return}}dt(this,t,fe).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(f){O(this,s).setEditingState(f)}addCommands(f){O(this,s).addCommands(f)}enable(){this.div.style.pointerEvents="auto";for(const f of O(this,R).values())f.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const f of O(this,R).values())f.disableEditing()}setActiveEditor(f){O(this,s).getActive()!==f&&O(this,s).setActiveEditor(f)}enableClick(){this.div.addEventListener("pointerdown",O(this,L)),this.div.addEventListener("pointerup",O(this,C))}disableClick(){this.div.removeEventListener("pointerdown",O(this,L)),this.div.removeEventListener("pointerup",O(this,C))}attach(f){O(this,R).set(f.id,f)}detach(f){var E;O(this,R).delete(f.id),(E=O(this,S))==null||E.removePointerInTextLayer(f.contentDiv)}remove(f){O(this,s).removeEditor(f),this.detach(f),this.annotationStorage.remove(f.id),f.div.style.display="none",setTimeout(()=>{f.div.style.display="",f.div.remove(),f.isAttachedToDOM=!1,document.activeElement===document.body&&O(this,s).focusMainContainer()},0),O(this,u)||this.addInkEditorIfNeeded(!1)}add(f){if(dt(this,o,pe).call(this,f),O(this,s).addEditor(f),this.attach(f),!f.isAttachedToDOM){const E=f.render();this.div.append(E),f.isAttachedToDOM=!0}this.moveEditorInDOM(f),f.onceAdded(),this.addToAnnotationStorage(f)}moveEditorInDOM(f){var E;(E=O(this,S))==null||E.moveElementInDOM(this.div,f.div,f.contentDiv,!0)}addToAnnotationStorage(f){!f.isEmpty()&&!this.annotationStorage.has(f.id)&&this.annotationStorage.setValue(f.id,f)}addOrRebuild(f){f.needsToBeRebuilt()?f.rebuild():this.add(f)}addANewEditor(f){const E=()=>{this.addOrRebuild(f)},J=()=>{f.remove()};this.addCommands({cmd:E,undo:J,mustExec:!0})}addUndoableEditor(f){const E=()=>{this.addOrRebuild(f)},J=()=>{f.remove()};this.addCommands({cmd:E,undo:J,mustExec:!1})}getNextId(){return O(this,s).getId()}deserialize(f){switch(f.annotationType){case l.AnnotationEditorType.FREETEXT:return M.FreeTextEditor.deserialize(f,this);case l.AnnotationEditorType.INK:return D.InkEditor.deserialize(f,this)}return null}setSelected(f){O(this,s).setSelected(f)}toggleSelected(f){O(this,s).toggleSelected(f)}isSelected(f){return O(this,s).isSelected(f)}unselect(f){O(this,s).unselect(f)}pointerup(f){const E=i.KeyboardManager.platform.isMac;if(!(f.button!==0||f.ctrlKey&&E)&&f.target===this.div&&O(this,T)){if(yt(this,T,!1),!O(this,y)){yt(this,y,!0);return}dt(this,t,fe).call(this,f)}}pointerdown(f){const E=i.KeyboardManager.platform.isMac;if(f.button!==0||f.ctrlKey&&E||f.target!==this.div)return;yt(this,T,!0);const J=O(this,s).getActive();yt(this,y,!J||J.isEmpty())}drop(f){const E=f.dataTransfer.getData("text/plain"),J=O(this,s).getEditor(E);if(!J)return;f.preventDefault(),f.dataTransfer.dropEffect="move",dt(this,o,pe).call(this,J);const nt=this.div.getBoundingClientRect(),Z=f.clientX-nt.x,Q=f.clientY-nt.y;J.translate(Z-J.startX,Q-J.startY),this.moveEditorInDOM(J),J.div.focus()}dragover(f){f.preventDefault()}destroy(){var f,E;((f=O(this,s).getActive())==null?void 0:f.parent)===this&&O(this,s).setActiveEditor(null);for(const J of O(this,R).values())(E=O(this,S))==null||E.removePointerInTextLayer(J.contentDiv),J.isAttachedToDOM=!1,J.div.remove(),J.parent=null;this.div=null,O(this,R).clear(),O(this,s).removeLayer(this)}render(f){this.viewport=f.viewport,(0,i.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const E of O(this,s).getEditors(this.pageIndex))this.add(E);this.updateMode()}update(f){this.viewport=f.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[f,E,J,nt]=this.viewport.viewBox,Z=J-f,Q=nt-E;return[Z,Q]}get viewportBaseDimensions(){const{width:f,height:E,rotation:J}=this.viewport;return J%180===0?[f,E]:[E,f]}setDimensions(){const{width:f,height:E,rotation:J}=this.viewport,nt=J%180!==0,Z=Math.floor(f)+"px",Q=Math.floor(E)+"px";this.div.style.width=nt?Q:Z,this.div.style.height=nt?Z:Q,this.div.setAttribute("data-main-rotation",J)}};S=new WeakMap,y=new WeakMap,C=new WeakMap,L=new WeakMap,R=new WeakMap,T=new WeakMap,u=new WeakMap,s=new WeakMap,o=new WeakSet,pe=function(f){var E;f.parent!==this&&(this.attach(f),f.pageIndex=this.pageIndex,(E=f.parent)==null||E.detach(f),f.parent=this,f.div&&f.isAttachedToDOM&&(f.div.remove(),this.div.append(f.div)))},P=new WeakSet,ke=function(f){switch(O(this,s).getMode()){case l.AnnotationEditorType.FREETEXT:return new M.FreeTextEditor(f);case l.AnnotationEditorType.INK:return new D.InkEditor(f)}return null},t=new WeakSet,fe=function(f){const E=this.getNextId(),J=dt(this,P,ke).call(this,{parent:this,id:E,x:f.offsetX,y:f.offsetY});return J&&this.add(J),J},n=new WeakSet,Fe=function(){yt(this,u,!0);for(const f of O(this,R).values())f.isEmpty()&&f.remove();yt(this,u,!1)},It(b,"_initialized",!1);let w=b;a.AnnotationEditorLayer=w},(k,a,A)=>{var w,S,y,C,L,R,T,u,Me,o,Ie,P,De,t,ge;Object.defineProperty(a,"__esModule",{value:!0}),a.FreeTextEditor=void 0;var i=A(1),l=A(7),M=A(6);const n=class n extends M.AnnotationEditor{constructor(g){super({...g,name:"freeTextEditor"});ot(this,u);ot(this,o);ot(this,P);ot(this,t);ot(this,w,this.editorDivBlur.bind(this));ot(this,S,this.editorDivFocus.bind(this));ot(this,y,this.editorDivKeydown.bind(this));ot(this,C,void 0);ot(this,L,"");ot(this,R,!1);ot(this,T,void 0);yt(this,C,g.color||n._defaultColor||M.AnnotationEditor._defaultLineColor),yt(this,T,g.fontSize||n._defaultFontSize)}static initialize(g){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(E=>[E,g.get(E)]));const f=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(f.getPropertyValue("--freetext-padding"))}static updateDefaultParams(g,f){switch(g){case i.AnnotationEditorParamsType.FREETEXT_SIZE:n._defaultFontSize=f;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:n._defaultColor=f;break}}updateParams(g,f){switch(g){case i.AnnotationEditorParamsType.FREETEXT_SIZE:dt(this,u,Me).call(this,f);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:dt(this,o,Ie).call(this,f);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,n._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,n._defaultColor||M.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,O(this,T)],[i.AnnotationEditorParamsType.FREETEXT_COLOR,O(this,C)]]}getInitialTranslation(){return[-n._internalPadding*this.parent.scaleFactor,-(n._internalPadding+O(this,T))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",O(this,y)),this.editorDiv.addEventListener("focus",O(this,S)),this.editorDiv.addEventListener("blur",O(this,w)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",O(this,y)),this.editorDiv.removeEventListener("focus",O(this,S)),this.editorDiv.removeEventListener("blur",O(this,w)),this.div.focus(),this.isEditing=!1)}focusin(g){super.focusin(g),g.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),O(this,R)||(yt(this,R,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),yt(this,L,dt(this,P,De).call(this).trimEnd()),dt(this,t,ge).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(g){this.enableEditMode(),this.editorDiv.focus()}keydown(g){g.target===this.div&&g.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(g){n._keyboardManager.exec(this,g)}editorDivFocus(g){this.isEditing=!0}editorDivBlur(g){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let g,f;this.width&&(g=this.x,f=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),n._l10nPromise.get("editor_free_text_aria_label").then(J=>{var nt;return(nt=this.editorDiv)==null?void 0:nt.setAttribute("aria-label",J)}),n._l10nPromise.get("free_text_default_content").then(J=>{var nt;return(nt=this.editorDiv)==null?void 0:nt.setAttribute("default-content",J)}),this.editorDiv.contentEditable=!0;const{style:E}=this.editorDiv;if(E.fontSize=`calc(${O(this,T)}px * var(--scale-factor))`,E.color=O(this,C),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,l.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[J,nt]=this.parent.viewportBaseDimensions;this.setAt(g*J,f*nt,this.width*J,this.height*nt);for(const Z of O(this,L).split(`
`)){const Q=document.createElement("div");Q.append(Z?document.createTextNode(Z):document.createElement("br")),this.editorDiv.append(Q)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(g,f){const E=super.deserialize(g,f);return yt(E,T,g.fontSize),yt(E,C,i.Util.makeHexColor(...g.color)),yt(E,L,g.value),E}serialize(){if(this.isEmpty())return null;const g=n._internalPadding*this.parent.scaleFactor,f=this.getRect(g,g),E=M.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:i.AnnotationEditorType.FREETEXT,color:E,fontSize:O(this,T),value:O(this,L),pageIndex:this.parent.pageIndex,rect:f,rotation:this.rotation}}};w=new WeakMap,S=new WeakMap,y=new WeakMap,C=new WeakMap,L=new WeakMap,R=new WeakMap,T=new WeakMap,u=new WeakSet,Me=function(g){const f=J=>{this.editorDiv.style.fontSize=`calc(${J}px * var(--scale-factor))`,this.translate(0,-(J-O(this,T))*this.parent.scaleFactor),yt(this,T,J),dt(this,t,ge).call(this)},E=O(this,T);this.parent.addCommands({cmd:()=>{f(g)},undo:()=>{f(E)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,Ie=function(g){const f=O(this,C);this.parent.addCommands({cmd:()=>{yt(this,C,g),this.editorDiv.style.color=g},undo:()=>{yt(this,C,f),this.editorDiv.style.color=f},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},P=new WeakSet,De=function(){const g=this.editorDiv.getElementsByTagName("div");if(g.length===0)return this.editorDiv.innerText;const f=[];for(let E=0,J=g.length;E<J;E++){const Z=g[E].firstChild;(Z==null?void 0:Z.nodeName)==="#text"?f.push(Z.data):f.push("")}return f.join(`
`)},t=new WeakSet,ge=function(){const[g,f]=this.parent.viewportBaseDimensions,E=this.div.getBoundingClientRect();this.width=E.width/g,this.height=E.height/f},It(n,"_freeTextDefaultContent",""),It(n,"_l10nPromise"),It(n,"_internalPadding",0),It(n,"_defaultColor",null),It(n,"_defaultFontSize",10),It(n,"_keyboardManager",new l.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.prototype.commitOrRemove]])),It(n,"_type","freetext");let D=n;a.FreeTextEditor=D},(k,a,A)=>{var y,C,L,R,T,u,s,o,d,P,m,t,e,n,h,Oe,g,Le,E,Ne,nt,je,Q,me,V,Be,st,Ue,_t,We,_,$t,I,ye,U,ne,X,ie,c,Kt,x,be,N,se,rt,_e,et,He,it,Ge,ft,qe,pt,ve,St,re,Tt,Jt,Ft,Ae;Object.defineProperty(a,"__esModule",{value:!0}),a.InkEditor=void 0,Object.defineProperty(a,"fitCurve",{enumerable:!0,get:function(){return M.fitCurve}});var i=A(1),l=A(6),M=A(25),D=A(7);const w=16,wt=class wt extends l.AnnotationEditor{constructor(at){super({...at,name:"inkEditor"});ot(this,h);ot(this,g);ot(this,E);ot(this,nt);ot(this,Q);ot(this,V);ot(this,st);ot(this,_t);ot(this,_);ot(this,I);ot(this,U);ot(this,X);ot(this,c);ot(this,x);ot(this,N);ot(this,et);ot(this,it);ot(this,ft);ot(this,pt);ot(this,St);ot(this,Tt);ot(this,Ft);ot(this,y,0);ot(this,C,0);ot(this,L,0);ot(this,R,this.canvasPointermove.bind(this));ot(this,T,this.canvasPointerleave.bind(this));ot(this,u,this.canvasPointerup.bind(this));ot(this,s,this.canvasPointerdown.bind(this));ot(this,o,!1);ot(this,d,!1);ot(this,P,null);ot(this,m,null);ot(this,t,0);ot(this,e,0);ot(this,n,null);this.color=at.color||null,this.thickness=at.thickness||null,this.opacity=at.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(at){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(gt=>[gt,at.get(gt)]))}static updateDefaultParams(at,gt){switch(at){case i.AnnotationEditorParamsType.INK_THICKNESS:wt._defaultThickness=gt;break;case i.AnnotationEditorParamsType.INK_COLOR:wt._defaultColor=gt;break;case i.AnnotationEditorParamsType.INK_OPACITY:wt._defaultOpacity=gt/100;break}}updateParams(at,gt){switch(at){case i.AnnotationEditorParamsType.INK_THICKNESS:dt(this,h,Oe).call(this,gt);break;case i.AnnotationEditorParamsType.INK_COLOR:dt(this,g,Le).call(this,gt);break;case i.AnnotationEditorParamsType.INK_OPACITY:dt(this,E,Ne).call(this,gt);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,wt._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,wt._defaultColor||l.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(wt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||wt._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||wt._defaultColor||l.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??wt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(dt(this,U,ne).call(this),dt(this,X,ie).call(this)),this.isAttachedToDOM||(this.parent.add(this),dt(this,c,Kt).call(this)),dt(this,Tt,Jt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,O(this,m).disconnect(),yt(this,m,null),super.remove())}enableEditMode(){O(this,o)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",O(this,s)),this.canvas.addEventListener("pointerup",O(this,u)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",O(this,s)),this.canvas.removeEventListener("pointerup",O(this,u)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){O(this,o)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),yt(this,o,!0),this.div.classList.add("disabled"),dt(this,Tt,Jt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(at){super.focusin(at),this.enableEditMode()}canvasPointerdown(at){at.button!==0||!this.isInEditMode()||O(this,o)||(this.setInForeground(),at.type!=="mouse"&&this.div.focus(),at.stopPropagation(),this.canvas.addEventListener("pointerleave",O(this,T)),this.canvas.addEventListener("pointermove",O(this,R)),dt(this,V,Be).call(this,at.offsetX,at.offsetY))}canvasPointermove(at){at.stopPropagation(),dt(this,st,Ue).call(this,at.offsetX,at.offsetY)}canvasPointerup(at){at.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(at.stopPropagation(),dt(this,I,ye).call(this,at),this.setInBackground())}canvasPointerleave(at){dt(this,I,ye).call(this,at),this.setInBackground()}render(){if(this.div)return this.div;let at,gt;this.width&&(at=this.x,gt=this.y),super.render(),wt._l10nPromise.get("editor_ink_aria_label").then(bt=>{var At;return(At=this.div)==null?void 0:At.setAttribute("aria-label",bt)});const[tt,$,z,mt]=dt(this,nt,je).call(this);if(this.setAt(tt,$,0,0),this.setDims(z,mt),dt(this,U,ne).call(this),this.width){const[bt,At]=this.parent.viewportBaseDimensions;this.setAt(at*bt,gt*At,this.width*bt,this.height*At),yt(this,d,!0),dt(this,c,Kt).call(this),this.setDims(this.width*bt,this.height*At),dt(this,_,$t).call(this),dt(this,Ft,Ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return dt(this,X,ie).call(this),this.div}setDimensions(at,gt){const tt=Math.round(at),$=Math.round(gt);if(O(this,t)===tt&&O(this,e)===$)return;yt(this,t,tt),yt(this,e,$),this.canvas.style.visibility="hidden",O(this,y)&&Math.abs(O(this,y)-at/gt)>.01&&(gt=Math.ceil(at/O(this,y)),this.setDims(at,gt));const[z,mt]=this.parent.viewportBaseDimensions;this.width=at/z,this.height=gt/mt,O(this,o)&&dt(this,x,be).call(this,at,gt),dt(this,c,Kt).call(this),dt(this,_,$t).call(this),this.canvas.style.visibility="visible"}static deserialize(at,gt){var Ot,kt;const tt=super.deserialize(at,gt);tt.thickness=at.thickness,tt.color=i.Util.makeHexColor(...at.color),tt.opacity=at.opacity;const[$,z]=gt.pageDimensions,mt=tt.width*$,bt=tt.height*z,At=gt.scaleFactor,Pt=at.thickness/2;yt(tt,y,mt/bt),yt(tt,o,!0),yt(tt,t,Math.round(mt)),yt(tt,e,Math.round(bt));for(const{bezier:Et}of at.paths){const Nt=[];tt.paths.push(Nt);let Lt=At*(Et[0]-Pt),Ut=At*(bt-Et[1]-Pt);for(let jt=2,Ht=Et.length;jt<Ht;jt+=6){const Vt=At*(Et[jt]-Pt),Xt=At*(bt-Et[jt+1]-Pt),qt=At*(Et[jt+2]-Pt),Bt=At*(bt-Et[jt+3]-Pt),Gt=At*(Et[jt+4]-Pt),Yt=At*(bt-Et[jt+5]-Pt);Nt.push([[Lt,Ut],[Vt,Xt],[qt,Bt],[Gt,Yt]]),Lt=Gt,Ut=Yt}const Rt=dt(this,rt,_e).call(this,Nt);tt.bezierPath2D.push(Rt)}const Ct=dt(Ot=tt,pt,ve).call(Ot);return yt(tt,L,Math.max(w,Ct[2]-Ct[0])),yt(tt,C,Math.max(w,Ct[3]-Ct[1])),dt(kt=tt,x,be).call(kt,mt,bt),tt}serialize(){if(this.isEmpty())return null;const at=this.getRect(0,0),gt=this.rotation%180===0?at[3]-at[1]:at[2]-at[0],tt=l.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:tt,thickness:this.thickness,opacity:this.opacity,paths:dt(this,et,He).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,gt),pageIndex:this.parent.pageIndex,rect:at,rotation:this.rotation}}};y=new WeakMap,C=new WeakMap,L=new WeakMap,R=new WeakMap,T=new WeakMap,u=new WeakMap,s=new WeakMap,o=new WeakMap,d=new WeakMap,P=new WeakMap,m=new WeakMap,t=new WeakMap,e=new WeakMap,n=new WeakMap,h=new WeakSet,Oe=function(at){const gt=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=at,dt(this,Tt,Jt).call(this)},undo:()=>{this.thickness=gt,dt(this,Tt,Jt).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Le=function(at){const gt=this.color;this.parent.addCommands({cmd:()=>{this.color=at,dt(this,_,$t).call(this)},undo:()=>{this.color=gt,dt(this,_,$t).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},E=new WeakSet,Ne=function(at){at/=100;const gt=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=at,dt(this,_,$t).call(this)},undo:()=>{this.opacity=gt,dt(this,_,$t).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},nt=new WeakSet,je=function(){const{width:at,height:gt,rotation:tt}=this.parent.viewport;switch(tt){case 90:return[0,at,at,gt];case 180:return[at,gt,at,gt];case 270:return[gt,0,at,gt];default:return[0,0,at,gt]}},Q=new WeakSet,me=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,D.opacityToHex)(this.opacity)}`},V=new WeakSet,Be=function(at,gt){this.isEditing=!0,O(this,d)||(yt(this,d,!0),dt(this,c,Kt).call(this),this.thickness||(this.thickness=wt._defaultThickness),this.color||(this.color=wt._defaultColor||l.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=wt._defaultOpacity)),this.currentPath.push([at,gt]),yt(this,P,null),dt(this,Q,me).call(this),this.ctx.beginPath(),this.ctx.moveTo(at,gt),yt(this,n,()=>{O(this,n)&&(O(this,P)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):dt(this,_,$t).call(this),this.ctx.lineTo(...O(this,P)),yt(this,P,null),this.ctx.stroke()),window.requestAnimationFrame(O(this,n)))}),window.requestAnimationFrame(O(this,n))},st=new WeakSet,Ue=function(at,gt){const[tt,$]=this.currentPath.at(-1);at===tt&&gt===$||(this.currentPath.push([at,gt]),yt(this,P,[at,gt]))},_t=new WeakSet,We=function(at,gt){var Pt;this.ctx.closePath(),yt(this,n,null),at=Math.min(Math.max(at,0),this.canvas.width),gt=Math.min(Math.max(gt,0),this.canvas.height);const[tt,$]=this.currentPath.at(-1);(at!==tt||gt!==$)&&this.currentPath.push([at,gt]);let z;if(this.currentPath.length!==1)z=(0,M.fitCurve)(this.currentPath,30,null);else{const Ct=[at,gt];z=[[Ct,Ct.slice(),Ct.slice(),Ct]]}const mt=dt(Pt=wt,rt,_e).call(Pt,z);this.currentPath.length=0;const bt=()=>{this.paths.push(z),this.bezierPath2D.push(mt),this.rebuild()},At=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(dt(this,U,ne).call(this),dt(this,X,ie).call(this)),dt(this,Tt,Jt).call(this))};this.parent.addCommands({cmd:bt,undo:At,mustExec:!0})},_=new WeakSet,$t=function(){if(this.isEmpty()){dt(this,N,se).call(this);return}dt(this,Q,me).call(this);const{canvas:at,ctx:gt}=this;gt.setTransform(1,0,0,1,0,0),gt.clearRect(0,0,at.width,at.height),dt(this,N,se).call(this);for(const tt of this.bezierPath2D)gt.stroke(tt)},I=new WeakSet,ye=function(at){dt(this,_t,We).call(this,at.offsetX,at.offsetY),this.canvas.removeEventListener("pointerleave",O(this,T)),this.canvas.removeEventListener("pointermove",O(this,R)),this.parent.addToAnnotationStorage(this)},U=new WeakSet,ne=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",wt._l10nPromise.get("editor_ink_canvas_aria_label").then(at=>{var gt;return(gt=this.canvas)==null?void 0:gt.setAttribute("aria-label",at)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},X=new WeakSet,ie=function(){yt(this,m,new ResizeObserver(at=>{const gt=at[0].contentRect;gt.width&&gt.height&&this.setDimensions(gt.width,gt.height)})),O(this,m).observe(this.div)},c=new WeakSet,Kt=function(){if(!O(this,d))return;const[at,gt]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*at),this.canvas.height=Math.ceil(this.height*gt),dt(this,N,se).call(this)},x=new WeakSet,be=function(at,gt){const tt=dt(this,St,re).call(this),$=(at-tt)/O(this,L),z=(gt-tt)/O(this,C);this.scaleFactor=Math.min($,z)},N=new WeakSet,se=function(){const at=dt(this,St,re).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+at,this.translationY*this.scaleFactor+at)},rt=new WeakSet,_e=function(at){const gt=new Path2D;for(let tt=0,$=at.length;tt<$;tt++){const[z,mt,bt,At]=at[tt];tt===0&&gt.moveTo(...z),gt.bezierCurveTo(mt[0],mt[1],bt[0],bt[1],At[0],At[1])}return gt},et=new WeakSet,He=function(at,gt,tt,$){const mt=[],bt=this.thickness/2;let At,Pt;for(const Ct of this.paths){At=[],Pt=[];for(let Ot=0,kt=Ct.length;Ot<kt;Ot++){const[Et,Nt,Lt,Ut]=Ct[Ot],Rt=at*(Et[0]+gt)+bt,jt=$-at*(Et[1]+tt)-bt,Ht=at*(Nt[0]+gt)+bt,Vt=$-at*(Nt[1]+tt)-bt,Xt=at*(Lt[0]+gt)+bt,qt=$-at*(Lt[1]+tt)-bt,Bt=at*(Ut[0]+gt)+bt,Gt=$-at*(Ut[1]+tt)-bt;Ot===0&&(At.push(Rt,jt),Pt.push(Rt,jt)),At.push(Ht,Vt,Xt,qt,Bt,Gt),dt(this,it,Ge).call(this,Rt,jt,Ht,Vt,Xt,qt,Bt,Gt,4,Pt)}mt.push({bezier:At,points:Pt})}return mt},it=new WeakSet,Ge=function(at,gt,tt,$,z,mt,bt,At,Pt,Ct){if(dt(this,ft,qe).call(this,at,gt,tt,$,z,mt,bt,At)){Ct.push(bt,At);return}for(let Ot=1;Ot<Pt-1;Ot++){const kt=Ot/Pt,Et=1-kt;let Nt=kt*at+Et*tt,Lt=kt*gt+Et*$,Ut=kt*tt+Et*z,Rt=kt*$+Et*mt;const jt=kt*z+Et*bt,Ht=kt*mt+Et*At;Nt=kt*Nt+Et*Ut,Lt=kt*Lt+Et*Rt,Ut=kt*Ut+Et*jt,Rt=kt*Rt+Et*Ht,Nt=kt*Nt+Et*Ut,Lt=kt*Lt+Et*Rt,Ct.push(Nt,Lt)}Ct.push(bt,At)},ft=new WeakSet,qe=function(at,gt,tt,$,z,mt,bt,At){const Ct=(3*tt-2*at-bt)**2,Ot=(3*$-2*gt-At)**2,kt=(3*z-at-2*bt)**2,Et=(3*mt-gt-2*At)**2;return Math.max(Ct,kt)+Math.max(Ot,Et)<=10},pt=new WeakSet,ve=function(){let at=1/0,gt=-1/0,tt=1/0,$=-1/0;for(const z of this.paths)for(const[mt,bt,At,Pt]of z){const Ct=i.Util.bezierBoundingBox(...mt,...bt,...At,...Pt);at=Math.min(at,Ct[0]),tt=Math.min(tt,Ct[1]),gt=Math.max(gt,Ct[2]),$=Math.max($,Ct[3])}return[at,tt,gt,$]},St=new WeakSet,re=function(){return O(this,o)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Tt=new WeakSet,Jt=function(at=!1){if(this.isEmpty())return;if(!O(this,o)){dt(this,_,$t).call(this);return}const gt=dt(this,pt,ve).call(this),tt=dt(this,St,re).call(this);yt(this,L,Math.max(w,gt[2]-gt[0])),yt(this,C,Math.max(w,gt[3]-gt[1]));const $=Math.ceil(tt+O(this,L)*this.scaleFactor),z=Math.ceil(tt+O(this,C)*this.scaleFactor),[mt,bt]=this.parent.viewportBaseDimensions;this.width=$/mt,this.height=z/bt,yt(this,y,$/z),dt(this,Ft,Ae).call(this);const At=this.translationX,Pt=this.translationY;this.translationX=-gt[0],this.translationY=-gt[1],dt(this,c,Kt).call(this),dt(this,_,$t).call(this),yt(this,t,$),yt(this,e,z),this.setDims($,z);const Ct=at?tt/this.scaleFactor/2:0;this.translate(At-this.translationX-Ct,Pt-this.translationY-Ct)},Ft=new WeakSet,Ae=function(){const{style:at}=this.div;O(this,y)>=1?(at.minHeight=`${w}px`,at.minWidth=`${Math.round(O(this,y)*w)}px`):(at.minWidth=`${w}px`,at.minHeight=`${Math.round(w/O(this,y))}px`)},ot(wt,rt),It(wt,"_defaultColor",null),It(wt,"_defaultOpacity",1),It(wt,"_defaultThickness",1),It(wt,"_l10nPromise"),It(wt,"_type","ink");let S=wt;a.InkEditor=S},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.fitCurve=void 0;const i=A(26);a.fitCurve=i},k=>{function a(u,s,o){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(t=>{if(!Array.isArray(t)||t.some(e=>typeof e!="number")||t.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter((t,e)=>e===0||!t.every((n,h)=>n===u[e-1][h])),u.length<2)return[];const d=u.length,P=L(u[1],u[0]),m=L(u[d-2],u[d-1]);return A(u,P,m,s,o)}function A(u,s,o,d,P){var t,e,n,h,b,g,f,E,J,nt,Z,Q,q;if(u.length===2)return Q=R.vectorLen(R.subtract(u[0],u[1]))/3,t=[u[0],R.addArrays(u[0],R.mulItems(s,Q)),R.addArrays(u[1],R.mulItems(o,Q)),u[1]],[t];if(e=w(u),[t,h,g]=i(u,e,e,s,o,P),h===0||h<d)return[t];if(h<d*d)for(n=e,b=h,f=g,q=0;q<20;q++){if(n=M(t,u,n),[t,h,g]=i(u,e,n,s,o,P),h<d)return[t];if(g===f){let V=h/b;if(V>.9999&&V<1.0001)break}b=h,f=g}return Z=[],E=R.subtract(u[g-1],u[g+1]),E.every(V=>V===0)&&(E=R.subtract(u[g-1],u[g]),[E[0],E[1]]=[-E[1],E[0]]),J=R.normalize(E),nt=R.mulItems(J,-1),Z=Z.concat(A(u.slice(0,g+1),s,J,d,P)),Z=Z.concat(A(u.slice(g),nt,o,d,P)),Z}function i(u,s,o,d,P,m){var t,e,n;return t=l(u,o,d,P),[e,n]=S(u,t,s),m&&m({bez:t,points:u,params:s,maxErr:e,maxPoint:n}),[t,e,n]}function l(u,s,o,d){var P,m,t,e,n,h,b,g,f,E,J,nt,Z,Q,q,V,K,st=u[0],ht=u[u.length-1];for(P=[st,null,null,ht],m=R.zeros_Xx2x2(s.length),Z=0,Q=s.length;Z<Q;Z++)V=s[Z],K=1-V,t=m[Z],t[0]=R.mulItems(o,3*V*(K*K)),t[1]=R.mulItems(d,3*K*(V*V));for(e=[[0,0],[0,0]],n=[0,0],Z=0,Q=u.length;Z<Q;Z++)V=s[Z],t=m[Z],e[0][0]+=R.dot(t[0],t[0]),e[0][1]+=R.dot(t[0],t[1]),e[1][0]+=R.dot(t[0],t[1]),e[1][1]+=R.dot(t[1],t[1]),q=R.subtract(u[Z],T.q([st,st,ht,ht],V)),n[0]+=R.dot(t[0],q),n[1]+=R.dot(t[1],q);return h=e[0][0]*e[1][1]-e[1][0]*e[0][1],b=e[0][0]*n[1]-e[1][0]*n[0],g=n[0]*e[1][1]-n[1]*e[0][1],f=h===0?0:g/h,E=h===0?0:b/h,nt=R.vectorLen(R.subtract(st,ht)),J=1e-6*nt,f<J||E<J?(P[1]=R.addArrays(st,R.mulItems(o,nt/3)),P[2]=R.addArrays(ht,R.mulItems(d,nt/3))):(P[1]=R.addArrays(st,R.mulItems(o,f)),P[2]=R.addArrays(ht,R.mulItems(d,E))),P}function M(u,s,o){return o.map((d,P)=>D(u,s[P],d))}function D(u,s,o){var d=R.subtract(T.q(u,o),s),P=T.qprime(u,o),m=R.mulMatrix(d,P),t=R.sum(R.squareItems(P))+2*R.mulMatrix(d,T.qprimeprime(u,o));return t===0?o:o-m/t}function w(u){var s=[],o,d,P;return u.forEach((m,t)=>{o=t?d+R.vectorLen(R.subtract(m,P)):0,s.push(o),d=o,P=m}),s=s.map(m=>m/d),s}function S(u,s,o){var d,P,m,t,e,n,h,b;P=0,m=Math.floor(u.length/2);const g=y(s,10);for(e=0,n=u.length;e<n;e++)h=u[e],b=C(s,o[e],g,10),t=R.subtract(T.q(s,b),h),d=t[0]*t[0]+t[1]*t[1],d>P&&(P=d,m=e);return[P,m]}var y=function(u,s){for(var o,d=[0],P=u[0],m=0,t=1;t<=s;t++)o=T.q(u,t/s),m+=R.vectorLen(R.subtract(o,P)),d.push(m),P=o;return d=d.map(e=>e/m),d};function C(u,s,o,d){if(s<0)return 0;if(s>1)return 1;for(var P,m,t,e,n,h=1;h<=d;h++)if(s<=o[h]){e=(h-1)/d,t=h/d,m=o[h-1],P=o[h],n=(s-m)/(P-m)*(t-e)+e;break}return n}function L(u,s){return R.normalize(R.subtract(u,s))}class R{static zeros_Xx2x2(s){for(var o=[];s--;)o.push([0,0]);return o}static mulItems(s,o){return s.map(d=>d*o)}static mulMatrix(s,o){return s.reduce((d,P,m)=>d+P*o[m],0)}static subtract(s,o){return s.map((d,P)=>d-o[P])}static addArrays(s,o){return s.map((d,P)=>d+o[P])}static addItems(s,o){return s.map(d=>d+o)}static sum(s){return s.reduce((o,d)=>o+d)}static dot(s,o){return R.mulMatrix(s,o)}static vectorLen(s){return Math.hypot(...s)}static divItems(s,o){return s.map(d=>d/o)}static squareItems(s){return s.map(o=>o*o)}static normalize(s){return this.divItems(s,this.vectorLen(s))}}class T{static q(s,o){var d=1-o,P=R.mulItems(s[0],d*d*d),m=R.mulItems(s[1],3*d*d*o),t=R.mulItems(s[2],3*d*o*o),e=R.mulItems(s[3],o*o*o);return R.addArrays(R.addArrays(P,m),R.addArrays(t,e))}static qprime(s,o){var d=1-o,P=R.mulItems(R.subtract(s[1],s[0]),3*d*d),m=R.mulItems(R.subtract(s[2],s[1]),6*d*o),t=R.mulItems(R.subtract(s[3],s[2]),3*o*o);return R.addArrays(R.addArrays(P,m),t)}static qprimeprime(s,o){return R.addArrays(R.mulItems(R.addArrays(R.subtract(s[2],R.mulItems(s[1],2)),s[0]),6*(1-o)),R.mulItems(R.addArrays(R.subtract(s[3],R.mulItems(s[2],2)),s[1]),6*o))}}k.exports=a,k.exports.fitCubic=A,k.exports.createTangent=L},(k,a,A)=>{var _,Se,I,Pe,U,xe;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationLayer=void 0;var i=A(1),l=A(8),M=A(5),D=A(28),w=A(29);const S=1e3,y=9,C=new WeakSet;function L(Y){return{width:Y[2]-Y[0],height:Y[3]-Y[1]}}class R{static create(c){switch(c.data.annotationType){case i.AnnotationType.LINK:return new u(c);case i.AnnotationType.TEXT:return new s(c);case i.AnnotationType.WIDGET:switch(c.data.fieldType){case"Tx":return new d(c);case"Btn":return c.data.radioButton?new m(c):c.data.checkBox?new P(c):new t(c);case"Ch":return new e(c)}return new o(c);case i.AnnotationType.POPUP:return new n(c);case i.AnnotationType.FREETEXT:return new b(c);case i.AnnotationType.LINE:return new g(c);case i.AnnotationType.SQUARE:return new f(c);case i.AnnotationType.CIRCLE:return new E(c);case i.AnnotationType.POLYLINE:return new J(c);case i.AnnotationType.CARET:return new Z(c);case i.AnnotationType.INK:return new Q(c);case i.AnnotationType.POLYGON:return new nt(c);case i.AnnotationType.HIGHLIGHT:return new q(c);case i.AnnotationType.UNDERLINE:return new V(c);case i.AnnotationType.SQUIGGLY:return new K(c);case i.AnnotationType.STRIKEOUT:return new st(c);case i.AnnotationType.STAMP:return new ht(c);case i.AnnotationType.FILEATTACHMENT:return new _t(c);default:return new T(c)}}}class T{constructor(c,{isRenderable:v=!1,ignoreBorder:x=!1,createQuadrilaterals:F=!1}={}){this.isRenderable=v,this.data=c.data,this.layer=c.layer,this.page=c.page,this.viewport=c.viewport,this.linkService=c.linkService,this.downloadManager=c.downloadManager,this.imageResourcesPath=c.imageResourcesPath,this.renderForms=c.renderForms,this.svgFactory=c.svgFactory,this.annotationStorage=c.annotationStorage,this.enableScripting=c.enableScripting,this.hasJSActions=c.hasJSActions,this._fieldObjects=c.fieldObjects,this._mouseState=c.mouseState,v&&(this.container=this._createContainer(x)),F&&(this.quadrilaterals=this._createQuadrilaterals(x))}_createContainer(c=!1){const v=this.data,x=this.page,F=this.viewport,N=document.createElement("section"),{width:G,height:rt}=L(v.rect),[ut,et,lt,it]=F.viewBox,ct=lt-ut,ft=it-et;N.setAttribute("data-annotation-id",v.id);const j=i.Util.normalizeRect([v.rect[0],x.view[3]-v.rect[1]+x.view[1],v.rect[2],x.view[3]-v.rect[3]+x.view[1]]);if(!c&&v.borderStyle.width>0){N.style.borderWidth=`${v.borderStyle.width}px`;const vt=v.borderStyle.horizontalCornerRadius,St=v.borderStyle.verticalCornerRadius;if(vt>0||St>0){const Tt=`calc(${vt}px * var(--scale-factor)) / calc(${St}px * var(--scale-factor))`;N.style.borderRadius=Tt}else if(this instanceof m){const Tt=`calc(${G}px * var(--scale-factor)) / calc(${rt}px * var(--scale-factor))`;N.style.borderRadius=Tt}switch(v.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:N.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:N.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:N.style.borderBottomStyle="solid";break}const xt=v.borderColor||null;xt?N.style.borderColor=i.Util.makeHexColor(xt[0]|0,xt[1]|0,xt[2]|0):N.style.borderWidth=0}N.style.left=`${100*(j[0]-ut)/ct}%`,N.style.top=`${100*(j[1]-et)/ft}%`;const{rotation:pt}=v;return v.hasOwnCanvas||pt===0?(N.style.width=`${100*G/ct}%`,N.style.height=`${100*rt/ft}%`):this.setRotation(pt,N),N}setRotation(c,v=this.container){const[x,F,N,G]=this.viewport.viewBox,rt=N-x,ut=G-F,{width:et,height:lt}=L(this.data.rect);let it,ct;c%180===0?(it=100*et/rt,ct=100*lt/ut):(it=100*lt/rt,ct=100*et/ut),v.style.width=`${it}%`,v.style.height=`${ct}%`,v.setAttribute("data-main-rotation",(360-c)%360)}get _commonActions(){const c=(v,x,F)=>{const N=F.detail[v];F.target.style[x]=D.ColorConverters[`${N[0]}_HTML`](N.slice(1))};return(0,i.shadow)(this,"_commonActions",{display:v=>{const x=v.detail.display%2===1;this.container.style.visibility=x?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:x,print:v.detail.display===0||v.detail.display===3})},print:v=>{this.annotationStorage.setValue(this.data.id,{print:v.detail.print})},hidden:v=>{this.container.style.visibility=v.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:v.detail.hidden})},focus:v=>{setTimeout(()=>v.target.focus({preventScroll:!1}),0)},userName:v=>{v.target.title=v.detail.userName},readonly:v=>{v.detail.readonly?v.target.setAttribute("readonly",""):v.target.removeAttribute("readonly")},required:v=>{this._setRequired(v.target,v.detail.required)},bgColor:v=>{c("bgColor","backgroundColor",v)},fillColor:v=>{c("fillColor","backgroundColor",v)},fgColor:v=>{c("fgColor","color",v)},textColor:v=>{c("textColor","color",v)},borderColor:v=>{c("borderColor","borderColor",v)},strokeColor:v=>{c("strokeColor","borderColor",v)},rotation:v=>{const x=v.detail.rotation;this.setRotation(x),this.annotationStorage.setValue(this.data.id,{rotation:x})}})}_dispatchEventFromSandbox(c,v){const x=this._commonActions;for(const F of Object.keys(v.detail)){const N=c[F]||x[F];N&&N(v)}}_setDefaultPropertiesFromJS(c){if(!this.enableScripting)return;const v=this.annotationStorage.getRawValue(this.data.id);if(!v)return;const x=this._commonActions;for(const[F,N]of Object.entries(v)){const G=x[F];if(G){const rt={detail:{[F]:N},target:c};G(rt),delete v[F]}}}_createQuadrilaterals(c=!1){if(!this.data.quadPoints)return null;const v=[],x=this.data.rect;for(const F of this.data.quadPoints)this.data.rect=[F[2].x,F[2].y,F[1].x,F[1].y],v.push(this._createContainer(c));return this.data.rect=x,v}_createPopup(c,v){let x=this.container;this.quadrilaterals&&(c=c||this.quadrilaterals,x=this.quadrilaterals[0]),c||(c=document.createElement("div"),c.className="popupTriggerArea",x.append(c));const N=new h({container:x,trigger:c,color:v.color,titleObj:v.titleObj,modificationDate:v.modificationDate,contentsObj:v.contentsObj,richText:v.richText,hideWrapper:!0}).render();N.style.left="100%",x.append(N)}_renderQuadrilaterals(c){for(const v of this.quadrilaterals)v.className=c;return this.quadrilaterals}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(c,v=null){const x=[];if(this._fieldObjects){const F=this._fieldObjects[c];if(F)for(const{page:N,id:G,exportValues:rt}of F){if(N===-1||G===v)continue;const ut=typeof rt=="string"?rt:null,et=document.querySelector(`[data-element-id="${G}"]`);if(et&&!C.has(et)){(0,i.warn)(`_getElementsByName - element not allowed: ${G}`);continue}x.push({id:G,exportValue:ut,domElement:et})}return x}for(const F of document.getElementsByName(c)){const{id:N,exportValue:G}=F;N!==v&&C.has(F)&&x.push({id:N,exportValue:G,domElement:F})}return x}static get platform(){const c=typeof navigator<"u"?navigator.platform:"";return(0,i.shadow)(this,"platform",{isWin:c.includes("Win"),isMac:c.includes("Mac")})}}class u extends T{constructor(c,v=null){super(c,{isRenderable:!0,ignoreBorder:!!(v!=null&&v.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=c.data.isTooltipOnly}render(){const{data:c,linkService:v}=this,x=document.createElement("a");x.setAttribute("data-element-id",c.id);let F=!1;return c.url?(v.addLinkAttributes(x,c.url,c.newWindow),F=!0):c.action?(this._bindNamedAction(x,c.action),F=!0):c.dest?(this._bindLink(x,c.dest),F=!0):(c.actions&&(c.actions.Action||c.actions["Mouse Up"]||c.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(x,c),F=!0),c.resetForm?(this._bindResetFormAction(x,c.resetForm),F=!0):this.isTooltipOnly&&!F&&(this._bindLink(x,""),F=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((N,G)=>{const rt=G===0?x:x.cloneNode();return N.append(rt),N}):(this.container.className="linkAnnotation",F&&this.container.append(x),this.container)}_bindLink(c,v){c.href=this.linkService.getDestinationHash(v),c.onclick=()=>(v&&this.linkService.goToDestination(v),!1),(v||v==="")&&(c.className="internalLink")}_bindNamedAction(c,v){c.href=this.linkService.getAnchorUrl(""),c.onclick=()=>(this.linkService.executeNamedAction(v),!1),c.className="internalLink"}_bindJSAction(c,v){c.href=this.linkService.getAnchorUrl("");const x=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const F of Object.keys(v.actions)){const N=x.get(F);N&&(c[N]=()=>{var G;return(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v.id,name:F}}),!1})}c.onclick||(c.onclick=()=>!1),c.className="internalLink"}_bindResetFormAction(c,v){const x=c.onclick;if(x||(c.href=this.linkService.getAnchorUrl("")),c.className="internalLink",!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),x||(c.onclick=()=>!1);return}c.onclick=()=>{var lt;x&&x();const{fields:F,refs:N,include:G}=v,rt=[];if(F.length!==0||N.length!==0){const it=new Set(N);for(const ct of F){const ft=this._fieldObjects[ct]||[];for(const{id:j}of ft)it.add(j)}for(const ct of Object.values(this._fieldObjects))for(const ft of ct)it.has(ft.id)===G&&rt.push(ft)}else for(const it of Object.values(this._fieldObjects))rt.push(...it);const ut=this.annotationStorage,et=[];for(const it of rt){const{id:ct}=it;switch(et.push(ct),it.type){case"text":{const j=it.defaultValue||"";ut.setValue(ct,{value:j});break}case"checkbox":case"radiobutton":{const j=it.defaultValue===it.exportValues;ut.setValue(ct,{value:j});break}case"combobox":case"listbox":{const j=it.defaultValue||"";ut.setValue(ct,{value:j});break}default:continue}const ft=document.querySelector(`[data-element-id="${ct}"]`);if(ft){if(!C.has(ft)){(0,i.warn)(`_bindResetFormAction - element not allowed: ${ct}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:et,name:"ResetForm"}})),!1}}}class s extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v})}render(){this.container.className="textAnnotation";const c=document.createElement("img");return c.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",c.alt="[{{type}} Annotation]",c.dataset.l10nId="text_annotation_type",c.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(c,this.data),this.container.append(c),this.container}}class o extends T{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(c){const{isWin:v,isMac:x}=T.platform;return v&&c.ctrlKey||x&&c.metaKey}_setEventListener(c,v,x,F){v.includes("mouse")?c.addEventListener(v,N=>{var G;(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:x,value:F(N),shift:N.shiftKey,modifier:this._getKeyModifier(N)}})}):c.addEventListener(v,N=>{var G;(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:x,value:F(N)}})})}_setEventListeners(c,v,x){var F;for(const[N,G]of v)(G==="Action"||(F=this.data.actions)!=null&&F[G])&&this._setEventListener(c,N,G,x)}_setBackgroundColor(c){const v=this.data.backgroundColor||null;c.style.backgroundColor=v===null?"transparent":i.Util.makeHexColor(v[0],v[1],v[2])}_setTextStyle(c){const v=["left","center","right"],{fontColor:x}=this.data.defaultAppearanceData,F=this.data.defaultAppearanceData.fontSize||y,N=c.style;let G;if(this.data.multiLine){const rt=Math.abs(this.data.rect[3]-this.data.rect[1]),ut=Math.round(rt/(i.LINE_FACTOR*F))||1,et=rt/ut;G=Math.min(F,Math.round(et/i.LINE_FACTOR))}else{const rt=Math.abs(this.data.rect[3]-this.data.rect[1]);G=Math.min(F,Math.round(rt/i.LINE_FACTOR))}N.fontSize=`calc(${G}px * var(--scale-factor))`,N.color=i.Util.makeHexColor(x[0],x[1],x[2]),this.data.textAlignment!==null&&(N.textAlign=v[this.data.textAlignment])}_setRequired(c,v){v?c.setAttribute("required",!0):c.removeAttribute("required"),c.setAttribute("aria-required",v)}}class d extends o{constructor(c){const v=c.renderForms||!c.data.hasAppearance&&!!c.data.fieldValue;super(c,{isRenderable:v})}setPropertyOnSiblings(c,v,x,F){const N=this.annotationStorage;for(const G of this._getElementsByName(c.name,c.id))G.domElement&&(G.domElement[v]=x),N.setValue(G.id,{[F]:x})}render(){var F;const c=this.annotationStorage,v=this.data.id;this.container.className="textWidgetAnnotation";let x=null;if(this.renderForms){const N=c.getValue(v,{value:this.data.fieldValue});let G=N.formattedValue||N.value||"";const rt=c.getValue(v,{charLimit:this.data.maxLen}).charLimit;rt&&G.length>rt&&(G=G.slice(0,rt));const ut={userValue:G,formattedValue:null,valueOnFocus:""};this.data.multiLine?(x=document.createElement("textarea"),x.textContent=G,this.data.doNotScroll&&(x.style.overflowY="hidden")):(x=document.createElement("input"),x.type="text",x.setAttribute("value",G),this.data.doNotScroll&&(x.style.overflowX="hidden")),C.add(x),x.setAttribute("data-element-id",v),x.disabled=this.data.readOnly,x.name=this.data.fieldName,x.tabIndex=S,this._setRequired(x,this.data.required),rt&&(x.maxLength=rt),x.addEventListener("input",lt=>{c.setValue(v,{value:lt.target.value}),this.setPropertyOnSiblings(x,"value",lt.target.value,"value")}),x.addEventListener("resetform",lt=>{const it=this.data.defaultFieldValue??"";x.value=ut.userValue=it,ut.formattedValue=null});let et=lt=>{const{formattedValue:it}=ut;it!=null&&(lt.target.value=it),lt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){x.addEventListener("focus",it=>{ut.userValue&&(it.target.value=ut.userValue),ut.valueOnFocus=it.target.value}),x.addEventListener("updatefromsandbox",it=>{const ct={value(ft){ut.userValue=ft.detail.value??"",c.setValue(v,{value:ut.userValue.toString()}),ft.target.value=ut.userValue},formattedValue(ft){const{formattedValue:j}=ft.detail;ut.formattedValue=j,j!=null&&ft.target!==document.activeElement&&(ft.target.value=j),c.setValue(v,{formattedValue:j})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var St;const{charLimit:j}=ft.detail,{target:pt}=ft;if(j===0){pt.removeAttribute("maxLength");return}pt.setAttribute("maxLength",j);let vt=ut.userValue;!vt||vt.length<=j||(vt=vt.slice(0,j),pt.value=ut.userValue=vt,c.setValue(v,{value:vt}),(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:vt,willCommit:!0,commitKey:1,selStart:pt.selectionStart,selEnd:pt.selectionEnd}}))}};this._dispatchEventFromSandbox(ct,it)}),x.addEventListener("keydown",it=>{var j;let ct=-1;if(it.key==="Escape"?ct=0:it.key==="Enter"?ct=2:it.key==="Tab"&&(ct=3),ct===-1)return;const{value:ft}=it.target;ut.valueOnFocus!==ft&&(ut.userValue=ft,(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:ft,willCommit:!0,commitKey:ct,selStart:it.target.selectionStart,selEnd:it.target.selectionEnd}}))});const lt=et;et=null,x.addEventListener("blur",it=>{var ft;const{value:ct}=it.target;ut.userValue=ct,this._mouseState.isDown&&ut.valueOnFocus!==ct&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:ct,willCommit:!0,commitKey:1,selStart:it.target.selectionStart,selEnd:it.target.selectionEnd}})),lt(it)}),(F=this.data.actions)!=null&&F.Keystroke&&x.addEventListener("beforeinput",it=>{var Tt;const{data:ct,target:ft}=it,{value:j,selectionStart:pt,selectionEnd:vt}=ft;let St=pt,xt=vt;switch(it.inputType){case"deleteWordBackward":{const Mt=j.substring(0,pt).match(/\w*[^\w]*$/);Mt&&(St-=Mt[0].length);break}case"deleteWordForward":{const Mt=j.substring(pt).match(/^[^\w]*\w*/);Mt&&(xt+=Mt[0].length);break}case"deleteContentBackward":pt===vt&&(St-=1);break;case"deleteContentForward":pt===vt&&(xt+=1);break}it.preventDefault(),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:j,change:ct||"",willCommit:!1,selStart:St,selEnd:xt}})}),this._setEventListeners(x,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],it=>it.target.value)}if(et&&x.addEventListener("blur",et),this.data.comb){const it=(this.data.rect[2]-this.data.rect[0])/rt;x.classList.add("comb"),x.style.letterSpacing=`calc(${it}px * var(--scale-factor) - 1ch)`}}else x=document.createElement("div"),x.textContent=this.data.fieldValue,x.style.verticalAlign="middle",x.style.display="table-cell";return this._setTextStyle(x),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class P extends o{constructor(c){super(c,{isRenderable:c.renderForms})}render(){const c=this.annotationStorage,v=this.data,x=v.id;let F=c.getValue(x,{value:v.exportValue===v.fieldValue}).value;typeof F=="string"&&(F=F!=="Off",c.setValue(x,{value:F})),this.container.className="buttonWidgetAnnotation checkBox";const N=document.createElement("input");return C.add(N),N.setAttribute("data-element-id",x),N.disabled=v.readOnly,this._setRequired(N,this.data.required),N.type="checkbox",N.name=v.fieldName,F&&N.setAttribute("checked",!0),N.setAttribute("exportValue",v.exportValue),N.tabIndex=S,N.addEventListener("change",G=>{const{name:rt,checked:ut}=G.target;for(const et of this._getElementsByName(rt,x)){const lt=ut&&et.exportValue===v.exportValue;et.domElement&&(et.domElement.checked=lt),c.setValue(et.id,{value:lt})}c.setValue(x,{value:ut})}),N.addEventListener("resetform",G=>{const rt=v.defaultFieldValue||"Off";G.target.checked=rt===v.exportValue}),this.enableScripting&&this.hasJSActions&&(N.addEventListener("updatefromsandbox",G=>{const rt={value(ut){ut.target.checked=ut.detail.value!=="Off",c.setValue(x,{value:ut.target.checked})}};this._dispatchEventFromSandbox(rt,G)}),this._setEventListeners(N,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],G=>G.target.checked)),this._setBackgroundColor(N),this._setDefaultPropertiesFromJS(N),this.container.append(N),this.container}}class m extends o{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const c=this.annotationStorage,v=this.data,x=v.id;let F=c.getValue(x,{value:v.fieldValue===v.buttonValue}).value;typeof F=="string"&&(F=F!==v.buttonValue,c.setValue(x,{value:F}));const N=document.createElement("input");if(C.add(N),N.setAttribute("data-element-id",x),N.disabled=v.readOnly,this._setRequired(N,this.data.required),N.type="radio",N.name=v.fieldName,F&&N.setAttribute("checked",!0),N.tabIndex=S,N.addEventListener("change",G=>{const{name:rt,checked:ut}=G.target;for(const et of this._getElementsByName(rt,x))c.setValue(et.id,{value:!1});c.setValue(x,{value:ut})}),N.addEventListener("resetform",G=>{const rt=v.defaultFieldValue;G.target.checked=rt!=null&&rt===v.buttonValue}),this.enableScripting&&this.hasJSActions){const G=v.buttonValue;N.addEventListener("updatefromsandbox",rt=>{const ut={value:et=>{const lt=G===et.detail.value;for(const it of this._getElementsByName(et.target.name)){const ct=lt&&it.id===x;it.domElement&&(it.domElement.checked=ct),c.setValue(it.id,{value:ct})}}};this._dispatchEventFromSandbox(ut,rt)}),this._setEventListeners(N,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],rt=>rt.target.checked)}return this._setBackgroundColor(N),this._setDefaultPropertiesFromJS(N),this.container.append(N),this.container}}class t extends u{constructor(c){super(c,{ignoreBorder:c.data.hasAppearance})}render(){const c=super.render();c.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(c.title=this.data.alternativeText);const v=c.lastChild;return this.enableScripting&&this.hasJSActions&&v&&(this._setDefaultPropertiesFromJS(v),v.addEventListener("updatefromsandbox",x=>{this._dispatchEventFromSandbox({},x)})),c}}class e extends o{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const c=this.annotationStorage,v=this.data.id,x=c.getValue(v,{value:this.data.fieldValue}),F=document.createElement("select");C.add(F),F.setAttribute("data-element-id",v),F.disabled=this.data.readOnly,this._setRequired(F,this.data.required),F.name=this.data.fieldName,F.tabIndex=S;let N=this.data.combo&&this.data.options.length>0;this.data.combo||(F.size=this.data.options.length,this.data.multiSelect&&(F.multiple=!0)),F.addEventListener("resetform",et=>{const lt=this.data.defaultFieldValue;for(const it of F.options)it.selected=it.value===lt});for(const et of this.data.options){const lt=document.createElement("option");lt.textContent=et.displayValue,lt.value=et.exportValue,x.value.includes(et.exportValue)&&(lt.setAttribute("selected",!0),N=!1),F.append(lt)}let G=null;if(N){const et=document.createElement("option");et.value=" ",et.setAttribute("hidden",!0),et.setAttribute("selected",!0),F.prepend(et),G=()=>{et.remove(),F.removeEventListener("input",G),G=null},F.addEventListener("input",G)}const rt=(et,lt)=>{const it=lt?"value":"textContent",ct=et.target.options;return et.target.multiple?Array.prototype.filter.call(ct,ft=>ft.selected).map(ft=>ft[it]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][it]},ut=et=>{const lt=et.target.options;return Array.prototype.map.call(lt,it=>({displayValue:it.textContent,exportValue:it.value}))};return this.enableScripting&&this.hasJSActions?(F.addEventListener("updatefromsandbox",et=>{const lt={value(it){G==null||G();const ct=it.detail.value,ft=new Set(Array.isArray(ct)?ct:[ct]);for(const j of F.options)j.selected=ft.has(j.value);c.setValue(v,{value:rt(it,!0)})},multipleSelection(it){F.multiple=!0},remove(it){const ct=F.options,ft=it.detail.remove;ct[ft].selected=!1,F.remove(ft),ct.length>0&&Array.prototype.findIndex.call(ct,pt=>pt.selected)===-1&&(ct[0].selected=!0),c.setValue(v,{value:rt(it,!0),items:ut(it)})},clear(it){for(;F.length!==0;)F.remove(0);c.setValue(v,{value:null,items:[]})},insert(it){const{index:ct,displayValue:ft,exportValue:j}=it.detail.insert,pt=F.children[ct],vt=document.createElement("option");vt.textContent=ft,vt.value=j,pt?pt.before(vt):F.append(vt),c.setValue(v,{value:rt(it,!0),items:ut(it)})},items(it){const{items:ct}=it.detail;for(;F.length!==0;)F.remove(0);for(const ft of ct){const{displayValue:j,exportValue:pt}=ft,vt=document.createElement("option");vt.textContent=j,vt.value=pt,F.append(vt)}F.options.length>0&&(F.options[0].selected=!0),c.setValue(v,{value:rt(it,!0),items:ut(it)})},indices(it){const ct=new Set(it.detail.indices);for(const ft of it.target.options)ft.selected=ct.has(ft.index);c.setValue(v,{value:rt(it,!0)})},editable(it){it.target.disabled=!it.detail.editable}};this._dispatchEventFromSandbox(lt,et)}),F.addEventListener("input",et=>{var ct;const lt=rt(et,!0),it=rt(et,!1);c.setValue(v,{value:lt}),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:v,name:"Keystroke",value:it,changeEx:lt,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(F,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],et=>et.target.checked)):F.addEventListener("input",function(et){c.setValue(v,{value:rt(et,!0)})}),this.data.combo&&this._setTextStyle(F),this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class n extends T{constructor(c){var x,F,N;const v=!!((x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v})}render(){const c=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",c.includes(this.data.parentType))return this.container;const v=`[data-annotation-id="${this.data.parentId}"]`,x=this.layer.querySelectorAll(v);if(x.length===0)return this.container;const F=new h({container:this.container,trigger:Array.from(x),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),N=this.page,G=i.Util.normalizeRect([this.data.parentRect[0],N.view[3]-this.data.parentRect[1]+N.view[1],this.data.parentRect[2],N.view[3]-this.data.parentRect[3]+N.view[1]]),rt=G[0]+this.data.parentRect[2]-this.data.parentRect[0],ut=G[1],[et,lt,it,ct]=this.viewport.viewBox,ft=it-et,j=ct-lt;return this.container.style.left=`${100*(rt-et)/ft}%`,this.container.style.top=`${100*(ut-lt)/j}%`,this.container.append(F.render()),this.container}}class h{constructor(c){this.container=c.container,this.trigger=c.trigger,this.color=c.color,this.titleObj=c.titleObj,this.modificationDate=c.modificationDate,this.contentsObj=c.contentsObj,this.richText=c.richText,this.hideWrapper=c.hideWrapper||!1,this.pinned=!1}render(){var rt,ut;const v=document.createElement("div");v.className="popupWrapper",this.hideElement=this.hideWrapper?v:this.container,this.hideElement.hidden=!0;const x=document.createElement("div");x.className="popup";const F=this.color;if(F){const et=.7*(255-F[0])+F[0],lt=.7*(255-F[1])+F[1],it=.7*(255-F[2])+F[2];x.style.backgroundColor=i.Util.makeHexColor(et|0,lt|0,it|0)}const N=document.createElement("h1");N.dir=this.titleObj.dir,N.textContent=this.titleObj.str,x.append(N);const G=l.PDFDateString.toDateObject(this.modificationDate);if(G){const et=document.createElement("span");et.className="popupDate",et.textContent="{{date}}, {{time}}",et.dataset.l10nId="annotation_date_string",et.dataset.l10nArgs=JSON.stringify({date:G.toLocaleDateString(),time:G.toLocaleTimeString()}),x.append(et)}if((rt=this.richText)!=null&&rt.str&&(!((ut=this.contentsObj)!=null&&ut.str)||this.contentsObj.str===this.richText.str))w.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:x}),x.lastChild.className="richText popupContent";else{const et=this._formatContents(this.contentsObj);x.append(et)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const et of this.trigger)et.addEventListener("click",this._toggle.bind(this)),et.addEventListener("mouseover",this._show.bind(this,!1)),et.addEventListener("mouseout",this._hide.bind(this,!1));return x.addEventListener("click",this._hide.bind(this,!0)),v.append(x),v}_formatContents({str:c,dir:v}){const x=document.createElement("p");x.className="popupContent",x.dir=v;const F=c.split(/(?:\r\n?|\n)/);for(let N=0,G=F.length;N<G;++N){const rt=F[N];x.append(document.createTextNode(rt)),N<G-1&&x.append(document.createElement("br"))}return x}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(c=!1){c&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(c=!0){c&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class b extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0}),this.textContent=c.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const c=document.createElement("div");c.className="annotationTextContent",c.setAttribute("role","comment");for(const v of this.textContent){const x=document.createElement("span");x.textContent=v,c.append(x)}this.container.append(c)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class g extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const c=this.data,{width:v,height:x}=L(c.rect),F=this.svgFactory.create(v,x,!0),N=this.svgFactory.createElement("svg:line");return N.setAttribute("x1",c.rect[2]-c.lineCoordinates[0]),N.setAttribute("y1",c.rect[3]-c.lineCoordinates[1]),N.setAttribute("x2",c.rect[2]-c.lineCoordinates[2]),N.setAttribute("y2",c.rect[3]-c.lineCoordinates[3]),N.setAttribute("stroke-width",c.borderStyle.width||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),F.append(N),this.container.append(F),this._createPopup(N,c),this.container}}class f extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const c=this.data,{width:v,height:x}=L(c.rect),F=this.svgFactory.create(v,x,!0),N=c.borderStyle.width,G=this.svgFactory.createElement("svg:rect");return G.setAttribute("x",N/2),G.setAttribute("y",N/2),G.setAttribute("width",v-N),G.setAttribute("height",x-N),G.setAttribute("stroke-width",N||1),G.setAttribute("stroke","transparent"),G.setAttribute("fill","transparent"),F.append(G),this.container.append(F),this._createPopup(G,c),this.container}}class E extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const c=this.data,{width:v,height:x}=L(c.rect),F=this.svgFactory.create(v,x,!0),N=c.borderStyle.width,G=this.svgFactory.createElement("svg:ellipse");return G.setAttribute("cx",v/2),G.setAttribute("cy",x/2),G.setAttribute("rx",v/2-N/2),G.setAttribute("ry",x/2-N/2),G.setAttribute("stroke-width",N||1),G.setAttribute("stroke","transparent"),G.setAttribute("fill","transparent"),F.append(G),this.container.append(F),this._createPopup(G,c),this.container}}class J extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const c=this.data,{width:v,height:x}=L(c.rect),F=this.svgFactory.create(v,x,!0);let N=[];for(const rt of c.vertices){const ut=rt.x-c.rect[0],et=c.rect[3]-rt.y;N.push(ut+","+et)}N=N.join(" ");const G=this.svgFactory.createElement(this.svgElementName);return G.setAttribute("points",N),G.setAttribute("stroke-width",c.borderStyle.width||1),G.setAttribute("stroke","transparent"),G.setAttribute("fill","transparent"),F.append(G),this.container.append(F),this._createPopup(G,c),this.container}}class nt extends J{constructor(c){super(c),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Q extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const c=this.data,{width:v,height:x}=L(c.rect),F=this.svgFactory.create(v,x,!0);for(const N of c.inkLists){let G=[];for(const ut of N){const et=ut.x-c.rect[0],lt=c.rect[3]-ut.y;G.push(`${et},${lt}`)}G=G.join(" ");const rt=this.svgFactory.createElement(this.svgElementName);rt.setAttribute("points",G),rt.setAttribute("stroke-width",c.borderStyle.width||1),rt.setAttribute("stroke","transparent"),rt.setAttribute("fill","transparent"),this._createPopup(rt,c),F.append(rt)}return this.container.append(F),this.container}}class q extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class V extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class K extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class st extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ht extends T{constructor(c){var x,F,N;const v=!!(c.data.hasPopup||(x=c.data.titleObj)!=null&&x.str||(F=c.data.contentsObj)!=null&&F.str||(N=c.data.richText)!=null&&N.str);super(c,{isRenderable:v,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class _t extends T{constructor(c){var F;super(c,{isRenderable:!0});const{filename:v,content:x}=this.data.file;this.filename=(0,l.getFilenameFromUrl)(v),this.content=x,(F=this.linkService.eventBus)==null||F.dispatch("fileattachmentannotation",{source:this,filename:v,content:x})}render(){var v,x;this.container.className="fileAttachmentAnnotation";const c=document.createElement("div");return c.className="popupTriggerArea",c.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((v=this.data.titleObj)!=null&&v.str||(x=this.data.contentsObj)!=null&&x.str||this.data.richText)&&this._createPopup(c,this.data),this.container.append(c),this.container}_download(){var c;(c=this.downloadManager)==null||c.openOrDownloadData(this.container,this.content,this.filename)}}const X=class X{static render(c){var rt,ut;const{annotations:v,div:x,viewport:F,accessibilityManager:N}=c;dt(this,I,Pe).call(this,x,F);let G=0;for(const et of v){if(et.annotationType!==i.AnnotationType.POPUP){const{width:it,height:ct}=L(et.rect);if(it<=0||ct<=0)continue}const lt=R.create({data:et,layer:x,page:c.page,viewport:F,linkService:c.linkService,downloadManager:c.downloadManager,imageResourcesPath:c.imageResourcesPath||"",renderForms:c.renderForms!==!1,svgFactory:new l.DOMSVGFactory,annotationStorage:c.annotationStorage||new M.AnnotationStorage,enableScripting:c.enableScripting,hasJSActions:c.hasJSActions,fieldObjects:c.fieldObjects,mouseState:c.mouseState||{isDown:!1}});if(lt.isRenderable){const it=lt.render();if(et.hidden&&(it.style.visibility="hidden"),Array.isArray(it))for(const ct of it)ct.style.zIndex=G++,dt(rt=X,_,Se).call(rt,ct,et.id,x,N);else it.style.zIndex=G++,lt instanceof n?x.prepend(it):dt(ut=X,_,Se).call(ut,it,et.id,x,N)}}dt(this,U,xe).call(this,x,c.annotationCanvasMap)}static update(c){const{annotationCanvasMap:v,div:x,viewport:F}=c;dt(this,I,Pe).call(this,x,F),dt(this,U,xe).call(this,x,v),x.hidden=!1}};_=new WeakSet,Se=function(c,v,x,F){const N=c.firstChild||c;N.id=`${l.AnnotationPrefix}${v}`,x.append(c),F==null||F.moveElementInDOM(x,c,N,!1)},I=new WeakSet,Pe=function(c,{width:v,height:x,rotation:F}){const{style:N}=c,G=F%180!==0,rt=Math.floor(v)+"px",ut=Math.floor(x)+"px";N.width=G?ut:rt,N.height=G?rt:ut,c.setAttribute("data-main-rotation",F)},U=new WeakSet,xe=function(c,v){if(v){for(const[x,F]of v){const N=c.querySelector(`[data-annotation-id="${x}"]`);if(!N)continue;const{firstChild:G}=N;G?G.nodeName==="CANVAS"?G.replaceWith(F):G.before(F):N.append(F)}v.clear()}},ot(X,_),ot(X,I),ot(X,U);let H=X;a.AnnotationLayer=H},(k,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorConverters=void 0;function A(l){return Math.floor(Math.max(0,Math.min(1,l))*255).toString(16).padStart(2,"0")}class i{static CMYK_G([M,D,w,S]){return["G",1-Math.min(1,.3*M+.59*w+.11*D+S)]}static G_CMYK([M]){return["CMYK",0,0,0,1-M]}static G_RGB([M]){return["RGB",M,M,M]}static G_HTML([M]){const D=A(M);return`#${D}${D}${D}`}static RGB_G([M,D,w]){return["G",.3*M+.59*D+.11*w]}static RGB_HTML([M,D,w]){const S=A(M),y=A(D),C=A(w);return`#${S}${y}${C}`}static T_HTML(){return"#00000000"}static CMYK_RGB([M,D,w,S]){return["RGB",1-Math.min(1,M+S),1-Math.min(1,w+S),1-Math.min(1,D+S)]}static CMYK_HTML(M){const D=this.CMYK_RGB(M).slice(1);return this.RGB_HTML(D)}static RGB_CMYK([M,D,w]){const S=1-M,y=1-D,C=1-w,L=Math.min(S,y,C);return["CMYK",S,y,C,L]}}a.ColorConverters=i},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaLayer=void 0;var i=A(20);class l{static setupStorage(D,w,S,y,C){const L=y.getValue(w,{value:null});switch(S.name){case"textarea":if(L.value!==null&&(D.textContent=L.value),C==="print")break;D.addEventListener("input",R=>{y.setValue(w,{value:R.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(L.value===S.attributes.xfaOn?D.setAttribute("checked",!0):L.value===S.attributes.xfaOff&&D.removeAttribute("checked"),C==="print")break;D.addEventListener("change",R=>{y.setValue(w,{value:R.target.checked?R.target.getAttribute("xfaOn"):R.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&D.setAttribute("value",L.value),C==="print")break;D.addEventListener("input",R=>{y.setValue(w,{value:R.target.value})})}break;case"select":if(L.value!==null)for(const R of S.children)R.attributes.value===L.value&&(R.attributes.selected=!0);D.addEventListener("input",R=>{const T=R.target.options,u=T.selectedIndex===-1?"":T[T.selectedIndex].value;y.setValue(w,{value:u})});break}}static setAttributes({html:D,element:w,storage:S=null,intent:y,linkService:C}){const{attributes:L}=w,R=D instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${y}`);for(const[T,u]of Object.entries(L))if(u!=null)switch(T){case"class":u.length&&D.setAttribute(T,u.join(" "));break;case"dataId":break;case"id":D.setAttribute("data-element-id",u);break;case"style":Object.assign(D.style,u);break;case"textContent":D.textContent=u;break;default:(!R||T!=="href"&&T!=="newWindow")&&D.setAttribute(T,u)}R&&C.addLinkAttributes(D,L.href,L.newWindow),S&&L.dataId&&this.setupStorage(D,L.dataId,w,S)}static render(D){var s;const w=D.annotationStorage,S=D.linkService,y=D.xfaHtml,C=D.intent||"display",L=document.createElement(y.name);y.attributes&&this.setAttributes({html:L,element:y,intent:C,linkService:S});const R=[[y,-1,L]],T=D.div;if(T.append(L),D.viewport){const o=`matrix(${D.viewport.transform.join(",")})`;T.style.transform=o}C!=="richText"&&T.setAttribute("class","xfaLayer xfaFont");const u=[];for(;R.length>0;){const[o,d,P]=R.at(-1);if(d+1===o.children.length){R.pop();continue}const m=o.children[++R.at(-1)[1]];if(m===null)continue;const{name:t}=m;if(t==="#text"){const n=document.createTextNode(m.value);u.push(n),P.append(n);continue}let e;if((s=m==null?void 0:m.attributes)!=null&&s.xmlns?e=document.createElementNS(m.attributes.xmlns,t):e=document.createElement(t),P.append(e),m.attributes&&this.setAttributes({html:e,element:m,storage:w,intent:C,linkService:S}),m.children&&m.children.length>0)R.push([m,-1,e]);else if(m.value){const n=document.createTextNode(m.value);i.XfaText.shouldBuildText(t)&&u.push(n),e.append(n)}}for(const o of T.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))o.setAttribute("readOnly",!0);return{textDivs:u}}static update(D){const w=`matrix(${D.viewport.transform.join(",")})`;D.div.style.transform=w,D.div.hidden=!1}}a.XfaLayer=l},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextLayerRenderTask=void 0,a.renderTextLayer=P;var i=A(1),l=A(8);const M=1e5,D=30,w=.8,S=new Map,y=/^\s+$/g;function C(m,t){const e=S.get(m);if(e)return e;t.save(),t.font=`${D}px ${m}`;const n=t.measureText("");let h=n.fontBoundingBoxAscent,b=Math.abs(n.fontBoundingBoxDescent);if(h){t.restore();const f=h/(h+b);return S.set(m,f),f}t.strokeStyle="red",t.clearRect(0,0,D,D),t.strokeText("g",0,0);let g=t.getImageData(0,0,D,D).data;b=0;for(let f=g.length-1-3;f>=0;f-=4)if(g[f]>0){b=Math.ceil(f/4/D);break}t.clearRect(0,0,D,D),t.strokeText("A",0,D),g=t.getImageData(0,0,D,D).data,h=0;for(let f=0,E=g.length;f<E;f+=4)if(g[f]>0){h=D-Math.floor(f/4/D);break}if(t.restore(),h){const f=h/(h+b);return S.set(m,f),f}return S.set(m,w),w}function L(m,t,e,n){const h=document.createElement("span"),b=m._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};m._textDivs.push(h);const g=i.Util.transform(m._viewport.transform,t.transform);let f=Math.atan2(g[1],g[0]);const E=e[t.fontName];E.vertical&&(f+=Math.PI/2);const J=Math.hypot(g[2],g[3]),nt=J*C(E.fontFamily,n);let Z,Q;f===0?(Z=g[4],Q=g[5]-nt):(Z=g[4]+nt*Math.sin(f),Q=g[5]-nt*Math.cos(f)),h.style.left=`${Z}px`,h.style.top=`${Q}px`,h.style.fontSize=`${J}px`,h.style.fontFamily=E.fontFamily,b.fontSize=J,h.setAttribute("role","presentation"),h.textContent=t.str,h.dir=t.dir,m._fontInspectorEnabled&&(h.dataset.fontName=t.fontName),f!==0&&(b.angle=f*(180/Math.PI));let q=!1;if(t.str.length>1||m._enhanceTextSelection&&y.test(t.str))q=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const V=Math.abs(t.transform[0]),K=Math.abs(t.transform[3]);V!==K&&Math.max(V,K)/Math.min(V,K)>1.5&&(q=!0)}if(q&&(E.vertical?b.canvasWidth=t.height*m._viewport.scale:b.canvasWidth=t.width*m._viewport.scale),m._textDivProperties.set(h,b),m._textContentStream&&m._layoutText(h),m._enhanceTextSelection&&b.hasText){let V=1,K=0;f!==0&&(V=Math.cos(f),K=Math.sin(f));const st=(E.vertical?t.height:t.width)*m._viewport.scale,ht=J;let _t,H;f!==0?(_t=[V,K,-K,V,Z,Q],H=i.Util.getAxialAlignedBoundingBox([0,0,st,ht],_t)):H=[Z,Q,Z+st,Q+ht],m._bounds.push({left:H[0],top:H[1],right:H[2],bottom:H[3],div:h,size:[st,ht],m:_t})}}function R(m){if(m._canceled)return;const t=m._textDivs,e=m._capability,n=t.length;if(n>M){m._renderingDone=!0,e.resolve();return}if(!m._textContentStream)for(let h=0;h<n;h++)m._layoutText(t[h]);m._renderingDone=!0,e.resolve()}function T(m,t,e){let n=0;for(let h=0;h<e;h++){const b=m[t++];b>0&&(n=n?Math.min(b,n):b)}return n}function u(m){const t=m._bounds,e=m._viewport,n=s(e.width,e.height,t);for(let h=0;h<n.length;h++){const b=t[h].div,g=m._textDivProperties.get(b);if(g.angle===0){g.paddingLeft=t[h].left-n[h].left,g.paddingTop=t[h].top-n[h].top,g.paddingRight=n[h].right-t[h].right,g.paddingBottom=n[h].bottom-t[h].bottom,m._textDivProperties.set(b,g);continue}const f=n[h],E=t[h],J=E.m,nt=J[0],Z=J[1],Q=[[0,0],[0,E.size[1]],[E.size[0],0],E.size],q=new Float64Array(64);for(let K=0,st=Q.length;K<st;K++){const ht=i.Util.applyTransform(Q[K],J);q[K+0]=nt&&(f.left-ht[0])/nt,q[K+4]=Z&&(f.top-ht[1])/Z,q[K+8]=nt&&(f.right-ht[0])/nt,q[K+12]=Z&&(f.bottom-ht[1])/Z,q[K+16]=Z&&(f.left-ht[0])/-Z,q[K+20]=nt&&(f.top-ht[1])/nt,q[K+24]=Z&&(f.right-ht[0])/-Z,q[K+28]=nt&&(f.bottom-ht[1])/nt,q[K+32]=nt&&(f.left-ht[0])/-nt,q[K+36]=Z&&(f.top-ht[1])/-Z,q[K+40]=nt&&(f.right-ht[0])/-nt,q[K+44]=Z&&(f.bottom-ht[1])/-Z,q[K+48]=Z&&(f.left-ht[0])/Z,q[K+52]=nt&&(f.top-ht[1])/-nt,q[K+56]=Z&&(f.right-ht[0])/Z,q[K+60]=nt&&(f.bottom-ht[1])/-nt}const V=1+Math.min(Math.abs(nt),Math.abs(Z));g.paddingLeft=T(q,32,16)/V,g.paddingTop=T(q,48,16)/V,g.paddingRight=T(q,0,16)/V,g.paddingBottom=T(q,16,16)/V,m._textDivProperties.set(b,g)}}function s(m,t,e){const n=e.map(function(b,g){return{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom,index:g,x1New:void 0,x2New:void 0}});o(m,n);const h=new Array(e.length);for(const b of n){const g=b.index;h[g]={left:b.x1New,top:0,right:b.x2New,bottom:0}}e.map(function(b,g){const f=h[g],E=n[g];E.x1=b.top,E.y1=m-f.right,E.x2=b.bottom,E.y2=m-f.left,E.index=g,E.x1New=void 0,E.x2New=void 0}),o(t,n);for(const b of n){const g=b.index;h[g].top=b.x1New,h[g].bottom=b.x2New}return h}function o(m,t){t.sort(function(h,b){return h.x1-b.x1||h.index-b.index});const n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const h of t){let b=0;for(;b<n.length&&n[b].end<=h.y1;)b++;let g=n.length-1;for(;g>=0&&n[g].start>=h.y2;)g--;let f,E,J,nt,Z=-1/0;for(J=b;J<=g;J++){f=n[J],E=f.boundary;let V;E.x2>h.x1?V=E.index>h.index?E.x1New:h.x1:E.x2New===void 0?V=(E.x2+h.x1)/2:V=E.x2New,V>Z&&(Z=V)}for(h.x1New=Z,J=b;J<=g;J++)f=n[J],E=f.boundary,E.x2New===void 0?E.x2>h.x1?E.index>h.index&&(E.x2New=E.x2):E.x2New=Z:E.x2New>Z&&(E.x2New=Math.max(Z,E.x2));const Q=[];let q=null;for(J=b;J<=g;J++){f=n[J],E=f.boundary;const V=E.x2>h.x2?E:h;q===V?Q.at(-1).end=f.end:(Q.push({start:f.start,end:f.end,boundary:V}),q=V)}for(n[b].start<h.y1&&(Q[0].start=h.y1,Q.unshift({start:n[b].start,end:h.y1,boundary:n[b].boundary})),h.y2<n[g].end&&(Q.at(-1).end=h.y2,Q.push({start:h.y2,end:n[g].end,boundary:n[g].boundary})),J=b;J<=g;J++){if(f=n[J],E=f.boundary,E.x2New!==void 0)continue;let V=!1;for(nt=b-1;!V&&nt>=0&&n[nt].start>=E.y1;nt--)V=n[nt].boundary===E;for(nt=g+1;!V&&nt<n.length&&n[nt].end<=E.y2;nt++)V=n[nt].boundary===E;for(nt=0;!V&&nt<Q.length;nt++)V=Q[nt].boundary===E;V||(E.x2New=Z)}Array.prototype.splice.apply(n,[b,g-b+1,...Q])}for(const h of n){const b=h.boundary;b.x2New===void 0&&(b.x2New=Math.max(m,b.x2))}}class d{constructor({textContent:t,textContentStream:e,container:n,viewport:h,textDivs:b,textContentItemsStr:g,enhanceTextSelection:f}){var E;f&&(0,l.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=t,this._textContentStream=e,this._container=n,this._document=n.ownerDocument,this._viewport=h,this._textDivs=b||[],this._textContentItemsStr=g||[],this._enhanceTextSelection=!!f,this._fontInspectorEnabled=!!((E=globalThis.FontInspector)!=null&&E.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,i.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(t,e){for(let n=0,h=t.length;n<h;n++){if(t[n].str===void 0){if(t[n].type==="beginMarkedContentProps"||t[n].type==="beginMarkedContent"){const b=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),t[n].id!==null&&this._container.setAttribute("id",`${t[n].id}`),b.append(this._container)}else t[n].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(t[n].str),L(this,t[n],e,this._layoutTextCtx)}}_layoutText(t){const e=this._textDivProperties.get(t);let n="";if(e.canvasWidth!==0&&e.hasText){const{fontFamily:h}=t.style,{fontSize:b}=e;(b!==this._layoutTextLastFontSize||h!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${b*this._devicePixelRatio}px ${h}`,this._layoutTextLastFontSize=b,this._layoutTextLastFontFamily=h);const{width:g}=this._layoutTextCtx.measureText(t.textContent);if(g>0){const f=this._devicePixelRatio*e.canvasWidth/g;this._enhanceTextSelection&&(e.scale=f),n=`scaleX(${f})`}}if(e.angle!==0&&(n=`rotate(${e.angle}deg) ${n}`),n.length>0&&(this._enhanceTextSelection&&(e.originalTransform=n),t.style.transform=n),e.hasText&&this._container.append(t),e.hasEOL){const h=document.createElement("br");h.setAttribute("role","presentation"),this._container.append(h)}}_render(t=0){const e=(0,i.createPromiseCapability)();let n=Object.create(null);const h=this._document.createElement("canvas");if(h.height=h.width=D,this._layoutTextCtx=h.getContext("2d",{alpha:!1}),this._textContent){const b=this._textContent.items,g=this._textContent.styles;this._processItems(b,g),e.resolve()}else if(this._textContentStream){const b=()=>{this._reader.read().then(({value:g,done:f})=>{if(f){e.resolve();return}Object.assign(n,g.styles),this._processItems(g.items,n),b()},e.reject)};this._reader=this._textContentStream.getReader(),b()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');e.promise.then(()=>{n=null,t?this._renderTimer=setTimeout(()=>{R(this),this._renderTimer=null},t):R(this)},this._capability.reject)}expandTextDivs(t=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(u(this),this._bounds=null);const e=[],n=[];for(let h=0,b=this._textDivs.length;h<b;h++){const g=this._textDivs[h],f=this._textDivProperties.get(g);f.hasText&&(t?(e.length=0,n.length=0,f.originalTransform&&e.push(f.originalTransform),f.paddingTop>0?(n.push(`${f.paddingTop}px`),e.push(`translateY(${-f.paddingTop}px)`)):n.push(0),f.paddingRight>0?n.push(`${f.paddingRight/f.scale}px`):n.push(0),f.paddingBottom>0?n.push(`${f.paddingBottom}px`):n.push(0),f.paddingLeft>0?(n.push(`${f.paddingLeft/f.scale}px`),e.push(`translateX(${-f.paddingLeft/f.scale}px)`)):n.push(0),g.style.padding=n.join(" "),e.length&&(g.style.transform=e.join(" "))):(g.style.padding=null,g.style.transform=f.originalTransform))}}}a.TextLayerRenderTask=d;function P(m){const t=new d({textContent:m.textContent,textContentStream:m.textContentStream,container:m.container,viewport:m.viewport,textDivs:m.textDivs,textContentItemsStr:m.textContentItemsStr,enhanceTextSelection:m.enhanceTextSelection});return t._render(m.timeout),t}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SVGGraphics=void 0;var i=A(8),l=A(1),M=A(3);let D=class{constructor(){(0,l.unreachable)("Not implemented: SVGGraphics")}};a.SVGGraphics=D;{let s=function(e){let n=[];const h=[];for(const b of e){if(b.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),h.push(n),n=n.at(-1).items;continue}b.fn==="restore"?n=h.pop():n.push(b)}return n},o=function(e){if(Number.isInteger(e))return e.toString();const n=e.toFixed(10);let h=n.length-1;if(n[h]!=="0")return n;do h--;while(n[h]==="0");return n.substring(0,n[h]==="."?h:h+1)},d=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${o(e[0])} ${o(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const n=Math.acos(e[0])*180/Math.PI;return`rotate(${o(n)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${o(e[4])} ${o(e[5])})`;return`matrix(${o(e[0])} ${o(e[1])} ${o(e[2])} ${o(e[3])} ${o(e[4])} ${o(e[5])})`};const w={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},S="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/1999/xlink",C=["butt","round","square"],L=["miter","round","bevel"],R=function(e,n="",h=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!h)return URL.createObjectURL(new Blob([e],{type:n}));const b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let g=`data:${n};base64,`;for(let f=0,E=e.length;f<E;f+=3){const J=e[f]&255,nt=e[f+1]&255,Z=e[f+2]&255,Q=J>>2,q=(J&3)<<4|nt>>4,V=f+1<E?(nt&15)<<2|Z>>6:64,K=f+2<E?Z&63:64;g+=b[Q]+b[q]+b[V]+b[K]}return g},T=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,h=new Int32Array(256);for(let Z=0;Z<256;Z++){let Q=Z;for(let q=0;q<8;q++)Q&1?Q=3988292384^Q>>1&2147483647:Q=Q>>1&2147483647;h[Z]=Q}function b(Z,Q,q){let V=-1;for(let K=Q;K<q;K++){const st=(V^Z[K])&255,ht=h[st];V=V>>>8^ht}return V^-1}function g(Z,Q,q,V){let K=V;const st=Q.length;q[K]=st>>24&255,q[K+1]=st>>16&255,q[K+2]=st>>8&255,q[K+3]=st&255,K+=4,q[K]=Z.charCodeAt(0)&255,q[K+1]=Z.charCodeAt(1)&255,q[K+2]=Z.charCodeAt(2)&255,q[K+3]=Z.charCodeAt(3)&255,K+=4,q.set(Q,K),K+=Q.length;const ht=b(q,V+4,K);q[K]=ht>>24&255,q[K+1]=ht>>16&255,q[K+2]=ht>>8&255,q[K+3]=ht&255}function f(Z,Q,q){let V=1,K=0;for(let st=Q;st<q;++st)V=(V+(Z[st]&255))%65521,K=(K+V)%65521;return K<<16|V}function E(Z){if(!M.isNodeJS)return J(Z);try{let Q;parseInt(process.versions.node)>=8?Q=Z:Q=Buffer.from(Z);const q=require$$5.deflateSync(Q,{level:9});return q instanceof Uint8Array?q:new Uint8Array(q)}catch(Q){(0,l.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Q)}return J(Z)}function J(Z){let Q=Z.length;const q=65535,V=Math.ceil(Q/q),K=new Uint8Array(2+Q+V*5+4);let st=0;K[st++]=120,K[st++]=156;let ht=0;for(;Q>q;)K[st++]=0,K[st++]=255,K[st++]=255,K[st++]=0,K[st++]=0,K.set(Z.subarray(ht,ht+q),st),st+=q,ht+=q,Q-=q;K[st++]=1,K[st++]=Q&255,K[st++]=Q>>8&255,K[st++]=~Q&65535&255,K[st++]=(~Q&65535)>>8&255,K.set(Z.subarray(ht),st),st+=Z.length-ht;const _t=f(Z,0,Z.length);return K[st++]=_t>>24&255,K[st++]=_t>>16&255,K[st++]=_t>>8&255,K[st++]=_t&255,K}function nt(Z,Q,q,V){const K=Z.width,st=Z.height;let ht,_t,H;const _=Z.data;switch(Q){case l.ImageKind.GRAYSCALE_1BPP:_t=0,ht=1,H=K+7>>3;break;case l.ImageKind.RGB_24BPP:_t=2,ht=8,H=K*3;break;case l.ImageKind.RGBA_32BPP:_t=6,ht=8,H=K*4;break;default:throw new Error("invalid format")}const p=new Uint8Array((1+H)*st);let I=0,B=0;for(let v=0;v<st;++v)p[I++]=0,p.set(_.subarray(B,B+H),I),B+=H,I+=H;if(Q===l.ImageKind.GRAYSCALE_1BPP&&V){I=0;for(let v=0;v<st;v++){I++;for(let x=0;x<H;x++)p[I++]^=255}}const U=new Uint8Array([K>>24&255,K>>16&255,K>>8&255,K&255,st>>24&255,st>>16&255,st>>8&255,st&255,ht,_t,0,0,0]),W=E(p),X=e.length+n*3+U.length+W.length,Y=new Uint8Array(X);let c=0;return Y.set(e,c),c+=e.length,g("IHDR",U,Y,c),c+=n+U.length,g("IDATA",W,Y,c),c+=n+W.length,g("IEND",new Uint8Array(0),Y,c),R(Y,"image/png",q)}return function(Q,q,V){const K=Q.kind===void 0?l.ImageKind.GRAYSCALE_1BPP:Q.kind;return nt(Q,K,q,V)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=w.fontWeight,this.fontSize=0,this.textMatrix=l.IDENTITY_MATRIX,this.fontMatrix=l.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=l.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=w.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,h){this.x=n,this.y=h}}let P=0,m=0,t=0;a.SVGGraphics=D=class{constructor(e,n,h=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new u,this.transformMatrix=l.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!h,this._operatorIdMapping=[];for(const b in l.OPS)this._operatorIdMapping[l.OPS[b]]=b}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const n=e.fnArray,h=e.argsArray;for(let b=0,g=n.length;b<g;b++)if(n[b]===l.OPS.dependency)for(const f of h[b]){const E=f.startsWith("g_")?this.commonObjs:this.objs,J=new Promise(nt=>{E.get(f,nt)});this.current.dependencies.push(J)}return Promise.all(this.current.dependencies)}transform(e,n,h,b,g,f){const E=[e,n,h,b,g,f];this.transformMatrix=l.Util.transform(this.transformMatrix,E),this.tgrp=null}getSVG(e,n){this.viewport=n;const h=this._initialize(n);return this.loadDependencies(e).then(()=>(this.transformMatrix=l.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),h))}convertOpList(e){const n=this._operatorIdMapping,h=e.argsArray,b=e.fnArray,g=[];for(let f=0,E=b.length;f<E;f++){const J=b[f];g.push({fnId:J,fn:n[J],args:h[f]})}return s(g)}executeOpTree(e){for(const n of e){const h=n.fn,b=n.fnId,g=n.args;switch(b|0){case l.OPS.beginText:this.beginText();break;case l.OPS.dependency:break;case l.OPS.setLeading:this.setLeading(g);break;case l.OPS.setLeadingMoveText:this.setLeadingMoveText(g[0],g[1]);break;case l.OPS.setFont:this.setFont(g);break;case l.OPS.showText:this.showText(g[0]);break;case l.OPS.showSpacedText:this.showText(g[0]);break;case l.OPS.endText:this.endText();break;case l.OPS.moveText:this.moveText(g[0],g[1]);break;case l.OPS.setCharSpacing:this.setCharSpacing(g[0]);break;case l.OPS.setWordSpacing:this.setWordSpacing(g[0]);break;case l.OPS.setHScale:this.setHScale(g[0]);break;case l.OPS.setTextMatrix:this.setTextMatrix(g[0],g[1],g[2],g[3],g[4],g[5]);break;case l.OPS.setTextRise:this.setTextRise(g[0]);break;case l.OPS.setTextRenderingMode:this.setTextRenderingMode(g[0]);break;case l.OPS.setLineWidth:this.setLineWidth(g[0]);break;case l.OPS.setLineJoin:this.setLineJoin(g[0]);break;case l.OPS.setLineCap:this.setLineCap(g[0]);break;case l.OPS.setMiterLimit:this.setMiterLimit(g[0]);break;case l.OPS.setFillRGBColor:this.setFillRGBColor(g[0],g[1],g[2]);break;case l.OPS.setStrokeRGBColor:this.setStrokeRGBColor(g[0],g[1],g[2]);break;case l.OPS.setStrokeColorN:this.setStrokeColorN(g);break;case l.OPS.setFillColorN:this.setFillColorN(g);break;case l.OPS.shadingFill:this.shadingFill(g[0]);break;case l.OPS.setDash:this.setDash(g[0],g[1]);break;case l.OPS.setRenderingIntent:this.setRenderingIntent(g[0]);break;case l.OPS.setFlatness:this.setFlatness(g[0]);break;case l.OPS.setGState:this.setGState(g[0]);break;case l.OPS.fill:this.fill();break;case l.OPS.eoFill:this.eoFill();break;case l.OPS.stroke:this.stroke();break;case l.OPS.fillStroke:this.fillStroke();break;case l.OPS.eoFillStroke:this.eoFillStroke();break;case l.OPS.clip:this.clip("nonzero");break;case l.OPS.eoClip:this.clip("evenodd");break;case l.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case l.OPS.paintImageXObject:this.paintImageXObject(g[0]);break;case l.OPS.paintInlineImageXObject:this.paintInlineImageXObject(g[0]);break;case l.OPS.paintImageMaskXObject:this.paintImageMaskXObject(g[0]);break;case l.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(g[0],g[1]);break;case l.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case l.OPS.closePath:this.closePath();break;case l.OPS.closeStroke:this.closeStroke();break;case l.OPS.closeFillStroke:this.closeFillStroke();break;case l.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case l.OPS.nextLine:this.nextLine();break;case l.OPS.transform:this.transform(g[0],g[1],g[2],g[3],g[4],g[5]);break;case l.OPS.constructPath:this.constructPath(g[0],g[1]);break;case l.OPS.endPath:this.endPath();break;case 92:this.group(n.items);break;default:(0,l.warn)(`Unimplemented operator ${h}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,n,h,b,g,f){const E=this.current;E.textMatrix=E.lineMatrix=[e,n,h,b,g,f],E.textMatrixScale=Math.hypot(e,n),E.x=E.lineX=0,E.y=E.lineY=0,E.xcoords=[],E.ycoords=[],E.tspan=this.svgFactory.createElement("svg:tspan"),E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${o(E.fontSize)}px`),E.tspan.setAttributeNS(null,"y",o(-E.y)),E.txtElement=this.svgFactory.createElement("svg:text"),E.txtElement.append(E.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=l.IDENTITY_MATRIX,e.lineMatrix=l.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,n){const h=this.current;h.x=h.lineX+=e,h.y=h.lineY+=n,h.xcoords=[],h.ycoords=[],h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${o(h.fontSize)}px`),h.tspan.setAttributeNS(null,"y",o(-h.y))}showText(e){const n=this.current,h=n.font,b=n.fontSize;if(b===0)return;const g=n.fontSizeScale,f=n.charSpacing,E=n.wordSpacing,J=n.fontDirection,nt=n.textHScale*J,Z=h.vertical,Q=Z?1:-1,q=h.defaultVMetrics,V=b*n.fontMatrix[0];let K=0;for(const _t of e){if(_t===null){K+=J*E;continue}else if(typeof _t=="number"){K+=Q*_t*b/1e3;continue}const H=(_t.isSpace?E:0)+f,_=_t.fontChar;let p,I,B=_t.width;if(Z){let W;const X=_t.vmetric||q;W=_t.vmetric?X[1]:B*.5,W=-W*V;const Y=X[2]*V;B=X?-X[0]:B,p=W/g,I=(K+Y)/g}else p=K/g,I=0;(_t.isInFont||h.missingFile)&&(n.xcoords.push(n.x+p),Z&&n.ycoords.push(-n.y+I),n.tspan.textContent+=_);let U;Z?U=B*V-H*J:U=B*V+H*J,K+=U}n.tspan.setAttributeNS(null,"x",n.xcoords.map(o).join(" ")),Z?n.tspan.setAttributeNS(null,"y",n.ycoords.map(o).join(" ")):n.tspan.setAttributeNS(null,"y",o(-n.y)),Z?n.y-=K:n.x+=K*nt,n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${o(n.fontSize)}px`),n.fontStyle!==w.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==w.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);const st=n.textRenderingMode&l.TextRenderingMode.FILL_STROKE_MASK;if(st===l.TextRenderingMode.FILL||st===l.TextRenderingMode.FILL_STROKE?(n.fillColor!==w.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===l.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),st===l.TextRenderingMode.STROKE||st===l.TextRenderingMode.FILL_STROKE){const _t=1/(n.textMatrixScale||1);this._setStrokeAttributes(n.tspan,_t)}let ht=n.textMatrix;n.textRise!==0&&(ht=ht.slice(),ht[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",`${d(ht)} scale(${o(nt)}, -1)`),n.txtElement.setAttributeNS(S,"xml:space","preserve"),n.txtElement.append(n.tspan),n.txtgrp.append(n.txtElement),this._ensureTransformGroup().append(n.txtElement)}setLeadingMoveText(e,n){this.setLeading(-n),this.moveText(e,n)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const n=R(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${n}); }
`}setFont(e){const n=this.current,h=this.commonObjs.get(e[0]);let b=e[1];n.font=h,this.embedFonts&&!h.missingFile&&!this.embeddedFonts[h.loadedName]&&(this.addFontStyle(h),this.embeddedFonts[h.loadedName]=h),n.fontMatrix=h.fontMatrix||l.FONT_IDENTITY_MATRIX;let g="normal";h.black?g="900":h.bold&&(g="bold");const f=h.italic?"italic":"normal";b<0?(b=-b,n.fontDirection=-1):n.fontDirection=1,n.fontSize=b,n.fontFamily=h.loadedName,n.fontWeight=g,n.fontStyle=f,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",o(-n.y)),n.xcoords=[],n.ycoords=[]}endText(){var n;const e=this.current;e.textRenderingMode&l.TextRenderingMode.ADD_TO_PATH_FLAG&&((n=e.txtElement)!=null&&n.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=C[e]}setLineJoin(e){this.current.lineJoin=L[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,n,h){this.current.strokeColor=l.Util.makeHexColor(e,n,h)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,n,h){this.current.fillColor=l.Util.makeHexColor(e,n,h),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const n=this.viewport.width,h=this.viewport.height,b=l.Util.inverseTransform(this.transformMatrix),g=l.Util.applyTransform([0,0],b),f=l.Util.applyTransform([0,h],b),E=l.Util.applyTransform([n,0],b),J=l.Util.applyTransform([n,h],b),nt=Math.min(g[0],f[0],E[0],J[0]),Z=Math.min(g[1],f[1],E[1],J[1]),Q=Math.max(g[0],f[0],E[0],J[0]),q=Math.max(g[1],f[1],E[1],J[1]),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",nt),V.setAttributeNS(null,"y",Z),V.setAttributeNS(null,"width",Q-nt),V.setAttributeNS(null,"height",q-Z),V.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const n=e[1],h=e[2],b=e[3]||l.IDENTITY_MATRIX,[g,f,E,J]=e[4],nt=e[5],Z=e[6],Q=e[7],q=`shading${t++}`,[V,K,st,ht]=l.Util.normalizeRect([...l.Util.applyTransform([g,f],b),...l.Util.applyTransform([E,J],b)]),[_t,H]=l.Util.singularValueDecompose2dScale(b),_=nt*_t,p=Z*H,I=this.svgFactory.createElement("svg:pattern");I.setAttributeNS(null,"id",q),I.setAttributeNS(null,"patternUnits","userSpaceOnUse"),I.setAttributeNS(null,"width",_),I.setAttributeNS(null,"height",p),I.setAttributeNS(null,"x",`${V}`),I.setAttributeNS(null,"y",`${K}`);const B=this.svg,U=this.transformMatrix,W=this.current.fillColor,X=this.current.strokeColor,Y=this.svgFactory.create(st-V,ht-K);if(this.svg=Y,this.transformMatrix=b,Q===2){const c=l.Util.makeHexColor(...n);this.current.fillColor=c,this.current.strokeColor=c}return this.executeOpTree(this.convertOpList(h)),this.svg=B,this.transformMatrix=U,this.current.fillColor=W,this.current.strokeColor=X,I.append(Y.childNodes[0]),this.defs.append(I),`url(#${q})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const n=`shading${t++}`,h=e[3];let b;switch(e[1]){case"axial":const g=e[4],f=e[5];b=this.svgFactory.createElement("svg:linearGradient"),b.setAttributeNS(null,"id",n),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"x1",g[0]),b.setAttributeNS(null,"y1",g[1]),b.setAttributeNS(null,"x2",f[0]),b.setAttributeNS(null,"y2",f[1]);break;case"radial":const E=e[4],J=e[5],nt=e[6],Z=e[7];b=this.svgFactory.createElement("svg:radialGradient"),b.setAttributeNS(null,"id",n),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"cx",J[0]),b.setAttributeNS(null,"cy",J[1]),b.setAttributeNS(null,"r",Z),b.setAttributeNS(null,"fx",E[0]),b.setAttributeNS(null,"fy",E[1]),b.setAttributeNS(null,"fr",nt);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const g of h){const f=this.svgFactory.createElement("svg:stop");f.setAttributeNS(null,"offset",g[0]),f.setAttributeNS(null,"stop-color",g[1]),b.append(f)}return this.defs.append(b),`url(#${n})`;case"Mesh":return(0,l.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,n){this.current.dashArray=e,this.current.dashPhase=n}constructPath(e,n){const h=this.current;let b=h.x,g=h.y,f=[],E=0;for(const J of e)switch(J|0){case l.OPS.rectangle:b=n[E++],g=n[E++];const nt=n[E++],Z=n[E++],Q=b+nt,q=g+Z;f.push("M",o(b),o(g),"L",o(Q),o(g),"L",o(Q),o(q),"L",o(b),o(q),"Z");break;case l.OPS.moveTo:b=n[E++],g=n[E++],f.push("M",o(b),o(g));break;case l.OPS.lineTo:b=n[E++],g=n[E++],f.push("L",o(b),o(g));break;case l.OPS.curveTo:b=n[E+4],g=n[E+5],f.push("C",o(n[E]),o(n[E+1]),o(n[E+2]),o(n[E+3]),o(b),o(g)),E+=6;break;case l.OPS.curveTo2:f.push("C",o(b),o(g),o(n[E]),o(n[E+1]),o(n[E+2]),o(n[E+3])),b=n[E+2],g=n[E+3],E+=4;break;case l.OPS.curveTo3:b=n[E+2],g=n[E+3],f.push("C",o(n[E]),o(n[E+1]),o(b),o(g),o(b),o(g)),E+=4;break;case l.OPS.closePath:f.push("Z");break}f=f.join(" "),h.path&&e.length>0&&e[0]!==l.OPS.rectangle&&e[0]!==l.OPS.moveTo?f=h.path.getAttributeNS(null,"d")+f:(h.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(h.path)),h.path.setAttributeNS(null,"d",f),h.path.setAttributeNS(null,"fill","none"),h.element=h.path,h.setCurrentPoint(b,g)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const n=`clippath${P++}`,h=this.svgFactory.createElement("svg:clipPath");h.setAttributeNS(null,"id",n),h.setAttributeNS(null,"transform",d(this.transformMatrix));const b=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?b.setAttributeNS(null,"clip-rule","evenodd"):b.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,h.append(b),this.defs.append(h),e.activeClipUrl){e.clipGroup=null;for(const g of this.extraStack)g.clipGroup=null;h.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${n})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const n=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",n)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[n,h]of e)switch(n){case"LW":this.setLineWidth(h);break;case"LC":this.setLineCap(h);break;case"LJ":this.setLineJoin(h);break;case"ML":this.setMiterLimit(h);break;case"D":this.setDash(h[0],h[1]);break;case"RI":this.setRenderingIntent(h);break;case"FL":this.setFlatness(h);break;case"Font":this.setFont(h);break;case"CA":this.setStrokeAlpha(h);break;case"ca":this.setFillAlpha(h);break;default:(0,l.warn)(`Unimplemented graphic state operator ${n}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,n=1){const h=this.current;let b=h.dashArray;n!==1&&b.length>0&&(b=b.map(function(g){return n*g})),e.setAttributeNS(null,"stroke",h.strokeColor),e.setAttributeNS(null,"stroke-opacity",h.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",o(h.miterLimit)),e.setAttributeNS(null,"stroke-linecap",h.lineCap),e.setAttributeNS(null,"stroke-linejoin",h.lineJoin),e.setAttributeNS(null,"stroke-width",o(n*h.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",b.map(o).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",o(n*h.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const n=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(!n){(0,l.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(n)}paintInlineImageXObject(e,n){const h=e.width,b=e.height,g=T(e,this.forceDataSchema,!!n),f=this.svgFactory.createElement("svg:rect");f.setAttributeNS(null,"x","0"),f.setAttributeNS(null,"y","0"),f.setAttributeNS(null,"width",o(h)),f.setAttributeNS(null,"height",o(b)),this.current.element=f,this.clip("nonzero");const E=this.svgFactory.createElement("svg:image");E.setAttributeNS(y,"xlink:href",g),E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y",o(-b)),E.setAttributeNS(null,"width",o(h)+"px"),E.setAttributeNS(null,"height",o(b)+"px"),E.setAttributeNS(null,"transform",`scale(${o(1/h)} ${o(-1/b)})`),n?n.append(E):this._ensureTransformGroup().append(E)}paintImageMaskXObject(e){const n=this.current,h=e.width,b=e.height,g=n.fillColor;n.maskId=`mask${m++}`;const f=this.svgFactory.createElement("svg:mask");f.setAttributeNS(null,"id",n.maskId);const E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",o(h)),E.setAttributeNS(null,"height",o(b)),E.setAttributeNS(null,"fill",g),E.setAttributeNS(null,"mask",`url(#${n.maskId})`),this.defs.append(f),this._ensureTransformGroup().append(E),this.paintInlineImageXObject(e,f)}paintFormXObjectBegin(e,n){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),n){const h=n[2]-n[0],b=n[3]-n[1],g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x",n[0]),g.setAttributeNS(null,"y",n[1]),g.setAttributeNS(null,"width",o(h)),g.setAttributeNS(null,"height",o(b)),this.current.element=g,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const n=this.svgFactory.create(e.width,e.height),h=this.svgFactory.createElement("svg:defs");n.append(h),this.defs=h;const b=this.svgFactory.createElement("svg:g");return b.setAttributeNS(null,"transform",d(e.transform)),n.append(b),this.svg=b,n}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",d(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNodeStream=void 0;var i=A(1),l=A(33);const M=require$$5,D=require$$5,w=require$$5,S=require$$5,y=/^file:\/\/\/[a-zA-Z]:\//;function C(m){const t=S.parse(m);return t.protocol==="file:"||t.host?t:/^[a-z]:[/\\]/i.test(m)?S.parse(`file:///${m}`):(t.host||(t.protocol="file:"),t)}class L{constructor(t){this.source=t,this.url=C(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new d(this):new s(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new P(this,t,e):new o(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}a.PDFNodeStream=L;class R{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)(),this._headersCapability=(0,i.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class T{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(m,t){return{protocol:m.protocol,auth:m.auth,host:m.hostname,port:m.port,path:m.path,method:"GET",headers:t}}class s extends R{constructor(t){super(t);const e=n=>{if(n.statusCode===404){const f=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=f,this._headersCapability.reject(f);return}this._headersCapability.resolve(),this._setReadableStream(n);const h=f=>this._readableStream.headers[f.toLowerCase()],{allowRangeRequests:b,suggestedLength:g}=(0,l.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=g||this._contentLength,this._filename=(0,l.extractFilenameFromHeader)(h)};this._request=null,this._url.protocol==="http:"?this._request=D.request(u(this._url,t.httpHeaders),e):this._request=w.request(u(this._url,t.httpHeaders),e),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class o extends T{constructor(t,e,n){super(t),this._httpHeaders={};for(const b in t.httpHeaders){const g=t.httpHeaders[b];typeof g>"u"||(this._httpHeaders[b]=g)}this._httpHeaders.Range=`bytes=${e}-${n-1}`;const h=b=>{if(b.statusCode===404){const g=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=g;return}this._setReadableStream(b)};this._request=null,this._url.protocol==="http:"?this._request=D.request(u(this._url,this._httpHeaders),h):this._request=w.request(u(this._url,this._httpHeaders),h),this._request.on("error",b=>{this._storedError=b}),this._request.end()}}class d extends R{constructor(t){super(t);let e=decodeURIComponent(this._url.path);y.test(this._url.href)&&(e=e.replace(/^\//,"")),M.lstat(e,(n,h)=>{if(n){n.code==="ENOENT"&&(n=new i.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=h.size,this._setReadableStream(M.createReadStream(e)),this._headersCapability.resolve()})}}class P extends T{constructor(t,e,n){super(t);let h=decodeURIComponent(this._url.path);y.test(this._url.href)&&(h=h.replace(/^\//,"")),this._setReadableStream(M.createReadStream(h,{start:e,end:n-1}))}}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createResponseStatusError=S,a.extractFilenameFromHeader=w,a.validateRangeRequestCapabilities=D,a.validateResponseStatus=y;var i=A(1),l=A(34),M=A(8);function D({getResponseHeader:C,isHttp:L,rangeChunkSize:R,disableRange:T}){const u={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(C("Content-Length"),10);return!Number.isInteger(s)||(u.suggestedLength=s,s<=2*R)||T||!L||C("Accept-Ranges")!=="bytes"||(C("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function w(C){const L=C("Content-Disposition");if(L){let R=(0,l.getFilenameFromContentDispositionHeader)(L);if(R.includes("%"))try{R=decodeURIComponent(R)}catch{}if((0,M.isPdfFile)(R))return R}return null}function S(C,L){return C===404||C===0&&L.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+L+'".'):new i.UnexpectedResponseException(`Unexpected server response (${C}) while retrieving PDF "${L}".`,C)}function y(C){return C===200||C===206}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getFilenameFromContentDispositionHeader=l;var i=A(1);function l(M){let D=!0,w=S("filename\\*","i").exec(M);if(w){w=w[1];let s=R(w);return s=unescape(s),s=T(s),s=u(s),C(s)}if(w=L(M),w){const s=u(w);return C(s)}if(w=S("filename","i").exec(M),w){w=w[1];let s=R(w);return s=u(s),C(s)}function S(s,o){return new RegExp("(?:^|;)\\s*"+s+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',o)}function y(s,o){if(s){if(!/^[\x00-\xFF]+$/.test(o))return o;try{const d=new TextDecoder(s,{fatal:!0}),P=(0,i.stringToBytes)(o);o=d.decode(P),D=!1}catch{}}return o}function C(s){return D&&/[\x80-\xff]/.test(s)&&(s=y("utf-8",s),D&&(s=y("iso-8859-1",s))),s}function L(s){const o=[];let d;const P=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=P.exec(s))!==null;){let[,t,e,n]=d;if(t=parseInt(t,10),t in o){if(t===0)break;continue}o[t]=[e,n]}const m=[];for(let t=0;t<o.length&&t in o;++t){let[e,n]=o[t];n=R(n),e&&(n=unescape(n),t===0&&(n=T(n))),m.push(n)}return m.join("")}function R(s){if(s.startsWith('"')){const o=s.slice(1).split('\\"');for(let d=0;d<o.length;++d){const P=o[d].indexOf('"');P!==-1&&(o[d]=o[d].slice(0,P),o.length=d+1),o[d]=o[d].replace(/\\(.)/g,"$1")}s=o.join('"')}return s}function T(s){const o=s.indexOf("'");if(o===-1)return s;const d=s.slice(0,o),m=s.slice(o+1).replace(/^[^']*'/,"");return y(d,m)}function u(s){return!s.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(s)?s:s.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(o,d,P,m){if(P==="q"||P==="Q")return m=m.replace(/_/g," "),m=m.replace(/=([0-9a-fA-F]{2})/g,function(t,e){return String.fromCharCode(parseInt(e,16))}),y(d,m);try{m=atob(m)}catch{}return y(d,m)})}return""}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNetworkStream=void 0;var i=A(1),l=A(33);const M=200,D=206;function w(R){const T=R.response;return typeof T!="string"?T:(0,i.stringToBytes)(T).buffer}class S{constructor(T,u={}){this.url=T,this.isHttp=/^https?:/i.test(T),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(T,u,s){const o={begin:T,end:u};for(const d in s)o[d]=s[d];return this.request(o)}requestFull(T){return this.request(T)}request(T){const u=this.getXhr(),s=this.currXhrId++,o=this.pendingRequests[s]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const d in this.httpHeaders){const P=this.httpHeaders[d];typeof P>"u"||u.setRequestHeader(d,P)}return this.isHttp&&"begin"in T&&"end"in T?(u.setRequestHeader("Range",`bytes=${T.begin}-${T.end-1}`),o.expectedStatus=D):o.expectedStatus=M,u.responseType="arraybuffer",T.onError&&(u.onerror=function(d){T.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,s),u.onprogress=this.onProgress.bind(this,s),o.onHeadersReceived=T.onHeadersReceived,o.onDone=T.onDone,o.onError=T.onError,o.onProgress=T.onProgress,u.send(null),s}onProgress(T,u){var o;const s=this.pendingRequests[T];s&&((o=s.onProgress)==null||o.call(s,u))}onStateChange(T,u){var t,e,n;const s=this.pendingRequests[T];if(!s)return;const o=s.xhr;if(o.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),o.readyState!==4||!(T in this.pendingRequests))return;if(delete this.pendingRequests[T],o.status===0&&this.isHttp){(t=s.onError)==null||t.call(s,o.status);return}const d=o.status||M;if(!(d===M&&s.expectedStatus===D)&&d!==s.expectedStatus){(e=s.onError)==null||e.call(s,o.status);return}const m=w(o);if(d===D){const h=o.getResponseHeader("Content-Range"),b=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);s.onDone({begin:parseInt(b[1],10),chunk:m})}else m?s.onDone({begin:0,chunk:m}):(n=s.onError)==null||n.call(s,o.status)}getRequestXhr(T){return this.pendingRequests[T].xhr}isPendingRequest(T){return T in this.pendingRequests}abortRequest(T){const u=this.pendingRequests[T].xhr;delete this.pendingRequests[T],u.abort()}}class y{constructor(T){this._source=T,this._manager=new S(T.url,{httpHeaders:T.httpHeaders,withCredentials:T.withCredentials}),this._rangeChunkSize=T.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(T){const u=this._rangeRequestReaders.indexOf(T);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new C(this._manager,this._source),this._fullRequestReader}getRangeReader(T,u){const s=new L(this._manager,T,u);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(T){var u;(u=this._fullRequestReader)==null||u.cancel(T);for(const s of this._rangeRequestReaders.slice(0))s.cancel(T)}}a.PDFNetworkStream=y;class C{constructor(T,u){this._manager=T;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=T.requestFull(s),this._headersReceivedCapability=(0,i.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const T=this._fullRequestId,u=this._manager.getRequestXhr(T),s=P=>u.getResponseHeader(P),{allowRangeRequests:o,suggestedLength:d}=(0,l.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=(0,l.extractFilenameFromHeader)(s),this._isRangeSupported&&this._manager.abortRequest(T),this._headersReceivedCapability.resolve()}_onDone(T){if(T&&(this._requests.length>0?this._requests.shift().resolve({value:T.chunk,done:!1}):this._cachedChunks.push(T.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(T){this._storedError=(0,l.createResponseStatusError)(T,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(T){var u;(u=this.onProgress)==null||u.call(this,{loaded:T.loaded,total:T.lengthComputable?T.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=(0,i.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0,this._headersReceivedCapability.reject(T);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(T,u,s){this._manager=T;const o={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=T.url,this._requestId=T.requestRange(u,s,o),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var T;(T=this.onClosed)==null||T.call(this,this)}_onDone(T){const u=T.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(T){this._storedError=(0,l.createResponseStatusError)(T,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(T){var u;this.isStreamingSupported||(u=this.onProgress)==null||u.call(this,{loaded:T.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const T=(0,i.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(k,a,A)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFFetchStream=void 0;var i=A(1),l=A(33);function M(C,L,R){return{method:"GET",headers:C,signal:R.signal,mode:"cors",credentials:L?"include":"same-origin",redirect:"follow"}}function D(C){const L=new Headers;for(const R in C){const T=C[R];typeof T>"u"||L.append(R,T)}return L}class w{constructor(L){this.source=L,this.isHttp=/^https?:/i.test(L.url),this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new S(this),this._fullRequestReader}getRangeReader(L,R){if(R<=this._progressiveDataLength)return null;const T=new y(this,L,R);return this._rangeRequestReaders.push(T),T}cancelAllRequests(L){this._fullRequestReader&&this._fullRequestReader.cancel(L);for(const R of this._rangeRequestReaders.slice(0))R.cancel(L)}}a.PDFFetchStream=w;class S{constructor(L){this._stream=L,this._reader=null,this._loaded=0,this._filename=null;const R=L.source;this._withCredentials=R.withCredentials||!1,this._contentLength=R.length,this._headersCapability=(0,i.createPromiseCapability)(),this._disableRange=R.disableRange||!1,this._rangeChunkSize=R.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!R.disableStream,this._isRangeSupported=!R.disableRange,this._headers=D(this._stream.httpHeaders);const T=R.url;fetch(T,M(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,l.validateResponseStatus)(u.status))throw(0,l.createResponseStatusError)(u.status,T);this._reader=u.body.getReader(),this._headersCapability.resolve();const s=P=>u.headers.get(P),{allowRangeRequests:o,suggestedLength:d}=(0,l.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=d||this._contentLength,this._filename=(0,l.extractFilenameFromHeader)(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:L,done:R}=await this._reader.read();return R?{value:L,done:R}:(this._loaded+=L.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){this._reader&&this._reader.cancel(L),this._abortController.abort()}}class y{constructor(L,R,T){this._stream=L,this._reader=null,this._loaded=0;const u=L.source;this._withCredentials=u.withCredentials||!1,this._readCapability=(0,i.createPromiseCapability)(),this._isStreamingSupported=!u.disableStream,this._abortController=new AbortController,this._headers=D(this._stream.httpHeaders),this._headers.append("Range",`bytes=${R}-${T-1}`);const s=u.url;fetch(s,M(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,l.validateResponseStatus)(o.status))throw(0,l.createResponseStatusError)(o.status,s);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:L,done:R}=await this._reader.read();return R?{value:L,done:R}:(this._loaded+=L.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){this._reader&&this._reader.cancel(L),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(k){var a=__webpack_module_cache__[k];if(a!==void 0)return a.exports;var A=__webpack_module_cache__[k]={exports:{}};return __webpack_modules__[k](A,A.exports,__w_pdfjs_require__),A.exports}var __webpack_exports__={};return(()=>{var k=__webpack_exports__;Object.defineProperty(k,"__esModule",{value:!0}),Object.defineProperty(k,"AnnotationEditorLayer",{enumerable:!0,get:function(){return l.AnnotationEditorLayer}}),Object.defineProperty(k,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return a.AnnotationEditorParamsType}}),Object.defineProperty(k,"AnnotationEditorType",{enumerable:!0,get:function(){return a.AnnotationEditorType}}),Object.defineProperty(k,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return M.AnnotationEditorUIManager}}),Object.defineProperty(k,"AnnotationLayer",{enumerable:!0,get:function(){return D.AnnotationLayer}}),Object.defineProperty(k,"AnnotationMode",{enumerable:!0,get:function(){return a.AnnotationMode}}),Object.defineProperty(k,"CMapCompressionType",{enumerable:!0,get:function(){return a.CMapCompressionType}}),Object.defineProperty(k,"GlobalWorkerOptions",{enumerable:!0,get:function(){return w.GlobalWorkerOptions}}),Object.defineProperty(k,"InvalidPDFException",{enumerable:!0,get:function(){return a.InvalidPDFException}}),Object.defineProperty(k,"LoopbackPort",{enumerable:!0,get:function(){return A.LoopbackPort}}),Object.defineProperty(k,"MissingPDFException",{enumerable:!0,get:function(){return a.MissingPDFException}}),Object.defineProperty(k,"OPS",{enumerable:!0,get:function(){return a.OPS}}),Object.defineProperty(k,"PDFDataRangeTransport",{enumerable:!0,get:function(){return A.PDFDataRangeTransport}}),Object.defineProperty(k,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(k,"PDFWorker",{enumerable:!0,get:function(){return A.PDFWorker}}),Object.defineProperty(k,"PasswordResponses",{enumerable:!0,get:function(){return a.PasswordResponses}}),Object.defineProperty(k,"PermissionFlag",{enumerable:!0,get:function(){return a.PermissionFlag}}),Object.defineProperty(k,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(k,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(k,"SVGGraphics",{enumerable:!0,get:function(){return C.SVGGraphics}}),Object.defineProperty(k,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return a.UNSUPPORTED_FEATURES}}),Object.defineProperty(k,"UnexpectedResponseException",{enumerable:!0,get:function(){return a.UnexpectedResponseException}}),Object.defineProperty(k,"Util",{enumerable:!0,get:function(){return a.Util}}),Object.defineProperty(k,"VerbosityLevel",{enumerable:!0,get:function(){return a.VerbosityLevel}}),Object.defineProperty(k,"XfaLayer",{enumerable:!0,get:function(){return L.XfaLayer}}),Object.defineProperty(k,"build",{enumerable:!0,get:function(){return A.build}}),Object.defineProperty(k,"createPromiseCapability",{enumerable:!0,get:function(){return a.createPromiseCapability}}),Object.defineProperty(k,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return a.createValidAbsoluteUrl}}),Object.defineProperty(k,"getDocument",{enumerable:!0,get:function(){return A.getDocument}}),Object.defineProperty(k,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(k,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(k,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(k,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(k,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(k,"renderTextLayer",{enumerable:!0,get:function(){return y.renderTextLayer}}),Object.defineProperty(k,"shadow",{enumerable:!0,get:function(){return a.shadow}}),Object.defineProperty(k,"version",{enumerable:!0,get:function(){return A.version}});var a=__w_pdfjs_require__(1),A=__w_pdfjs_require__(4),i=__w_pdfjs_require__(8),l=__w_pdfjs_require__(22),M=__w_pdfjs_require__(7),D=__w_pdfjs_require__(27),w=__w_pdfjs_require__(15),S=__w_pdfjs_require__(3),y=__w_pdfjs_require__(30),C=__w_pdfjs_require__(31),L=__w_pdfjs_require__(29);if(S.isNodeJS){const{PDFNodeStream:R}=__w_pdfjs_require__(32);(0,A.setPDFNetworkStreamFactory)(T=>new R(T))}else{const{PDFNetworkStream:R}=__w_pdfjs_require__(35),{PDFFetchStream:T}=__w_pdfjs_require__(36);(0,A.setPDFNetworkStreamFactory)(u=>(0,i.isValidFetchUrl)(u.url)?new T(u):new R(u))}})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,__spreadArray=function(k,a,A){if(A||arguments.length===2)for(var i=0,l=a.length,M;i<l;i++)(M||!(i in a))&&(M||(M=Array.prototype.slice.call(a,0,i)),M[i]=a[i]);return k.concat(M||Array.prototype.slice.call(a))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(k,a){var A={};return allEvents.forEach(function(i){var l=k[i];l&&(a?A[i]=function(M){return l(M,a(i))}:A[i]=l)}),A}function makeCancellablePromise(k){var a=!1,A=new Promise(function(i,l){k.then(function(M){return!a&&i(M)}).catch(function(M){return!a&&l(M)})});return{promise:A,cancel:function(){a=!0}}}function r(k){var a,A,i="";if(typeof k=="string"||typeof k=="number")i+=k;else if(typeof k=="object")if(Array.isArray(k))for(a=0;a<k.length;a++)k[a]&&(A=r(k[a]))&&(i&&(i+=" "),i+=A);else for(a in k)k[a]&&(i&&(i+=" "),i+=a);return i}function clsx(){for(var k,a,A=0,i="";A<arguments.length;)(k=arguments[A++])&&(a=r(k))&&(i&&(i+=" "),i+=a);return i}var isProduction$1=!0,prefix="Invariant failed";function invariant(k,a){if(!k){if(isProduction$1)throw new Error(prefix);var A=typeof a=="function"?a():a,i=A?"".concat(prefix,": ").concat(A):prefix;throw new Error(i)}}var isProduction=!0;function warning(k,a){if(!isProduction){if(k)return;var A="Warning: "+a;typeof console<"u"&&console.warn(A);try{throw Error(A)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message(k){var a=k.children,A=k.type;return React.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(A)},a)}Message.propTypes={children:PropTypes.node,type:PropTypes.oneOf(["error","loading","no-data"]).isRequired};var DEFAULT_LINK_REL="noopener noreferrer nofollow",LinkService=function(){function k(){_classCallCheck(this,k),this.externalLinkTarget=null,this.externalLinkRel=null}return _createClass(k,[{key:"setDocument",value:function(A){this.pdfDocument=A}},{key:"setViewer",value:function(A){this.pdfViewer=A}},{key:"setExternalLinkRel",value:function(A){this.externalLinkRel=A}},{key:"setExternalLinkTarget",value:function(A){this.externalLinkTarget=A}},{key:"setHistory",value:function(){}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(A){this.pdfViewer.currentPageNumber=A}},{key:"rotation",get:function(){return 0},set:function(A){}},{key:"goToDestination",value:function(A){var i=this;new Promise(function(l){typeof A=="string"?i.pdfDocument.getDestination(A).then(l):Array.isArray(A)?l(A):A.then(l)}).then(function(l){invariant(Array.isArray(l),'"'.concat(l,'" is not a valid destination array.'));var M=l[0];new Promise(function(D){M instanceof Object?i.pdfDocument.getPageIndex(M).then(function(w){D(w)}).catch(function(){invariant(!1,'"'.concat(M,'" is not a valid page reference.'))}):typeof M=="number"?D(M):invariant(!1,'"'.concat(M,'" is not a valid destination reference.'))}).then(function(D){var w=D+1;invariant(w>=1&&w<=i.pagesCount,'"'.concat(w,'" is not a valid page number.')),i.pdfViewer.scrollPageIntoView({dest:A,pageIndex:D,pageNumber:w})})})}},{key:"navigateTo",value:function(A){this.goToDestination(A)}},{key:"goToPage",value:function(){}},{key:"addLinkAttributes",value:function(A,i,l){A.href=i,A.rel=this.externalLinkRel||DEFAULT_LINK_REL,A.target=l?"_blank":this.externalLinkTarget||""}},{key:"getDestinationHash",value:function(){return"#"}},{key:"getAnchorUrl",value:function(){return"#"}},{key:"setHash",value:function(){}},{key:"executeNamedAction",value:function(){}},{key:"cachePageRef",value:function(){}},{key:"isPageVisible",value:function(){return!0}},{key:"isPageCached",value:function(){return!0}}]),k}(),PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function _arrayWithHoles(k){if(Array.isArray(k))return k}function _iterableToArrayLimit(k,a){var A=k==null?null:typeof Symbol<"u"&&k[Symbol.iterator]||k["@@iterator"];if(A!=null){var i,l,M,D,w=[],S=!0,y=!1;try{if(M=(A=A.call(k)).next,a===0){if(Object(A)!==A)return;S=!1}else for(;!(S=(i=M.call(A)).done)&&(w.push(i.value),w.length!==a);S=!0);}catch(C){y=!0,l=C}finally{try{if(!S&&A.return!=null&&(D=A.return(),Object(D)!==D))return}finally{if(y)throw l}}return w}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(k,a){return _arrayWithHoles(k)||_iterableToArrayLimit(k,a)||_unsupportedIterableToArray(k,a)||_nonIterableRest()}var isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(k){return typeof k<"u"}function isProvided(k){return isDefined(k)&&k!==null}function isString(k){return typeof k=="string"}function isArrayBuffer(k){return k instanceof ArrayBuffer}function isBlob(k){return invariant(isBrowser,"isBlob can only be used in a browser environment"),k instanceof Blob}function isFile$1(k){return invariant(isBrowser,"isFile can only be used in a browser environment"),k instanceof File}function isDataURI(k){return isString(k)&&/^data:/.test(k)}function dataURItoByteString(k){invariant(isDataURI(k),"Invalid data URI.");var a=k.split(","),A=_slicedToArray(a,2),i=A[0],l=A[1],M=i.split(";");return M.indexOf("base64")!==-1?atob(l):unescape(l)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}var allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function displayWorkerWarning(){warning(!isLocalFileSystem,"Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function cancelRunningTask(k){k&&k.cancel&&k.cancel()}function makePageCallback(k,a){return Object.defineProperty(k,"width",{get:function(){return this.view[2]*a},configurable:!0}),Object.defineProperty(k,"height",{get:function(){return this.view[3]*a},configurable:!0}),Object.defineProperty(k,"originalWidth",{get:function(){return this.view[2]},configurable:!0}),Object.defineProperty(k,"originalHeight",{get:function(){return this.view[3]},configurable:!0}),k}function isCancelException(k){return k.name==="RenderingCancelledException"}function loadFromFile(k){return new Promise(function(a,A){var i=new FileReader;return i.onload=function(){return a(new Uint8Array(i.result))},i.onerror=function(l){switch(l.target.error.code){case l.target.error.NOT_FOUND_ERR:return A(new Error("Error while reading a file: File not found."));case l.target.error.NOT_READABLE_ERR:return A(new Error("Error while reading a file: File not readable."));case l.target.error.SECURITY_ERR:return A(new Error("Error while reading a file: Security error."));case l.target.error.ABORT_ERR:return A(new Error("Error while reading a file: Aborted."));default:return A(new Error("Error while reading a file."))}},i.readAsArrayBuffer(k),null})}var eventProps=function(){var k={};return[].concat(_toConsumableArray(mouseEvents),_toConsumableArray(touchEvents),_toConsumableArray(keyboardEvents)).forEach(function(a){k[a]=PropTypes.func}),k}(),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),httpHeaders:PropTypes.object,range:PropTypes.object,url:PropTypes.string,withCredentials:PropTypes.bool})];typeof File<"u"&&fileTypes.push(PropTypes.instanceOf(File));typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));var isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes),isLinkService=PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);var isPage=PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired}),isPageIndex=function k(a,A,i){var l=a[A],M=a.pageNumber,D=a.pdf;if(!isDefined(D))return null;if(isDefined(l)){if(typeof l!="number")return new Error("`".concat(A,"` of type `").concat(_typeof(l),"` supplied to `").concat(i,"`, expected `number`."));if(l<0)return new Error("Expected `".concat(A,"` to be greater or equal to 0."));var w=D.numPages;if(l+1>w)return new Error("Expected `".concat(A,"` to be less or equal to ").concat(w-1,"."))}else if(!isDefined(M))return new Error("`".concat(A,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(i,"`."));return null},isPageNumber=function k(a,A,i){var l=a[A],M=a.pageIndex,D=a.pdf;if(!isDefined(D))return null;if(isDefined(l)){if(typeof l!="number")return new Error("`".concat(A,"` of type `").concat(_typeof(l),"` supplied to `").concat(i,"`, expected `number`."));if(l<1)return new Error("Expected `".concat(A,"` to be greater or equal to 1."));var w=D.numPages;if(l>w)return new Error("Expected `".concat(A,"` to be less or equal to ").concat(w,"."))}else if(!isDefined(M))return new Error("`".concat(A,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(i,"`."));return null},isPdf=PropTypes.oneOfType([PropTypes.shape({getDestination:PropTypes.func.isRequired,getOutline:PropTypes.func.isRequired,getPage:PropTypes.func.isRequired,numPages:PropTypes.number.isRequired}),PropTypes.bool]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.shape({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]),_excluded=["url"];function ownKeys$3(k,a){var A=Object.keys(k);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(k);a&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(k,l).enumerable})),A.push.apply(A,i)}return A}function _objectSpread$3(k){for(var a=1;a<arguments.length;a++){var A=arguments[a]!=null?arguments[a]:{};a%2?ownKeys$3(Object(A),!0).forEach(function(i){_defineProperty(k,i,A[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(A)):ownKeys$3(Object(A)).forEach(function(i){Object.defineProperty(k,i,Object.getOwnPropertyDescriptor(A,i))})}return k}function _createSuper$5(k){var a=_isNativeReflectConstruct$5();return function(){var i=_getPrototypeOf(k),l;if(a){var M=_getPrototypeOf(this).constructor;l=Reflect.construct(i,arguments,M)}else l=i.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PDFDataRangeTransport=pdfExports.PDFDataRangeTransport,Document=function(k){_inherits(A,k);var a=_createSuper$5(A);function A(){var i;_classCallCheck(this,A);for(var l=arguments.length,M=new Array(l),D=0;D<l;D++)M[D]=arguments[D];return i=a.call.apply(a,[this].concat(M)),_defineProperty(_assertThisInitialized(i),"state",{pdf:null}),_defineProperty(_assertThisInitialized(i),"viewer",{scrollPageIntoView:function(S){var y=S.dest,C=S.pageIndex,L=S.pageNumber,R=i.props.onItemClick;if(R){R({dest:y,pageIndex:C,pageNumber:L});return}var T=i.pages[C];if(T){T.scrollIntoView();return}warning(!1,"An internal link leading to page ".concat(L," was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>."))}}),_defineProperty(_assertThisInitialized(i),"linkService",new LinkService),_defineProperty(_assertThisInitialized(i),"loadDocument",function(){cancelRunningTask(i.runningTask),i.loadingTask&&i.loadingTask.destroy();var w=makeCancellablePromise(i.findDocumentSource());i.runningTask=w,w.promise.then(function(S){if(i.onSourceSuccess(),!!S){i.setState(function(u){return u.pdf?{pdf:null}:null});var y=i.props,C=y.options,L=y.onLoadProgress,R=y.onPassword,T=pdfExports.getDocument(_objectSpread$3(_objectSpread$3({},S),C));T.onPassword=R,L&&(T.onProgress=L),i.loadingTask=T,T.promise.then(function(u){i.setState(function(s){return s.pdf&&s.pdf.fingerprint===u.fingerprint?null:{pdf:u}},i.onLoadSuccess)}).catch(function(u){i.onLoadError(u)})}}).catch(function(S){i.onSourceError(S)})}),_defineProperty(_assertThisInitialized(i),"setupLinkService",function(){var w=i.props,S=w.externalLinkRel,y=w.externalLinkTarget;i.linkService.setViewer(i.viewer),i.linkService.setExternalLinkRel(S),i.linkService.setExternalLinkTarget(y)}),_defineProperty(_assertThisInitialized(i),"onSourceSuccess",function(){var w=i.props.onSourceSuccess;w&&w()}),_defineProperty(_assertThisInitialized(i),"onSourceError",function(w){warning(w);var S=i.props.onSourceError;S&&S(w)}),_defineProperty(_assertThisInitialized(i),"onLoadSuccess",function(){var w=i.props.onLoadSuccess,S=i.state.pdf;w&&w(S),i.pages=new Array(S.numPages),i.linkService.setDocument(S)}),_defineProperty(_assertThisInitialized(i),"onLoadError",function(w){i.setState({pdf:!1}),warning(w);var S=i.props.onLoadError;S&&S(w)}),_defineProperty(_assertThisInitialized(i),"findDocumentSource",function(){return new Promise(function(w){var S=i.props.file;if(S||w(null),typeof S=="string"){if(isDataURI(S)){var y=dataURItoByteString(S);w({data:y})}displayCORSWarning(),w({url:S})}if(S instanceof PDFDataRangeTransport&&w({range:S}),isArrayBuffer(S)&&w({data:S}),isBrowser&&(isBlob(S)||isFile$1(S))){loadFromFile(S).then(function(T){w({data:T})});return}if(invariant(_typeof(S)==="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(S.url||S.data||S.range,"Invalid parameter object: need either .data, .range or .url"),typeof S.url=="string"){if(isDataURI(S.url)){var C=S.url,L=_objectWithoutProperties(S,_excluded),R=dataURItoByteString(C);w(_objectSpread$3({data:R},L))}displayCORSWarning()}w(S)})}),_defineProperty(_assertThisInitialized(i),"registerPage",function(w,S){i.pages[w]=S}),_defineProperty(_assertThisInitialized(i),"unregisterPage",function(w){delete i.pages[w]}),i}return _createClass(A,[{key:"componentDidMount",value:function(){this.loadDocument(),this.setupLinkService()}},{key:"componentDidUpdate",value:function(l){var M=this.props.file;M!==l.file&&this.loadDocument()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask),this.loadingTask&&this.loadingTask.destroy()}},{key:"childContext",get:function(){var l=this.linkService,M=this.registerPage,D=this.unregisterPage,w=this.props,S=w.imageResourcesPath,y=w.renderMode,C=w.rotate,L=this.state.pdf;return{imageResourcesPath:S,linkService:l,pdf:L,registerPage:M,renderMode:y,rotate:C,unregisterPage:D}}},{key:"eventProps",get:function(){var l=this;return makeEventProps(this.props,function(){return l.state.pdf})}},{key:"renderChildren",value:function(){var l=this.props.children;return React.createElement(DocumentContext.Provider,{value:this.childContext},l)}},{key:"renderContent",value:function(){var l=this.props.file,M=this.state.pdf;if(!l){var D=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof D=="function"?D():D)}if(M===null){var w=this.props.loading;return React.createElement(Message,{type:"loading"},typeof w=="function"?w():w)}if(M===!1){var S=this.props.error;return React.createElement(Message,{type:"error"},typeof S=="function"?S():S)}return this.renderChildren()}},{key:"render",value:function(){var l=this.props,M=l.className,D=l.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Document",M),ref:D},this.eventProps),this.renderContent())}}]),A}(reactExports.PureComponent);Document.defaultProps={error:"Failed to load PDF file.",loading:"Loading PDF…",noData:"No PDF file specified.",onPassword:function k(a,A){switch(A){case PasswordResponses.NEED_PASSWORD:{var i=prompt("Enter the password to open this PDF file.");a(i);break}case PasswordResponses.INCORRECT_PASSWORD:{var l=prompt("Invalid password. Please try again.");a(l);break}}}};var isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=_objectSpread$3(_objectSpread$3({},eventProps),{},{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.string,file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,rotate:PropTypes.number});var isDestination=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.any)]);PropTypes.shape({dest:isDestination,items:PropTypes.arrayOf(PropTypes.shape({dest:isDestination,title:PropTypes.string})),title:PropTypes.string}).isRequired,PropTypes.func,isPdf.isRequired;function ownKeys$2(k,a){var A=Object.keys(k);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(k);a&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(k,l).enumerable})),A.push.apply(A,i)}return A}function _objectSpread$2(k){for(var a=1;a<arguments.length;a++){var A=arguments[a]!=null?arguments[a]:{};a%2?ownKeys$2(Object(A),!0).forEach(function(i){_defineProperty(k,i,A[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(A)):ownKeys$2(Object(A)).forEach(function(i){Object.defineProperty(k,i,Object.getOwnPropertyDescriptor(A,i))})}return k}_objectSpread$2({className:isClassName,inputRef:isRef,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,pdf:isPdf},eventProps);function mergeRefs(){for(var k=[],a=0;a<arguments.length;a++)k[a]=arguments[a];var A=k.filter(Boolean);if(A.length<=1){var i=A[0];return i||null}return function(M){A.forEach(function(D){typeof D=="function"?D(M):D&&(D.current=M)})}}const PageContext=reactExports.createContext(null);function _createSuper$4(k){var a=_isNativeReflectConstruct$4();return function(){var i=_getPrototypeOf(k),l;if(a){var M=_getPrototypeOf(this).constructor;l=Reflect.construct(i,arguments,M)}else l=i.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ANNOTATION_MODE=pdfExports.AnnotationMode,PageCanvasInternal=function(k){_inherits(A,k);var a=_createSuper$4(A);function A(){var i;_classCallCheck(this,A);for(var l=arguments.length,M=new Array(l),D=0;D<l;D++)M[D]=arguments[D];return i=a.call.apply(a,[this].concat(M)),_defineProperty(_assertThisInitialized(i),"canvasElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(i),"onRenderSuccess",function(){i.renderer=null;var w=i.props,S=w.onRenderSuccess,y=w.page,C=w.scale;S&&S(makePageCallback(y,C))}),_defineProperty(_assertThisInitialized(i),"onRenderError",function(w){if(!isCancelException(w)){warning(w);var S=i.props.onRenderError;S&&S(w)}}),_defineProperty(_assertThisInitialized(i),"drawPageOnCanvas",function(){var w=i.canvasElement.current;if(!w)return null;var S=_assertThisInitialized(i),y=S.renderViewport,C=S.viewport,L=i.props,R=L.canvasBackground,T=L.page,u=L.renderForms;w.width=y.width,w.height=y.height,w.style.width="".concat(Math.floor(C.width),"px"),w.style.height="".concat(Math.floor(C.height),"px");var s={annotationMode:u?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,get canvasContext(){return w.getContext("2d",{alpha:!1})},viewport:y};R&&(s.background=R),i.cancelRenderingTask();var o=T.render(s);return i.renderer=o,o.promise.then(i.onRenderSuccess).catch(i.onRenderError)}),i}return _createClass(A,[{key:"componentDidMount",value:function(){this.drawPageOnCanvas()}},{key:"componentDidUpdate",value:function(l){var M=this.props,D=M.canvasBackground,w=M.devicePixelRatio,S=M.page,y=M.renderForms;(D!==l.canvasBackground||w!==l.devicePixelRatio||y!==l.renderForms)&&(S.cleanup(),this.drawPageOnCanvas())}},{key:"componentWillUnmount",value:function(){this.cancelRenderingTask();var l=this.canvasElement.current;l&&(l.width=0,l.height=0)}},{key:"cancelRenderingTask",value:function(){this.renderer&&(this.renderer.cancel(),this.renderer=null)}},{key:"devicePixelRatio",get:function(){var l=this.props.devicePixelRatio;return l||getDevicePixelRatio()}},{key:"renderViewport",get:function(){var l=this.devicePixelRatio,M=this.props,D=M.page,w=M.rotate,S=M.scale;return D.getViewport({scale:S*l,rotation:w})}},{key:"viewport",get:function(){var l=this.props,M=l.page,D=l.rotate,w=l.scale;return M.getViewport({scale:w,rotation:D})}},{key:"render",value:function(){var l=this.props.canvasRef;return React.createElement("canvas",{className:"react-pdf__Page__canvas",dir:"ltr",ref:mergeRefs(l,this.canvasElement),style:{display:"block",userSelect:"none"}})}}]),A}(reactExports.PureComponent);PageCanvasInternal.propTypes={canvasBackground:PropTypes.string,canvasRef:isRef,devicePixelRatio:PropTypes.number,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number.isRequired};function PageCanvas(k){return React.createElement(PageContext.Consumer,null,function(a){return React.createElement(PageCanvasInternal,_extends({},a,k))})}function _createSuper$3(k){var a=_isNativeReflectConstruct$3();return function(){var i=_getPrototypeOf(k),l;if(a){var M=_getPrototypeOf(this).constructor;l=Reflect.construct(i,arguments,M)}else l=i.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PageSVGInternal=function(k){_inherits(A,k);var a=_createSuper$3(A);function A(){var i;_classCallCheck(this,A);for(var l=arguments.length,M=new Array(l),D=0;D<l;D++)M[D]=arguments[D];return i=a.call.apply(a,[this].concat(M)),_defineProperty(_assertThisInitialized(i),"state",{svg:null}),_defineProperty(_assertThisInitialized(i),"onRenderSuccess",function(){i.renderer=null;var w=i.props,S=w.onRenderSuccess,y=w.page,C=w.scale;S&&S(makePageCallback(y,C))}),_defineProperty(_assertThisInitialized(i),"onRenderError",function(w){if(!isCancelException(w)){warning(w);var S=i.props.onRenderError;S&&S(w)}}),_defineProperty(_assertThisInitialized(i),"renderSVG",function(){var w=i.props.page;return i.renderer=w.getOperatorList(),i.renderer.then(function(S){var y=new pdfExports.SVGGraphics(w.commonObjs,w.objs);i.renderer=y.getSVG(S,i.viewport).then(function(C){i.setState({svg:C},i.onRenderSuccess)}).catch(i.onRenderError)}).catch(i.onRenderError)}),_defineProperty(_assertThisInitialized(i),"drawPageOnContainer",function(w){var S=i.state.svg;if(!(!w||!S)){w.firstElementChild||w.appendChild(S);var y=i.viewport,C=y.width,L=y.height;S.setAttribute("width",C),S.setAttribute("height",L)}}),i}return _createClass(A,[{key:"componentDidMount",value:function(){this.renderSVG()}},{key:"viewport",get:function(){var l=this.props,M=l.page,D=l.rotate,w=l.scale;return M.getViewport({scale:w,rotation:D})}},{key:"render",value:function(){var l=this,M=this.viewport,D=M.width,w=M.height;return React.createElement("div",{className:"react-pdf__Page__svg",ref:function(y){return l.drawPageOnContainer(y)},style:{display:"block",backgroundColor:"white",overflow:"hidden",width:D,height:w,userSelect:"none"}})}}]),A}(reactExports.PureComponent);PageSVGInternal.propTypes={onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,rotate:isRotate,scale:PropTypes.number.isRequired};function PageSVG(k){return React.createElement(PageContext.Consumer,null,function(a){return React.createElement(PageSVGInternal,_extends({},a,k))})}function ownKeys$1(k,a){var A=Object.keys(k);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(k);a&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(k,l).enumerable})),A.push.apply(A,i)}return A}function _objectSpread$1(k){for(var a=1;a<arguments.length;a++){var A=arguments[a]!=null?arguments[a]:{};a%2?ownKeys$1(Object(A),!0).forEach(function(i){_defineProperty(k,i,A[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(A)):ownKeys$1(Object(A)).forEach(function(i){Object.defineProperty(k,i,Object.getOwnPropertyDescriptor(A,i))})}return k}function _createSuper$2(k){var a=_isNativeReflectConstruct$2();return function(){var i=_getPrototypeOf(k),l;if(a){var M=_getPrototypeOf(this).constructor;l=Reflect.construct(i,arguments,M)}else l=i.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TextLayerInternal=function(k){_inherits(A,k);var a=_createSuper$2(A);function A(){var i;_classCallCheck(this,A);for(var l=arguments.length,M=new Array(l),D=0;D<l;D++)M[D]=arguments[D];return i=a.call.apply(a,[this].concat(M)),_defineProperty(_assertThisInitialized(i),"state",{textContent:null}),_defineProperty(_assertThisInitialized(i),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(i),"endElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(i),"loadTextContent",function(){var w=i.props.page,S=makeCancellablePromise(w.getTextContent());i.runningTask=S,S.promise.then(function(y){i.setState({textContent:y},i.onLoadSuccess)}).catch(function(y){i.onLoadError(y)})}),_defineProperty(_assertThisInitialized(i),"onLoadSuccess",function(){var w=i.props.onGetTextSuccess,S=i.state.textContent;w&&w(S)}),_defineProperty(_assertThisInitialized(i),"onLoadError",function(w){i.setState({textItems:!1}),warning(w);var S=i.props.onGetTextError;S&&S(w)}),_defineProperty(_assertThisInitialized(i),"onRenderSuccess",function(){var w=i.props.onRenderTextLayerSuccess;w&&w()}),_defineProperty(_assertThisInitialized(i),"onRenderError",function(w){warning(w);var S=i.props.onRenderTextLayerError;S&&S(w)}),_defineProperty(_assertThisInitialized(i),"onMouseDown",function(){var w=i.endElement.current;w&&w.classList.add("active")}),_defineProperty(_assertThisInitialized(i),"onMouseUp",function(){var w=i.endElement.current;w&&w.classList.remove("active")}),i}return _createClass(A,[{key:"componentDidMount",value:function(){var l=this.props.page;invariant(l,"Attempted to load page text content, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer"),this.loadTextContent()}},{key:"componentDidUpdate",value:function(l){var M=this.props.page;l.page&&M!==l.page&&this.loadTextContent()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var l=this.props,M=l.page,D=l.rotate,w=l.scale;return M.getViewport({scale:w,rotation:D})}},{key:"unrotatedViewport",get:function(){var l=this.props,M=l.page,D=l.scale;return M.getViewport({scale:D})}},{key:"rotate",get:function(){var l=this.props,M=l.page,D=l.rotate;return D-M.rotate}},{key:"renderTextLayer",value:function(){var l=this,M=this.state.textContent;if(!M)return null;var D=this.layerElement.current,w=this.viewport,S=this.props,y=S.customTextRenderer,C=S.pageIndex,L=S.pageNumber;cancelRunningTask(this.runningTask),D.innerHTML="";var R={container:D,textContent:M,viewport:w},T=pdfExports.renderTextLayer(R);this.runningTask=T,T.promise.then(function(){var u=document.createElement("div");if(u.className="endOfContent",D.append(u),l.endElement.current=u,y){var s=0;M.items.forEach(function(o,d){var P=l.layerElement.current.children[s],m=y(_objectSpread$1({pageIndex:C,pageNumber:L,itemIndex:d},o));P.innerHTML=m,s+=o.str&&o.hasEOL?2:1})}l.onRenderSuccess()}).catch(function(u){l.onRenderError(u)})}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__textContent textLayer",onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,ref:this.layerElement},this.renderTextLayer())}}]),A}(reactExports.PureComponent);TextLayerInternal.propTypes={customTextRenderer:PropTypes.func,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,page:isPage.isRequired,pageIndex:PropTypes.number.isRequired,pageNumber:PropTypes.number.isRequired,rotate:isRotate,scale:PropTypes.number};function TextLayer(k){return React.createElement(PageContext.Consumer,null,function(a){return React.createElement(TextLayerInternal,_extends({},a,k))})}function _createSuper$1(k){var a=_isNativeReflectConstruct$1();return function(){var i=_getPrototypeOf(k),l;if(a){var M=_getPrototypeOf(this).constructor;l=Reflect.construct(i,arguments,M)}else l=i.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AnnotationLayerInternal=function(k){_inherits(A,k);var a=_createSuper$1(A);function A(){var i;_classCallCheck(this,A);for(var l=arguments.length,M=new Array(l),D=0;D<l;D++)M[D]=arguments[D];return i=a.call.apply(a,[this].concat(M)),_defineProperty(_assertThisInitialized(i),"state",{annotations:null}),_defineProperty(_assertThisInitialized(i),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(i),"loadAnnotations",function(){var w=i.props.page,S=makeCancellablePromise(w.getAnnotations());i.runningTask=S,S.promise.then(function(y){i.setState({annotations:y},i.onLoadSuccess)}).catch(function(y){i.onLoadError(y)})}),_defineProperty(_assertThisInitialized(i),"onLoadSuccess",function(){var w=i.props.onGetAnnotationsSuccess,S=i.state.annotations;w&&w(S)}),_defineProperty(_assertThisInitialized(i),"onLoadError",function(w){i.setState({annotations:!1}),warning(w);var S=i.props.onGetAnnotationsError;S&&S(w)}),_defineProperty(_assertThisInitialized(i),"onRenderSuccess",function(){var w=i.props.onRenderAnnotationLayerSuccess;w&&w()}),_defineProperty(_assertThisInitialized(i),"onRenderError",function(w){warning(w);var S=i.props.onRenderAnnotationLayerError;S&&S(w)}),i}return _createClass(A,[{key:"componentDidMount",value:function(){var l=this.props.page;invariant(l,"Attempted to load page annotations, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations"),this.loadAnnotations()}},{key:"componentDidUpdate",value:function(l){var M=this.props,D=M.page,w=M.renderForms;(l.page&&D!==l.page||w!==l.renderForms)&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var l=this.props,M=l.page,D=l.rotate,w=l.scale;return M.getViewport({scale:w,rotation:D})}},{key:"renderAnnotationLayer",value:function(){var l=this.state.annotations;if(l){var M=this.props,D=M.imageResourcesPath,w=M.linkService,S=M.page,y=M.renderForms,C=this.viewport.clone({dontFlip:!0}),L={annotations:l,div:this.layerElement.current,imageResourcesPath:D,linkService:w,page:S,renderForms:y,viewport:C};this.layerElement.current.innerHTML="";try{pdfExports.AnnotationLayer.render(L),this.onRenderSuccess()}catch(R){this.onRenderError(R)}}}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__annotations annotationLayer",ref:this.layerElement},this.renderAnnotationLayer())}}]),A}(reactExports.PureComponent);AnnotationLayerInternal.propTypes={imageResourcesPath:PropTypes.string,linkService:isLinkService.isRequired,onGetAnnotationsError:PropTypes.func,onGetAnnotationsSuccess:PropTypes.func,onRenderAnnotationLayerError:PropTypes.func,onRenderAnnotationLayerSuccess:PropTypes.func,page:isPage,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number};var AnnotationLayer=function k(a){return React.createElement(DocumentContext.Consumer,null,function(A){return React.createElement(PageContext.Consumer,null,function(i){return React.createElement(AnnotationLayerInternal,_extends({},A,i,a))})})};function ownKeys(k,a){var A=Object.keys(k);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(k);a&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(k,l).enumerable})),A.push.apply(A,i)}return A}function _objectSpread(k){for(var a=1;a<arguments.length;a++){var A=arguments[a]!=null?arguments[a]:{};a%2?ownKeys(Object(A),!0).forEach(function(i){_defineProperty(k,i,A[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(A)):ownKeys(Object(A)).forEach(function(i){Object.defineProperty(k,i,Object.getOwnPropertyDescriptor(A,i))})}return k}function _createSuper(k){var a=_isNativeReflectConstruct();return function(){var i=_getPrototypeOf(k),l;if(a){var M=_getPrototypeOf(this).constructor;l=Reflect.construct(i,arguments,M)}else l=i.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var defaultScale=1,PageInternal=function(k){_inherits(A,k);var a=_createSuper(A);function A(){var i;_classCallCheck(this,A);for(var l=arguments.length,M=new Array(l),D=0;D<l;D++)M[D]=arguments[D];return i=a.call.apply(a,[this].concat(M)),_defineProperty(_assertThisInitialized(i),"state",{page:null}),_defineProperty(_assertThisInitialized(i),"pageElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(i),"onLoadSuccess",function(){var w=i.props,S=w.onLoadSuccess,y=w.registerPage,C=i.state.page;S&&S(makePageCallback(C,i.scale)),y&&y(i.pageIndex,i.pageElement.current)}),_defineProperty(_assertThisInitialized(i),"onLoadError",function(w){i.setState({page:!1}),warning(w);var S=i.props.onLoadError;S&&S(w)}),_defineProperty(_assertThisInitialized(i),"loadPage",function(){var w=i.props.pdf,S=i.getPageNumber();if(S){i.setState(function(C){return C.page?{page:null}:null});var y=makeCancellablePromise(w.getPage(S));i.runningTask=y,y.promise.then(function(C){i.setState({page:C},i.onLoadSuccess)}).catch(function(C){i.onLoadError(C)})}}),i}return _createClass(A,[{key:"componentDidMount",value:function(){var l=this.props.pdf;invariant(l,"Attempted to load a page, but no document was specified."),this.loadPage()}},{key:"componentDidUpdate",value:function(l){var M=this.props.pdf;if(l.pdf&&M!==l.pdf||this.getPageNumber()!==this.getPageNumber(l)){var D=this.props.unregisterPage;D&&D(this.getPageIndex(l)),this.loadPage()}}},{key:"componentWillUnmount",value:function(){var l=this.props.unregisterPage;l&&l(this.pageIndex),cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){var l=this.pageIndex,M=this.pageNumber,D=this.state.page;if(!D)return{};var w=this.props,S=w.canvasBackground,y=w.customTextRenderer,C=w.devicePixelRatio,L=w.onGetAnnotationsError,R=w.onGetAnnotationsSuccess,T=w.onGetTextError,u=w.onGetTextSuccess,s=w.onRenderAnnotationLayerError,o=w.onRenderAnnotationLayerSuccess,d=w.onRenderError,P=w.onRenderSuccess,m=w.onRenderTextLayerError,t=w.onRenderTextLayerSuccess,e=w.renderForms,n=w.renderInteractiveForms;return{canvasBackground:S,customTextRenderer:y,devicePixelRatio:C,onGetAnnotationsError:L,onGetAnnotationsSuccess:R,onGetTextError:T,onGetTextSuccess:u,onRenderAnnotationLayerError:s,onRenderAnnotationLayerSuccess:o,onRenderError:d,onRenderSuccess:P,onRenderTextLayerError:m,onRenderTextLayerSuccess:t,page:D,pageIndex:l,pageNumber:M,renderForms:e??n,rotate:this.rotate,scale:this.scale}}},{key:"getPageIndex",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(l.pageNumber)?l.pageNumber-1:isProvided(l.pageIndex)?l.pageIndex:null}},{key:"getPageNumber",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(l.pageNumber)?l.pageNumber:isProvided(l.pageIndex)?l.pageIndex+1:null}},{key:"pageIndex",get:function(){return this.getPageIndex()}},{key:"pageNumber",get:function(){return this.getPageNumber()}},{key:"rotate",get:function(){var l=this.props.rotate;if(isProvided(l))return l;var M=this.state.page;return M?M.rotate:null}},{key:"scale",get:function(){var l=this.state.page;if(!l)return null;var M=this.props,D=M.scale,w=M.width,S=M.height,y=this.rotate,C=1,L=D===null?defaultScale:D;if(w||S){var R=l.getViewport({scale:1,rotation:y});C=w?w/R.width:S/R.height}return L*C}},{key:"eventProps",get:function(){var l=this;return makeEventProps(this.props,function(){var M=l.state.page;return M&&makePageCallback(M,l.scale)})}},{key:"pageKey",get:function(){return"".concat(this.pageIndex,"@").concat(this.scale,"/").concat(this.rotate)}},{key:"pageKeyNoScale",get:function(){return"".concat(this.pageIndex,"/").concat(this.rotate)}},{key:"renderMainLayer",value:function(){var l=this.props,M=l.canvasRef,D=l.renderMode;switch(D){case"none":return null;case"svg":return React.createElement(PageSVG,{key:"".concat(this.pageKeyNoScale,"_svg")});case"canvas":default:return React.createElement(PageCanvas,{key:"".concat(this.pageKey,"_canvas"),canvasRef:M})}}},{key:"renderTextLayer",value:function(){var l=this.props.renderTextLayer;return l?React.createElement(TextLayer,{key:"".concat(this.pageKey,"_text")}):null}},{key:"renderAnnotationLayer",value:function(){var l=this.props.renderAnnotationLayer;return l?React.createElement(AnnotationLayer,{key:"".concat(this.pageKey,"_annotations")}):null}},{key:"renderChildren",value:function(){var l=this.props.children;return React.createElement(PageContext.Provider,{value:this.childContext},this.renderMainLayer(),this.renderTextLayer(),this.renderAnnotationLayer(),l)}},{key:"renderContent",value:function(){var l=this.pageNumber,M=this.props.pdf,D=this.state.page;if(!l){var w=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof w=="function"?w():w)}if(M===null||D===null){var S=this.props.loading;return React.createElement(Message,{type:"loading"},typeof S=="function"?S():S)}if(M===!1||D===!1){var y=this.props.error;return React.createElement(Message,{type:"error"},typeof y=="function"?y():y)}return this.renderChildren()}},{key:"render",value:function(){var l=this.pageNumber,M=this.props,D=M.className,w=M.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Page",D),"data-page-number":l,ref:mergeRefs(w,this.pageElement),style:{position:"relative",minWidth:"min-content",minHeight:"min-content"}},this.eventProps),this.renderContent())}}]),A}(reactExports.PureComponent);PageInternal.defaultProps={error:"Failed to load the page.",loading:"Loading page…",noData:"No page specified.",renderAnnotationLayer:!0,renderMode:"canvas",renderTextLayer:!0,scale:defaultScale};var isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);PageInternal.propTypes=_objectSpread(_objectSpread({},eventProps),{},{canvasBackground:PropTypes.string,children:PropTypes.node,className:isClassName,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,registerPage:PropTypes.func,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderInteractiveForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,unregisterPage:PropTypes.func,width:PropTypes.number});function Page$1(k,a){return React.createElement(DocumentContext.Consumer,null,function(A){return React.createElement(PageInternal,_extends({ref:a},A,k))})}const PdfPage=React.forwardRef(Page$1);displayWorkerWarning();pdfExports.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfExports.GlobalWorkerOptions.workerSrc=`//unpkg.com/pdfjs-dist@${pdfExports.version}/build/pdf.worker.js`;function Page(k){return jsxRuntimeExports.jsx(PdfPage,{...k,error:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"❌"}),noData:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"⚠️"}),loading:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"♾️"}),onRenderError:a=>console.log(a),onLoadError:a=>console.log(a),onRenderTextLayerError:a=>console.log(a),onGetAnnotationsError:a=>console.log(a),onGetTextError:a=>console.log(a)})}class MdPdf extends React.Component{constructor(a){super(a),this.state={currPage:0,pageCount:1,inputPageCount:1,loaded:!1,displayed:!1,width:100,height:100},this.mainDiv=React.createRef(),this.flipBook=React.createRef(),this.scanPageId=0,this.pdfMaxHeight=100,this.pdfMaxWidth=100}handleResize(){this.setState(this.getWidthHeight())}componentDidMount(){window.addEventListener("resize",this.handleResize.bind(this)),this.handleResize()}componentWillUnmount(){this.props.setPersistent(this.state)}hasMergedPairs(){return this.props.mergedpairs??!1}hasCover(){return this.props.cover??!1}isFull(){return"full"in this.props}determineSize(a,A,i){let l=A.getViewport(),M=l.viewBox[2],D=l.viewBox[3];this.pdfMaxHeight=Math.max(this.pdfMaxHeight,D);let w=this.hasMergedPairs()&&!(this.hasCover()&&this.scanPageId==0);this.pdfMaxWidth=Math.max(this.pdfMaxWidth,M/(1+w)),this.scanPageId++,this.scanPageId<a.numPages?a.getPage(this.scanPageId+1).then((S=>this.determineSize(a,S,i)).bind(this)):i()}getWidthHeight(){let a=this.mainDiv.current.parentNode.clientWidth,A=this.mainDiv.current.parentNode.clientHeight,i=this.pdfMaxHeight/(this.pdfMaxWidth*2),l=this.pdfMaxWidth/this.pdfMaxHeight;return this.isFull()&&window.innerWidth>window.innerHeight?{width:A/l,height:A}:(this.isFull()&&(a=window.innerWidth),{width:a,height:i*a})}isPagePrepared(a){let i=this.state.currPage;return a>=i-4&&a<i+4+2}onDocumentLoaded(a){this.scanPageId=0;let A=()=>{let i=this.hasMergedPairs()?a.numPages*2-(this.hasCover()?1:0):a.numPages;this.setState({loaded:!0,inputPageCount:a.numPages,pageCount:i,...this.getWidthHeight()})};a.getPage(1).then((i=>this.determineSize(a,i,A.bind(this))).bind(this))}nextPage(){this.setState({currPage:Math.min(this.state.currPage+1,this.state.pageCount-1)},()=>{var a,A;return(A=(a=this.flipBook.current)==null?void 0:a.pageFlip())==null?void 0:A.flipNext()})}prevPage(){this.setState({currPage:Math.max(this.state.currPage-1,0)},()=>{var a,A;return(A=(a=this.flipBook.current)==null?void 0:a.pageFlip())==null?void 0:A.flipPrev()})}onItemClick({pageNumber:a}){this.setState({currPage:a},()=>{var A,i;return(i=(A=this.flipBook.current)==null?void 0:A.pageFlip())==null?void 0:i.flip({pageNum:this.state.currPage})})}onFlipBookChangeState(){var A,i;let a=(i=(A=this.flipBook.current)==null?void 0:A.pageFlip())==null?void 0:i.getCurrentPageIndex();this.setState({currPage:a})}onFlipBookInit(){var A;let a=(A=this.flipBook.current)==null?void 0:A.pageFlip();this.props.persistent!==null&&(a==null||a.turnToPage(this.props.persistent.currPage))}render(){let a={...this.props};return delete a.href,delete a.mergedPairs,delete a.hascover,"filter"in a&&(a.style={filter:a.filter}),jsxRuntimeExports.jsx("div",{ref:this.mainDiv,className:"mdPdf",...a,children:jsxRuntimeExports.jsxs(Document,{file:this.props.href,onItemClick:this.onItemClick,options:{cMapUrl:`https://unpkg.com/pdfjs-dist@${pdfExports.version}/cmaps/`,cMapPacked:!0},onLoadSuccess:this.onDocumentLoaded.bind(this),error:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"❌"}),noData:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"⚠️"}),onLoadError:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"💢"}),renderMode:"canvas",children:[" ",this.state.loaded?jsxRuntimeExports.jsx(HTMLFlipBook$1,{ref:this.flipBook,width:this.state.width*.5,height:this.state.height,showCover:this.hasCover(),maxShadowOpacity:.4,flippingTime:320,usePortrait:!1,onChangeState:this.onFlipBookChangeState.bind(this),onInit:this.onFlipBookInit.bind(this),children:this.hasMergedPairs()?Array.from(new Array(this.state.pageCount),(A,i)=>{if(i==0&&this.hasCover())return jsxRuntimeExports.jsx("div",{className:`pdfpage page-${i}`,children:this.isPagePrepared(i)?jsxRuntimeExports.jsx(Page,{pageIndex:i,width:this.state.width*.5}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})},`page_${i}`);{let M="half-page"+((i+(this.hasCover()?1:0))%2?" right":""),D=Math.floor(i*.5+(this.hasCover()?.5:0));return jsxRuntimeExports.jsx("div",{className:`pdfpage page-${i}`,children:jsxRuntimeExports.jsx("div",{className:M,children:this.isPagePrepared(i)?jsxRuntimeExports.jsx(Page,{pageIndex:D,width:this.state.width}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})})},`page_${i}`)}}):Array.from(new Array(this.state.pageCount),(A,i)=>jsxRuntimeExports.jsx("div",{className:`pdfpage page-${i}`,children:this.isPagePrepared(i)?jsxRuntimeExports.jsx(Page,{pageIndex:i,width:this.state.width*.5}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})},`page_${i}`))}):jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"loading"})]})})}}class DisableWhileResizing extends React.Component{constructor(a){super(a),this.state={visible:!0},this.prevTimestamp=0,this.prevVisible=!0,this.visible=!0,this.counter=0,this.frameMs=0}handleResize(){this.counter=350}componentDidMount(){window.addEventListener("resize",this.handleResize.bind(this));let a=(A=>{this.frameMs=A-this.prevTimestamp,this.prevTimestamp=A,this.counter-=this.frameMs,this.visible=this.counter<=0,this.prevVisible!==this.visible&&this.setState({visible:this.visible}),this.prevVisible=this.visible,window.requestAnimationFrame(a)}).bind(this);window.requestAnimationFrame(a)}render(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:this.state.visible?this.props.children:jsxRuntimeExports.jsx(Gh1,{glitchtype:"1",children:"resizing"})})}}class MdPdfRoot extends React.Component{constructor(a){super(a),this.state={persistentStorage:null}}isFull(){return"full"in this.props}render(){let a="pdfRoot"+(this.isFull()?" mdFull":"");return jsxRuntimeExports.jsx("div",{className:a,children:jsxRuntimeExports.jsx(DisableWhileResizing,{children:jsxRuntimeExports.jsx(MdPdf,{...this.props,setPersistent:(A=>this.setState({persistentStorage:A})).bind(this),persistent:this.state.persistentStorage})})})}}export{MdPdfRoot as default};
